/*! dynamics-web-api-callbacks v1.6.0 (c) 2019 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(i){if(a[i])return a[i].exports;var n=a[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};return t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,i){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:i})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){function a(e,t,a){throw new Error(a?e+" requires the "+t+" parameter to be of type "+a:e+" requires the "+t+" parameter.")}var i={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,i,n){void 0!==e&&null!==e&&""!=e||a(t,i,n)},stringParameterCheck:function(e,t,i){"string"!=typeof e&&a(t,i,"String")},arrayParameterCheck:function(e,t,i){e.constructor!==Array&&a(t,i,"Array")},stringOrArrayParameterCheck:function(e,t,i){e.constructor!==Array&&"string"!=typeof e&&a(t,i,"String or Array")},numberParameterCheck:function(e,t,i){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;a(t,i,"Number")}},boolParameterCheck:function(e,t,i){"boolean"!=typeof e&&a(t,i,"Boolean")},guidParameterCheck:function(e,t,i){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){a(t,i,"GUID String")}},keyParameterCheck:function(e,t,n){try{i.stringParameterCheck(e,t,n);var r=/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e);if(r)return r[0];var c=e.split(",");if(c.length)for(var o=0;o<c.length;o++)c[o]=c[o].trim().replace('"',"'"),/^[\w\d\_]+\=('[^\'\r\n]+'|\d+)$/i.exec(c[o])[0];return c.join(",")}catch(e){a(t,n,"String representing GUID or Alternate Key")}},callbackParameterCheck:function(e,t,i){"function"!=typeof e&&a(t,i,"Function")},batchIncompatible:function(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")},batchNotStarted:function(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")},handleHttpError:function(e,t){var a=new Error;return Object.keys(e).forEach(function(t){a[t]=e[t]}),t&&Object.keys(t).forEach(function(e){a[e]=t[e]}),a}};e.exports=i},function(e,t){var a={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){a.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){a.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){a.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){a.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=a},function(e,t,a){function i(e){return void 0===e||null==e}function n(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var a=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?a:3&a|8).toString(16)})}function r(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm){if(!i(Xrm.Utility)&&!i(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!i(Xrm.Page)&&!i(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function c(){var e=r(),t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}function o(e){return c()+"/api/data/v"+e+"/"}function s(){return"undefined"!=typeof Xrm?Xrm.Internal:null}function l(){return"undefined"!=typeof Xrm?Xrm.Utility:null}var u={buildFunctionParameters:a(13),getFetchXmlPagingCookie:a(16),convertToReferenceObject:a(15),isNull:i,generateUUID:n,getXrmContext:r,getXrmInternal:s,getXrmUtility:l,getClientUrl:c,initWebApiUrl:o};e.exports=u},function(e,t){String.prototype.endsWith=function(e,t){var a=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>a.length)&&(t=a.length),t-=e.length;var i=a.lastIndexOf(e,t);return-1!==i&&i===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,a){function i(e,t,a,n,o){var s={},l=[];if(n=null!=n?n:"&",e){if(e.navigationProperty){if(r.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),a+="/"+e.navigationProperty,e.navigationPropertyKey){a+="("+r.keyParameterCheck(e.navigationPropertyKey,"DynamicsWebApi."+t,"request.navigationPropertyKey")+")"}"Attributes"===e.navigationProperty&&e.metadataAttributeType&&(r.stringParameterCheck(e.metadataAttributeType,"DynamicsWebApi."+t,"request.metadataAttributeType"),a+="/"+e.metadataAttributeType)}if(null!=e.select&&e.select.length&&(r.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?a+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?a+=e.select.shift():e.select.shift()),e.select.length&&l.push("$select="+e.select.join(",")))),e.filter){r.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter");for(var u=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,p=e.filter;null!==(m=u.exec(p));){m.index===u.lastIndex&&regex.lastIndex++;var h=m[0].endsWith(")")?")":" ";p=p.replace(m[0]," "+m[1]+h)}l.push("$filter="+encodeURIComponent(p))}e.savedQuery&&l.push("savedQuery="+r.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&l.push("userQuery="+r.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.count&&(r.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),l.push("$count="+e.count)),e.top&&e.top>0&&(r.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),l.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(r.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),l.push("$orderby="+e.orderBy.join(",")));var y=c(e,t,o);if(y.length&&(s.Prefer=y),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(r.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),s["If-Match"]=e.ifmatch),e.ifnonematch&&(r.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),s["If-None-Match"]=e.ifnonematch),e.impersonate&&(r.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),s.MSCRMCallerID=r.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.token&&(r.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),s.Authorization="Bearer "+e.token),e.duplicateDetection&&(r.boolParameterCheck(e.duplicateDetection,"DynamicsWebApi."+t,"request.duplicateDetection"),s["MSCRM.SuppressDuplicateDetection"]="false"),e.entity&&r.parameterCheck(e.entity,"DynamicsWebApi."+t,"request.entity"),e.data&&r.parameterCheck(e.data,"DynamicsWebApi."+t,"request.data"),e.noCache&&(r.boolParameterCheck(e.noCache,"DynamicsWebApi."+t,"request.noCache"),s["Cache-Control"]="no-cache"),e.mergeLabels&&(r.boolParameterCheck(e.mergeLabels,"DynamicsWebApi."+t,"request.mergeLabels"),s["MSCRM.MergeLabels"]="true"),e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")||(s["Content-ID"]=e.contentId)),e.isBatch&&r.boolParameterCheck(e.isBatch,"DynamicsWebApi."+t,"request.isBatch"),e.expand&&e.expand.length)if(r.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)l.push("$expand="+e.expand);else{for(var f=[],b=0;b<e.expand.length;b++)if(e.expand[b].property){var d=i(e.expand[b],t+" $expand",null,";"),k=d.query;k&&k.length&&(k="("+k+")"),f.push(e.expand[b].property+k)}f.length&&l.push("$expand="+f.join(","))}}return{url:a,query:l.join(n),headers:s}}function n(e,t,a){var n,c="";return e.url?(r.stringParameterCheck(e.url,"DynamicsWebApi."+t,"request.url"),c=e.url.replace(a.webApiUrl,""),n=i(e,t,c,"&",a)):(e._unboundRequest||e.collection||r.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),e.collection&&(r.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"),c=e.collection,e.contentId&&(r.stringParameterCheck(e.contentId,"DynamicsWebApi."+t,"request.contentId"),e.contentId.startsWith("$")&&(c=e.contentId+"/"+c)),e.key?e.key=r.keyParameterCheck(e.key,"DynamicsWebApi."+t,"request.key"):e.id&&(e.key=r.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id")),e.key&&(c+="("+e.key+")")),e._additionalUrl&&(c&&(c+="/"),c+=e._additionalUrl),n=i(e,t,c,"&",a),e.fetchXml?(r.stringParameterCheck(e.fetchXml,"DynamicsWebApi."+t,"request.fetchXml"),n.url+="?fetchXml="+encodeURIComponent(e.fetchXml)):n.query&&(n.url+="?"+n.query)),e.hasOwnProperty("async")&&null!=e.async?(r.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),n.async=e.async):n.async=!0,{url:n.url,headers:n.headers,async:n.async}}var r=(a(1),a(0)),c=a(14),o={convertRequestOptions:i,convertRequest:n};e.exports=o},function(e,t,a){function i(e){var t=m.getXrmInternal();if(!m.isNull(t)&&"function"==typeof t.getEntitySetName)return t.getEntitySetName(e)||e;var a=null;if(!m.isNull(p)&&(a=p[e],m.isNull(a)))for(var i in p)if(p[i]===e)return e;return a}function n(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]="application/json; charset=utf-8",e}function r(e,t){var a;return e&&(a=JSON.stringify(e,function(e,a){if(e.endsWith("@odata.bind")||e.endsWith("@odata.id")){if("string"==typeof a&&!a.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(a)&&(a=a.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),t.useEntityNames){var n=/([\w_]+)(\([\d\w-]+\))$/,r=n.exec(a);if(r.length>2){var c=i(r[1]);m.isNull(c)||(a=a.replace(n,c+"$2"))}}a.startsWith(t.webApiUrl)||(e.endsWith("@odata.bind")?a.startsWith("/")||(a="/"+a):a=t.webApiUrl+a.replace(/^\//,""))}}else(e.startsWith("oData")||e.endsWith("_Formatted")||e.endsWith("_NavigationProperty")||e.endsWith("_LogicalName"))&&(a=void 0);return a}),a=a.replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})),a}function c(e,t,i,c,o,s,l,u,p,h){o=o||{},s=s||{},b.push(s);var d=r(c,i);if(p)return void f.push({method:e,path:t,config:i,data:d,headers:o});if("$batch"===t){var k=y.convertToBatch(f);d=k.body,f.length=0,o=n(o),o["Content-Type"]="multipart/mixed;boundary="+k.boundary}else o=n(o);if(s.convertedToBatch=!1,t.length>2e3){var g="dwa_batch_"+m.generateUUID(),A=[];A.push("--"+g),A.push("Content-Type: application/http"),A.push("Content-Transfer-Encoding: binary\n"),A.push(e+" "+i.webApiUrl+t+" HTTP/1.1");for(var C in o)"Authorization"!==C&&(A.push(C+": "+o[C]),delete o[C]);A.push("\n--"+g+"--"),d=A.join("\n"),o=n(o),o["Content-Type"]="multipart/mixed;boundary="+g,t="$batch",e="POST",s.convertedToBatch=!0}i.impersonate&&!o.MSCRMCallerID&&(o.MSCRMCallerID=i.impersonate);var D;D=a(11);var P=function(a){a&&(o||(o={}),o.Authorization="Bearer "+(a.hasOwnProperty("accessToken")?a.accessToken:a)),D({method:e,uri:i.webApiUrl+t,data:d,additionalHeaders:o,responseParams:b,successCallback:l,errorCallback:u,isAsync:h,timeout:i.timeout})};i.onTokenRefresh&&(!o||o&&!o.Authorization)?i.onTokenRefresh(P):P()}function o(e,t,a,n){var r=m.getXrmUtility();if(m.isNull(r)||"function"!=typeof r.getEntityMetadata){var o=function(t){p={};for(var n=0;n<t.data.value.length;n++)p[t.data.value[n].LogicalName]=t.data.value[n].EntitySetName;a(i(e))},s=function(e){n({message:"Unable to fetch EntityDefinitions. Error: "+e.message})},l=h.convertRequest({collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0},"retrieveMultiple",t);c("GET",l.url,t,null,l.headers,null,o,s,!1,l.async)}else r.getEntityMetadata(e).then(function(e){a(e.EntitySetName)},n)}function s(e){return["EntityDefinitions","$metadata","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions"].indexOf(e)>-1}function l(e,t,a,n){if(s(e)||m.isNull(e))return void a(e);if(e=e.toLowerCase(),!t.useEntityNames)return void a(e);try{var r=i(e);m.isNull(r)?o(e,t,a,n):a(r)}catch(e){n({message:"Unable to fetch Collection Names. Error: "+e.message})}}function u(e,t,a,i,n,r,o){var s=function(s){t.collection=s;var l=h.convertRequest(t,a,i);c(e,l.url,i,t.data||t.entity,l.headers,n,r,o,t.isBatch,l.async)};l(t.collection,i,s,o)}var p,m=a(2),h=a(4),y=a(12),f=[],b=[];e.exports={sendRequest:c,makeRequest:u,getCollectionName:i}},function(e,t,a){function i(e){var t={webApiVersion:"8.0",webApiUrl:"",impersonate:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null},a=!1;e||(e=t),this.setConfig=function(e){e.webApiVersion&&(r.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(r.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl=n.initWebApiUrl(t.webApiVersion),e.impersonate&&(t.impersonate=r.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.onTokenRefresh&&(r.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(r.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(r.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(r.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation),e.useEntityNames&&(r.boolParameterCheck(e.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),t.useEntityNames=e.useEntityNames)},this.setConfig(e);var o=function(e,i,n,r,o,s){i.isBatch=a,c.makeRequest(e,i,n,t,s,r,o)};this.createRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.create","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.create","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.create","errorCallback")),o("POST",e,"create",function(e){t(e.data)},i)},this.create=function(e,t,a,i,n,c){r.parameterCheck(e,"DynamicsWebApi.create","object"),r.stringParameterCheck(t,"DynamicsWebApi.create","collection"),n&&r.stringOrArrayParameterCheck(n,"DynamicsWebApi.create","prefer"),c&&r.arrayParameterCheck(c,"DynamicsWebApi.create","select");var o={collection:t,select:c,prefer:n,entity:e};this.createRequest(o,a,i)},this.updateRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.update","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.update","errorCallback")),null==e.ifmatch&&(e.ifmatch="*");var n=function(e){t(e.data)},c=e.ifmatch,s=function(e){c&&412===e.status?t(!1):i(e)},l=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(e.collection)?"PUT":"PATCH";o(l,e,"update",n,s,{valueIfEmpty:!0})},this.update=function(e,t,i,n,c,o,s){r.stringParameterCheck(e,"DynamicsWebApi.update","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.update","key"),r.parameterCheck(i,"DynamicsWebApi.update","object"),r.stringParameterCheck(t,"DynamicsWebApi.update","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.update","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.update","errorCallback")),o&&r.stringOrArrayParameterCheck(o,"DynamicsWebApi.update","prefer"),s&&r.arrayParameterCheck(s,"DynamicsWebApi.update","select");var l={collection:t,key:e,select:s,prefer:o,entity:i};this.updateRequest(l,n,c)},this.updateSingleProperty=function(e,t,i,n,c,s,l){r.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.updateSingleProperty","key"),r.parameterCheck(i,"DynamicsWebApi.updateSingleProperty","keyValuePair"),r.stringParameterCheck(t,"DynamicsWebApi.updateSingleProperty","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.updateSingleProperty","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.updateSingleProperty","errorCallback")),s&&r.stringOrArrayParameterCheck(s,"DynamicsWebApi.updateSingleProperty","prefer"),l&&r.arrayParameterCheck(l,"DynamicsWebApi.updateSingleProperty","select");var u=Object.keys(i)[0],p=i[u];o("PUT",{collection:t,key:e,select:l,prefer:s,navigationProperty:u,data:{value:p}},"updateSingleProperty",function(e){n(e.data)},c)},this.deleteRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.delete","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.delete","errorCallback"));var n=function(e){t(e.data)},c=e.ifmatch;o("DELETE",e,"delete",n,function(e){c&&412===e.status?t(!1):i(e)},{valueIfEmpty:!0})},this.deleteRecord=function(e,t,i,n,c){r.stringParameterCheck(e,"DynamicsWebApi.delete","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.delete","key"),r.stringParameterCheck(t,"DynamicsWebApi.delete","collection"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.delete","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.delete","errorCallback")),null!=c&&r.stringParameterCheck(c,"DynamicsWebApi.delete","propertyName"),o("DELETE",{key:e,collection:t,navigationProperty:c},"delete",function(e){i()},n)},this.retrieveRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.retrieve","request"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.retrieve","errorCallback"));var n=function(e){t(e.data)},c=null!=e.select&&1===e.select.length&&e.select[0].endsWith("/$ref");o("GET",e,"retrieve",n,i,{isRef:c})},this.retrieve=function(e,t,i,n,c,o){r.stringParameterCheck(e,"DynamicsWebApi.retrieve","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.retrieve","key"),r.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.retrieve","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.retrieve","errorCallback")),c&&c.length&&r.arrayParameterCheck(c,"DynamicsWebApi.retrieve","select"),o&&o.length&&r.stringOrArrayParameterCheck(o,"DynamicsWebApi.retrieve","expand");var s={collection:t,key:e,select:c,expand:o};this.retrieveRequest(s,i,n)},this.upsertRequest=function(e,t,i){r.parameterCheck(e,"DynamicsWebApi.upsert","request"),r.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.upsert","errorCallback"));var n=e.ifnonematch,c=e.ifmatch;o("PATCH",e,"upsert",function(e){t(e.data)},function(e){n&&412===e.status?t():c&&404===e.status?t():i(e)})},this.upsert=function(e,t,i,n,c,o,s){r.stringParameterCheck(e,"DynamicsWebApi.upsert","key"),e=r.keyParameterCheck(e,"DynamicsWebApi.upsert","key"),r.parameterCheck(i,"DynamicsWebApi.upsert","object"),r.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.upsert","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.upsert","errorCallback")),o&&r.stringOrArrayParameterCheck(o,"DynamicsWebApi.upsert","prefer"),s&&r.arrayParameterCheck(s,"DynamicsWebApi.upsert","select");var l={collection:t,key:e,select:s,prefer:o,entity:i};this.upsertRequest(l,n,c)},this.count=function(e,t,i,n){r.stringParameterCheck(e,"DynamicsWebApi.count","collection"),a||(r.callbackParameterCheck(t,"DynamicsWebApi.count","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.count","errorCallback"));var c={collection:e};null==n||null!=n&&!n.length?c.navigationProperty="$count":(c.filter=n,c.count=!0),o("GET",c,"count",function(e){t(e.data)},i,{toCount:c.count})},this.countAll=function(e,t,i,n,c){r.batchIncompatible("DynamicsWebApi.countAll",a),this.retrieveAllRequest({collection:e,filter:n,select:c},function(e){t(e&&e.value?e.value.length:0)},i)},this.retrieveMultiple=function(e,t,a,i,n,r){this.retrieveMultipleRequest({collection:e,select:i,filter:n},t,a,r)},this.retrieveAll=function(e,t,i,n,c){r.batchIncompatible("DynamicsWebApi.retrieveAll",a),l({collection:e,select:n,filter:c},t,i)};var s=function(e,t,i,n){a||(r.callbackParameterCheck(t,"DynamicsWebApi.retrieveMultiple","successCallback"),r.callbackParameterCheck(i,"DynamicsWebApi.retrieveMultiple","errorCallback")),n&&(r.stringParameterCheck(n,"DynamicsWebApi.retrieveMultiple","oDataLink"),e.url=n),o("GET",e,"retrieveMultiple",function(e){t(e.data)},i)};this.retrieveMultipleRequest=s;var l=function(e,t,a,i,n){n=n||[],s(e,function(i){n=n.concat(i.value);var r=i.oDataNextLink;if(r)l(e,t,a,r,n);else{var c={value:n};i.oDataDeltaLink&&(c["@odata.deltaLink"]=i.oDataDeltaLink,c.oDataDeltaLink=i.oDataDeltaLink),t(c)}},a,i)};this.retrieveAllRequest=function(e,t,i){r.batchIncompatible("DynamicsWebApi.retrieveAllRequest",a),l(e,t,i)};var u=function(e,t,i,n,c,s,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","collection"),r.stringParameterCheck(t,"DynamicsWebApi.executeFetchXml","fetchXml"),a||(r.callbackParameterCheck(i,"DynamicsWebApi.executeFetchXml","successCallback"),r.callbackParameterCheck(n,"DynamicsWebApi.executeFetchXml","errorCallback")),s=s||1,r.numberParameterCheck(s,"DynamicsWebApi.executeFetchXml","pageNumber");var p='$1 page="'+s+'"';null!=l&&(r.stringParameterCheck(l,"DynamicsWebApi.executeFetchXml","pagingCookie"),p+=' paging-cookie="'+l+'"'),t=t.replace(/^(<fetch)/,p),o("GET",{collection:e,includeAnnotations:c,impersonate:u,fetchXml:t},"executeFetchXml",function(e){i(e.data)},n,{pageNumber:s})};this.fetch=u,this.executeFetchXml=u;var p=function(e,t,a,i,n,r,c,o,s){s=s||[],u(e,t,function(r){s=s.concat(r.value),r.PagingInfo?p(e,t,a,i,n,r.PagingInfo.nextPage,r.PagingInfo.cookie,o,s):a({value:s})},i,n,r,c,o)},m=function(e,t,i,n,c,o){r.batchIncompatible("DynamicsWebApi.executeFetchXmlAll",a),p(e,t,i,n,c,null,null,o)};this.fetchAll=m,this.executeFetchXmlAll=m,this.associate=function(e,t,i,n,c,s,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associate","collection"),r.stringParameterCheck(n,"DynamicsWebApi.associate","relatedCollection"),r.stringParameterCheck(i,"DynamicsWebApi.associate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.associate","primaryKey"),c=r.keyParameterCheck(c,"DynamicsWebApi.associate","relatedKey"),a||(r.callbackParameterCheck(s,"DynamicsWebApi.associate","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associate","errorCallback")),o("POST",{_additionalUrl:i+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":n+"("+c+")"}},"associate",function(){s()},l)},this.disassociate=function(e,t,i,n,c,s,l){r.stringParameterCheck(e,"DynamicsWebApi.disassociate","collection"),r.stringParameterCheck(i,"DynamicsWebApi.disassociate","relationshipName"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociate","primaryKey"),n=r.keyParameterCheck(n,"DynamicsWebApi.disassociate","relatedKey"),a||(r.callbackParameterCheck(c,"DynamicsWebApi.disassociate","successCallback"),r.callbackParameterCheck(s,"DynamicsWebApi.disassociate","errorCallback")),o("DELETE",{_additionalUrl:i+"("+n+")/$ref",collection:e,key:t,impersonate:l},"disassociate",function(){c()},s)},this.associateSingleValued=function(e,t,i,n,c,s,l,u){r.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.associateSingleValued","key"),c=r.keyParameterCheck(c,"DynamicsWebApi.associateSingleValued","relatedKey"),r.stringParameterCheck(i,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),r.stringParameterCheck(n,"DynamicsWebApi.associateSingleValued","relatedCollection"),a||(r.callbackParameterCheck(s,"DynamicsWebApi.associateSingleValued","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.associateSingleValued","errorCallback")),o("PUT",{_additionalUrl:i+"/$ref",collection:e,key:t,impersonate:u,data:{"@odata.id":n+"("+c+")"}},"associateSingleValued",function(){s()},l)},this.disassociateSingleValued=function(e,t,i,n,c,s){r.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=r.keyParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","key"),r.stringParameterCheck(i,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName"),a||(r.callbackParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","successCallback"),r.callbackParameterCheck(c,"DynamicsWebApi.disassociateSingleValued","errorCallback")),o("DELETE",{_additionalUrl:i+"/$ref",key:t,collection:e,impersonate:s},"disassociateSingleValued",function(){n()},c)},this.executeUnboundFunction=function(e,t,a,i,n){h(e,i,null,null,t,a,n,!0)},this.executeBoundFunction=function(e,t,a,i,n,r,c){h(a,r,t,e,i,n,c)};var h=function(e,t,i,c,s,l,u,p){r.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName"),a||(r.callbackParameterCheck(s,"DynamicsWebApi.executeFunction","successCallback"),r.callbackParameterCheck(l,"DynamicsWebApi.executeFunction","errorCallback"));var m={_additionalUrl:e+n.buildFunctionParameters(t),_unboundRequest:p,key:c,collection:i,impersonate:u};o("GET",m,"executeFunction",function(e){s(e.data)},l)};this.executeUnboundAction=function(e,t,a,i,n){y(e,t,null,null,a,i,n,!0)},this.executeBoundAction=function(e,t,a,i,n,r,c){y(a,i,t,e,n,r,c)};var y=function(e,t,i,n,c,s,l,u){r.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName"),a||(r.callbackParameterCheck(c,"DynamicsWebApi.executeAction","successCallback"),r.callbackParameterCheck(s,"DynamicsWebApi.executeAction","errorCallback")),o("POST",{_additionalUrl:e,_unboundRequest:u,collection:i,key:n,impersonate:l,data:t},"executeAction",function(e){c(e.data)},s)};this.createEntity=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createEntity","entityDefinition");var i={collection:"EntityDefinitions",entity:e};this.createRequest(i,t,a)},this.updateEntity=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateEntity","entityDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateEntity","entityDefinition.MetadataId");var n={collection:"EntityDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.retrieveEntity=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveEntity","entityKey");var c={collection:"EntityDefinitions",key:e,select:i,expand:n};this.retrieveRequest(c,t,a)},this.retrieveEntities=function(e,t,a,i){var n={collection:"EntityDefinitions",select:a,filter:i};this.retrieveRequest(n,e,t)},this.createAttribute=function(e,t,a,i){r.keyParameterCheck(e,"DynamicsWebApi.createAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.createAttribute","attributeDefinition");var n={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes"};this.createRequest(n,a,i)},this.updateAttribute=function(e,t,a,i,n,c){r.keyParameterCheck(e,"DynamicsWebApi.updateAttribute","entityKey"),r.parameterCheck(t,"DynamicsWebApi.updateAttribute","attributeDefinition"),r.guidParameterCheck(t.MetadataId,"DynamicsWebApi.updateAttribute","attributeDefinition.MetadataId"),n&&r.stringParameterCheck(n,"DynamicsWebApi.updateAttribute","attributeType");var o={collection:"EntityDefinitions",key:e,entity:t,navigationProperty:"Attributes",navigationPropertyKey:t.MetadataId,mergeLabels:c,metadataAttributeType:n};this.updateRequest(o,a,i)},this.retrieveAttributes=function(e,t,a,i,n,c,o){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttributes","entityKey"),i&&r.stringParameterCheck(i,"DynamicsWebApi.retrieveAttributes","attributeType");var s={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:n,filter:c,expand:o,metadataAttributeType:i};this.retrieveRequest(s,t,a)},this.retrieveAttribute=function(e,t,a,i,n,c,o){r.keyParameterCheck(e,"DynamicsWebApi.retrieveAttribute","entityKey"),r.keyParameterCheck(t,"DynamicsWebApi.retrieveAttribute","attributeKey"),n&&r.stringParameterCheck(n,"DynamicsWebApi.retrieveAttribute","attributeType");var s={collection:"EntityDefinitions",key:e,navigationProperty:"Attributes",select:c,expand:o,metadataAttributeType:n,navigationPropertyKey:t};this.retrieveRequest(s,a,i)},this.createRelationship=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createRelationship","relationshipDefinition");var i={collection:"RelationshipDefinitions",entity:e};this.createRequest(i,t,a)},this.updateRelationship=function(e,t,a,i,n){r.parameterCheck(e,"DynamicsWebApi.updateRelationship","relationshipDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateRelationship","relationshipDefinition.MetadataId");var c={collection:"RelationshipDefinitions",mergeLabels:n,key:e.MetadataId,entity:e,navigationProperty:i};this.updateRequest(c,t,a)},this.deleteRelationship=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteRelationship","metadataId");var i={collection:"RelationshipDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveRelationships=function(e,t,a,i,n){var r={collection:"RelationshipDefinitions",navigationProperty:a,select:i,filter:n};this.retrieveMultipleRequest(r,e,t)},this.retrieveRelationship=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveRelationship","metadataId");var c={collection:"RelationshipDefinitions",navigationProperty:i,key:e,select:n};this.retrieveRequest(c,t,a)},this.createGlobalOptionSet=function(e,t,a){r.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","globalOptionSetDefinition");var i={collection:"GlobalOptionSetDefinitions",entity:e};this.createRequest(i,t,a)},this.updateGlobalOptionSet=function(e,t,a,i){r.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition"),r.guidParameterCheck(e.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","globalOptionSetDefinition.MetadataId");var n={collection:"GlobalOptionSetDefinitions",mergeLabels:i,key:e.MetadataId,entity:e};this.updateRequest(n,t,a)},this.deleteGlobalOptionSet=function(e,t,a){r.keyParameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","globalOptionSetKey");var i={collection:"GlobalOptionSetDefinitions",key:e};this.deleteRequest(i,t,a)},this.retrieveGlobalOptionSet=function(e,t,a,i,n){r.keyParameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","globalOptionSetKey");var c={collection:"GlobalOptionSetDefinitions",key:e,navigationProperty:i,select:n};this.retrieveRequest(c,t,a)},this.retrieveGlobalOptionSets=function(e,t,a,i){var n={collection:"GlobalOptionSetDefinitions",navigationProperty:a,select:i};this.retrieveMultipleRequest(n,e,t)},this.startBatch=function(){a=!0},this.executeBatch=function(e,t){r.batchNotStarted(a),r.callbackParameterCheck(e,"DynamicsWebApi.executeBatch","successCallback"),r.callbackParameterCheck(t,"DynamicsWebApi.executeBatch","errorCallback"),a=!1,o("POST",{collection:"$batch"},"executeBatch",function(t){e(t.data)},t)},this.initializeInstance=function(e){return e||(e=t),new i(e)}}var n=(a(1),a(2)),r=(a(4),a(0)),c=a(5);String.prototype.endsWith&&String.prototype.startsWith||a(3),i.prototype.utility={getCollectionName:c.getCollectionName},e.exports=i},function(e,t){Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t){e.exports=function(e,t){var a;return"string"==typeof t&&(a=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(t))?new Date(Date.UTC(+a[1],+a[2]-1,+a[3],+a[4],+a[5],+a[6])):t}},function(e,t,a){function i(e,t){var a=null;if(-1!==e.indexOf("@")){var i=e.split("@");switch(i[1]){case"odata.context":a="oDataContext";break;case"odata.count":a="oDataCount",t=null!=t?parseInt(t):0;break;case"odata.nextLink":a="oDataNextLink";break;case"odata.deltaLink":a="oDataDeltaLink";break;case c.Prefer.Annotations.FormattedValue:a=i[0]+"_Formatted";break;case c.Prefer.Annotations.AssociatedNavigationProperty:a=i[0]+"_NavigationProperty";break;case c.Prefer.Annotations.LookupLogicalName:a=i[0]+"_LogicalName"}}return[a,t]}function n(e,t){if(t){if(t.isRef&&null!=e["@odata.id"])return o.convertToReferenceObject(e);if(t.toCount)return i("@odata.count",e["@odata.count"])[1]||0}for(var a=Object.keys(e),r=0;r<a.length;r++){var s=a[r];if(null!=e[s]&&e[s].constructor===Array)for(var l=0;l<e[s].length;l++)e[s][l]=n(e[s][l]);var u=i(s,e[s]);if(u[0]&&(e[u[0]]=u[1]),-1!==s.indexOf("_x002e_")){var p=s.split("_x002e_");if(e.hasOwnProperty(p[0])){if("object"!=typeof e[p[0]]||"object"==typeof e[p[0]]&&!e[p[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!")}else e[p[0]]={_dwaType:"alias"};e[p[0]][p[1]]=e[s],u=i(p[1],e[s]),u[0]&&(e[p[0]][u[0]]=u[1])}}return t&&t.hasOwnProperty("pageNumber")&&null!=e["@"+c.Prefer.Annotations.FetchXmlPagingCookie]&&(e.PagingInfo=o.getFetchXmlPagingCookie(e["@"+c.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}function r(e,t,a){var i=e.substr(0,e.indexOf("\r\n")),c=e.split(i);c.shift(),c.pop(),a=a||0;for(var o=[],u=0;u<c.length;u++){var p=c[u];if(p.indexOf("--changesetresponse_")>-1){p=p.trim();var m=p.substring(p.indexOf("\r\n")+1).trim();o=o.concat(r(m,t,a))}else{var h=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(p),y=parseInt(h[1]),f=h[2].trim(),b=p.substring(p.indexOf("{"),p.lastIndexOf("}")+1);if(b){var d=n(JSON.parse(b,l),t[a]);y>=400?o.push(s.handleHttpError(d,{status:y,statusText:f,statusMessage:f})):o.push(d)}else if(/Content-Type: text\/plain/i.test(p)){var k=/\w+$/gi.exec(p.trim()),g=k&&k.length?k[0]:void 0;o.push(isNaN(g)?g:parseInt(g))}else if(t.length&&t[a]&&t[a].hasOwnProperty("valueIfEmpty"))o.push(t[a].valueIfEmpty);else{var A=/OData-EntityId.+/i.exec(p);if(A&&A.length){var C=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(A[0]);o.push(C?C[1]:void 0)}else o.push(void 0)}}a++}return o}var c=a(1),o=a(2),s=a(0),l=a(8);String.prototype.endsWith&&String.prototype.startsWith||a(3),e.exports=function(e,t,a){var i=void 0;if(e.length)if(e.indexOf("--batchresponse_")>-1){var c=r(e,a);i=1===a.length&&a[0].convertedToBatch?c[0]:c}else i=n(JSON.parse(e,l),a[0]);else if(a.length&&a[0].hasOwnProperty("valueIfEmpty"))i=a[0].valueIfEmpty;else if(t["OData-EntityId"]||t["odata-entityid"]){var o=t["OData-EntityId"]?t["OData-EntityId"]:t["odata-entityid"],s=/([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})\)$/i.exec(o);s&&(i=s[1])}return a.length=0,i}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var a=e.split("\r\n"),i=0,n=a.length;i<n;i++){var r=a[i],c=r.indexOf(": ");c>0&&(t[r.substring(0,c)]=r.substring(c+2))}return t}},function(e,t,a){var i=a(9),n=a(10),r=a(0);Array.isArray||a(7);var c=function(e){var t=e.method,a=e.uri,c=e.data,o=e.additionalHeaders,s=e.responseParams,l=e.successCallback,u=e.errorCallback,p=e.isAsync,m=new XMLHttpRequest;m.open(t,a,p);for(var h in o)m.setRequestHeader(h,o[h]);m.onreadystatechange=function(){if(4===m.readyState){switch(m.status){case 200:case 201:case 204:case 304:var e=n(m.getAllResponseHeaders()),t=i(m.responseText,e,s),a={data:t,headers:e,status:m.status};l(a);break;default:var c;try{var o=i(m.responseText,n(m.getAllResponseHeaders()),s);if(Array.isArray(o)){u(o);break}c=o.error}catch(e){c=m.response.length>0?{message:m.response}:{message:"Unexpected Error"}}u(r.handleHttpError(c,{status:m.status,statusText:m.statusText}))}m=null,s.length=0}},e.timeout&&(m.timeout=e.timeout),m.onerror=function(){u(r.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Network Error"})),s.length=0,m=null},m.ontimeout=function(){u(r.handleHttpError({status:m.status,statusText:m.statusText,message:m.responseText||"Request Timed Out"})),s.length=0,m=null},c?m.send(c):m.send()};e.exports=c},function(e,t,a){var i=a(2),n=function(e){for(var t="dwa_batch_"+i.generateUUID(),a=[],n=null,r=1e5,c=0;c<e.length;c++){var o=e[c],s="GET"===o.method;if(s&&n&&(a.push("\n--"+n+"--"),n=null,r=1e5),n||(a.push("\n--"+t),s||(n="changeset_"+i.generateUUID(),a.push("Content-Type: multipart/mixed;boundary="+n))),s||a.push("\n--"+n),a.push("Content-Type: application/http"),a.push("Content-Transfer-Encoding: binary"),!s){var l=o.headers.hasOwnProperty("Content-ID")?o.headers["Content-ID"]:++r;a.push("Content-ID: "+l)}o.path.startsWith("$")?a.push("\n"+o.method+" "+o.path+" HTTP/1.1"):a.push("\n"+o.method+" "+o.config.webApiUrl+o.path+" HTTP/1.1"),s?a.push("Accept: application/json"):a.push("Content-Type: application/json");for(var u in o.headers)"Authorization"!==u&&"Content-ID"!==u&&a.push(u+": "+o.headers[u]);!s&&o.data&&o.data.length&&a.push("\n"+o.data)}return n&&a.push("\n--"+n+"--"),a.push("\n--"+t+"--"),{boundary:t,body:a.join("\n")}},r={convertToBatch:n};e.exports=r},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),a="",i="",n=1;n<=t.length;n++){var r=t[n-1],c=e[r];null!==c&&("string"==typeof c?c="'"+c+"'":"object"==typeof c&&(c=JSON.stringify(c)),n>1&&(a+=",",i+="&"),a+=r+"=@p"+n,i+="@p"+n+"="+c)}return"("+a+")?"+i}return"()"}},function(e,t,a){var i=a(1),n=a(0);e.exports=function(e,t,a){var r,c=e.returnRepresentation,o=e.includeAnnotations,s=e.maxPageSize,l=e.trackChanges;if(e.prefer&&e.prefer.length){n.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer"),r=e.prefer,"string"==typeof r&&(r=r.split(","));for(var u in r){var p=r[u].trim();p===i.Prefer.ReturnRepresentation?c=!0:p.indexOf("odata.include-annotations=")>-1?o=p.replace("odata.include-annotations=","").replace(/"/g,""):p.startsWith("odata.maxpagesize=")?s=p.replace("odata.maxpagesize=","").replace(/"/g,""):p.indexOf("odata.track-changes")>-1&&(l=!0)}}return r=[],a&&(null==c&&(c=a.returnRepresentation),o=o||a.includeAnnotations,s=s||a.maxPageSize),c&&(n.boolParameterCheck(c,"DynamicsWebApi."+t,"request.returnRepresentation"),r.push(i.Prefer.ReturnRepresentation)),o&&(n.stringParameterCheck(o,"DynamicsWebApi."+t,"request.includeAnnotations"),r.push('odata.include-annotations="'+o+'"')),s&&s>0&&(n.numberParameterCheck(s,"DynamicsWebApi."+t,"request.maxPageSize"),r.push("odata.maxpagesize="+s)),l&&(n.boolParameterCheck(l,"DynamicsWebApi."+t,"request.trackChanges"),r.push("odata.track-changes")),r.join(",")}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var a=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=a){var i=parseInt(a[2]);return{cookie:a[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:i,nextPage:i+1}}return{cookie:"",page:t,nextPage:t+1}}}])});