/*! dynamics-web-api v2.3.0-beta (c) 2025 Aleksandr Rogov. License: MIT */
"use strict";var _dynamicsWebApiExports=(()=>{var j=Object.defineProperty;var rt=Object.getOwnPropertyDescriptor;var ot=Object.getOwnPropertyNames;var st=Object.prototype.hasOwnProperty;var he=e=>{throw TypeError(e)};var h=(e,t)=>()=>(e&&(t=e(e=0)),t);var ge=(e,t)=>{for(var n in t)j(e,n,{get:t[n],enumerable:!0})},ct=(e,t,n,i)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of ot(t))!st.call(e,a)&&a!==n&&j(e,a,{get:()=>t[a],enumerable:!(i=rt(t,a))||i.enumerable});return e};var Re=e=>ct(j({},"__esModule",{value:!0}),e);var be=(e,t,n)=>t.has(e)||he("Cannot "+n);var l=(e,t,n)=>(be(e,t,"read from private field"),n?n.call(e):t.get(e)),U=(e,t,n)=>t.has(e)?he("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),w=(e,t,n,i)=>(be(e,t,"write to private field"),i?i.call(e,n):t.set(e,n),n);function Ae(){return window.crypto}var Ce=h(()=>{"use strict"});function xe(e){return!!lt.exec(e)}function _(e){let t=pt.exec(e);return t?t[1]:null}function L(e){if(!e)return null;let t=ut.exec(e);return t?t[1]:null}function Y(e){return e.replace(mt,(t,n)=>n)}function Pe(e){return e.split(yt).map((n,i)=>i%2===0?Y(n):n).join("")}function De(e){let t=dt.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}function ke(e){let t=ft.exec(e);if(!t)return null;let n=parseInt(t[2],10),i=gt(t[1]);return{page:n,sanitizedCookie:i}}function gt(e){let t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(ht,n=>t[n])}function Te(e){return e.replace(Rt,"")}function Ee(e){return e.replace(bt,t=>`\\u${("0000"+t.charCodeAt(0).toString(16)).slice(-4)}`)}function J(e){return e.replace(At,"")}function Se(e){return Ct.test(e??"")?"PUT":"PATCH"}var O,lt,pt,ut,mt,dt,yt,ft,ht,Rt,bt,At,ve,Z,We,Ne,Ie,H,ee,Ct,Ue,$e,we,Oe,b=h(()=>{"use strict";O="[0-9a-fA-F]{8}[-]?([0-9a-fA-F]{4}[-]?){3}[0-9a-fA-F]{12}",lt=new RegExp(O,"i"),pt=new RegExp("^{?("+O+")}?$","i"),ut=new RegExp("("+O+")\\)$","i"),mt=new RegExp(`{(${O})}`,"g"),dt=new RegExp(`\\/(\\w+)\\((${O})`,"i");yt=/(["'].*?["'])/;ft=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/,ht=/[<>"']/g;Rt=/^\//;bt=/[\u007F-\uFFFF]/g;At=/"/g;ve=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,Z=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/m,We=/Content-Type: text\/plain/i,Ne=/OData-EntityId.+/i,Ie=/\w+$/g,H=/\r?\n/,ee=/(\w+)(\([\d\w-]+\))$/,Ct=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/;Ue=/^<fetch.+top=/,$e=/^<fetch.+page=/,we=/^(<fetch)/,Oe=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/});function xt(e){return e==null?"":typeof e=="string"&&!e.startsWith("Microsoft.Dynamics.CRM")&&!xe(e)?`'${e}'`:typeof e=="object"?JSON.stringify(e):e.toString()}function Pt(e){let t=Object.keys(e),n=[],i=[];return t.forEach((a,o)=>{let s=e[a];if(s==null)return;s=xt(s);let c=o+1;n.push(`${a}=@p${c}`),i.push(`@p${c}=${_(s)||s}`)}),{key:`(${n.join(",")})`,queryParams:i}}function _e(e,t){return e.hasOwnProperty(t)||e.hasOwnProperty(t.toLowerCase())}function B(e,t){return e[t]?e[t]:e[t.toLowerCase()]}function Be(e){return e?Pt(e):{key:"()"}}function Me(e="",t=1){e=decodeURIComponent(decodeURIComponent(e));let n=ke(e);return{cookie:n?.sanitizedCookie||"",page:n?.page||t,nextPage:n?.page?n.page+1:t+1}}function f(e){return typeof e>"u"||e==null}function D(){return Ae().randomUUID()}function Dt(){if(typeof GetGlobalContext<"u")return GetGlobalContext();if(typeof Xrm<"u"){if(!f(Xrm.Utility)&&!f(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!f(Xrm.Page)&&!f(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function Fe(){let t=Dt().getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}function K(){return!!window.shell}function M(e){return typeof e=="object"&&!!e&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Date]"}function k(e,t){let n={};for(let i in e)e.hasOwnProperty(i)&&!t?.includes(i)&&(M(e[i])?n[i]=k(e[i]):Array.isArray(e[i])?n[i]=e[i].slice():n[i]=e[i]);return n}function m(e,t=[]){t.includes("signal")||t.push("signal");let n=k(e,t);return n.signal=e.signal,n}function Ge(e,t,n,i){i=i||0;let a=i+n>t.length?t.length%n:n,o;o=new Uint8Array(a);for(let s=0;s<a;s++)o[s]=t[i+s];e.data=o,e.contentRange="bytes "+i+"-"+(i+a-1)+"/"+t.length}function qe(e){let t=new Uint8Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}var te,T=h(()=>{"use strict";Ce();b();te=4194304});function g(e,t,n){throw new Error(n?`${e} requires a ${t} parameter to be of type ${n}.`:`${e} requires a ${t} parameter.`)}var r,A=h(()=>{"use strict";b();r=class e{static handleErrorResponse(t){throw new Error(`Error: ${t.status}: ${t.message}`)}static parameterCheck(t,n,i,a){(typeof t>"u"||t===null||t==="")&&g(n,i,a)}static stringParameterCheck(t,n,i){typeof t!="string"&&g(n,i,"String")}static maxLengthStringParameterCheck(t,n,i,a){if(t&&t.length>a)throw new Error(`${i} has a ${a} character limit.`)}static arrayParameterCheck(t,n,i){t.constructor!==Array&&g(n,i,"Array")}static stringOrArrayParameterCheck(t,n,i){t.constructor!==Array&&typeof t!="string"&&g(n,i,"String or Array")}static numberParameterCheck(t,n,i){if(typeof t!="number"){if(typeof t=="string"&&t&&!isNaN(parseInt(t)))return;g(n,i,"Number")}}static batchIsEmpty(){return[new Error("Payload of the batch operation is empty. Please make that you have other operations in between startBatch() and executeBatch() to successfuly build a batch payload.")]}static handleHttpError(t,n){let i=new Error;return Object.keys(t).forEach(a=>{i[a]=t[a]}),n&&Object.keys(n).forEach(a=>{i[a]=n[a]}),i}static boolParameterCheck(t,n,i){typeof t!="boolean"&&g(n,i,"Boolean")}static guidParameterCheck(t,n,i){let a=_(t);return a||g(n,i,"GUID String"),a}static keyParameterCheck(t,n,i){try{e.stringParameterCheck(t,n,i);let a=_(t);if(a)return a;let o=t.split(",");if(o.length)for(let s=0;s<o.length;s++)o[s]=o[s].trim().replace(/"/g,"'"),/^[\w\d\_]+\=(.+)$/i.exec(o[s])[0];return o.join(",")}catch{g(n,i,"String representing GUID or Alternate Key")}}static callbackParameterCheck(t,n,i){typeof t!="function"&&g(n,i,"Function")}static throwBatchIncompatible(t,n){if(n)throw n=!1,new Error(t+" cannot be used in a BATCH request.")}static throwBatchNotStarted(t){if(!t)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")}}});var E,G,z,x,He=h(()=>{"use strict";z=class z{};z.Prefer=(G=class{static get(t){return`${z.Prefer.IncludeAnnotations}="${t}"`}},G.ReturnRepresentation="return=representation",G.Annotations=(E=class{},E.AssociatedNavigationProperty="Microsoft.Dynamics.CRM.associatednavigationproperty",E.LookupLogicalName="Microsoft.Dynamics.CRM.lookuplogicalname",E.All="*",E.FormattedValue="OData.Community.Display.V1.FormattedValue",E.FetchXmlPagingCookie="Microsoft.Dynamics.CRM.fetchxmlpagingcookie",E),G.IncludeAnnotations="odata.include-annotations",G);x=z});function Ke(e,t){if(typeof t=="string"){let n=Oe.exec(t);if(n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]))}return t}var Ve=h(()=>{"use strict";b()});function vt(e){let t={position:0},n={},i,a,o;do{if(o=t.position,a=Wt(e,t),!a)break;i=ve.exec(a),i!==null?n[i[1].toLowerCase()]=i[2]:t.position=o}while(a&&i);return n}function Wt(e,t){return Nt(e,t,H)}function Nt(e,t,n){let i=t.position||0,a=e.slice(i),o=n.exec(a);if(!o)return null;let s=i+o.index;return t.position=s+o[0].length,e.substring(i,s)}function It(e){let t=Z.exec(e);return{httpStatusString:t[0],httpStatus:parseInt(t[1]),httpStatusMessage:t[2].trim()}}function St(e){Z.lastIndex=0;let t=Ie.exec(e.trim());return t?.length?t[0]:void 0}function Ut(e,t,n){let i=St(e);return se(i)}function $t(e,t,n){if(t?.[n]?.valueIfEmpty!==void 0)return t[n].valueIfEmpty;{let i=Ne.exec(e);return L(i?.[0])??void 0}}function wt(e,t,n){let{httpStatusString:i,httpStatus:a,httpStatusMessage:o}=It(e),s=e.substring(e.indexOf("{"),e.lastIndexOf("}")+1);if(!s)return We.test(e)?Ut(e,t,n):$t(e,t,n);let c=oe(s,t,n);if(a<400)return c;let y=vt(e.substring(e.indexOf(i)+i.length+1,e.indexOf("{")));return r.handleHttpError(c,{status:a,statusText:o,statusMessage:o,headers:y})}function re(e,t,n=0){let i=e.substring(0,e.search(H)),a=e.split(i);a.shift(),a.pop();let o=[];for(let s of a){if(s.indexOf("--changesetresponse_")===-1){o.push(wt(s,t,n++));continue}s=s.trim();let c=s.substring(s.search(H)+1).trim();o=o.concat(re(c,t,n++))}return o}var ze=h(()=>{"use strict";A();b();ce()});function le(e,t){let n=null;if(e.indexOf("@")!==-1){let i=e.split("@");switch(i[1]){case"odata.context":n="oDataContext";break;case"odata.count":n="oDataCount",t=t!=null?parseInt(t):0;break;case"odata.nextLink":n="oDataNextLink";break;case"odata.deltaLink":n="oDataDeltaLink";break;case x.Prefer.Annotations.FormattedValue:n=i[0]+"_Formatted";break;case x.Prefer.Annotations.AssociatedNavigationProperty:n=i[0]+"_NavigationProperty";break;case x.Prefer.Annotations.LookupLogicalName:n=i[0]+"_LogicalName";break}}return[n,t]}function pe(e,t){if(t){if(t.isRef&&e["@odata.id"]!=null)return De(e);if(t.toCount)return le("@odata.count",e["@odata.count"])[1]||0}for(let i in e){if(e[i]!=null)if(Array.isArray(e[i]))for(var n=0;n<e[i].length;n++)e[i][n]=pe(e[i][n]);else typeof e[i]=="object"&&pe(e[i]);let a=le(i,e[i]);if(a[0]&&(e[a[0]]=a[1]),i.indexOf("_x002e_")!==-1){let o=i.split("_x002e_");if(!e.hasOwnProperty(o[0]))e[o[0]]={_dwaType:"alias"};else if(typeof e[o[0]]!="object"||typeof e[o[0]]=="object"&&!e[o[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!");e[o[0]][o[1]]=e[i],a=le(o[1],e[i]),a[0]&&(e[o[0]][a[0]]=a[1])}}return t&&t.hasOwnProperty("pageNumber")&&e["@"+x.Prefer.Annotations.FetchXmlPagingCookie]!=null&&(e.PagingInfo=Me(e["@"+x.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}function Ot(e){return window.atob(e)}function _t(e,t,n){let i=e;n?.hasOwnProperty("parse")&&(i=JSON.parse(i).value,i=Ot(i));let a={value:i};t["x-ms-file-name"]&&(a.fileName=t["x-ms-file-name"]),t["x-ms-file-size"]&&(a.fileSize=parseInt(t["x-ms-file-size"]));let o=B(t,"Location");return o&&(a.location=o),a}function Bt(e){return e.indexOf("--batchresponse_")>-1}function Mt(e){return _e(e,"Content-Disposition")}function Ft(e){return B(e,"Content-Type")?.startsWith("application/json")==!0}function Gt(e,t){let n=re(e,t);return t?.[0].convertedToBatch?n[0]:n}function qt(e,t,n){return _t(e,t,n[0])}function oe(e,t,n=0){return pe(JSON.parse(e,Ke),t[n])}function se(e){let t=Number(e);return isFinite(t)?t:e}function Xt(e,t){if(t?.[0]?.valueIfEmpty!==void 0)return t[0].valueIfEmpty;let n=B(e,"OData-EntityId");if(n)return L(n)??void 0;let i=B(e,"Location");if(i){let a={location:i};return e["x-ms-chunk-size"]&&(a.chunkSize=parseInt(e["x-ms-chunk-size"])),a}}function ue(e,t,n){return e.length?Bt(e)?Gt(e,n):Mt(t)?qt(e,t,n):Ft(t)?oe(e,n):se(e):Xt(t,n)}var ce=h(()=>{"use strict";He();T();Ve();b();ze()});function v(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let i=0,a=n.length;i<a;i++){let o=n[i],s=o.indexOf(": ");s>0&&(t[o.substring(0,s)]=o.substring(s+2))}return t}var Qe=h(()=>{"use strict"});var je={};ge(je,{XhrWrapper:()=>q,executeRequest:()=>Lt});function Lt(e){return new Promise((t,n)=>{Ht(e,t,n)})}function Ht(e,t,n){let i=e.data,a=e.headers,o=e.responseParams,s=e.abortSignal;if(s?.aborted){n(r.handleHttpError({name:"AbortError",code:20,message:"The user aborted a request."}));return}let c=new XMLHttpRequest;c.open(e.method,e.uri,e.isAsync||!1);for(let p in a)c.setRequestHeader(p,a[p]);c.onreadystatechange=function(){if(c.readyState===4)switch(s&&s.removeEventListener("abort",y),c.status){case 200:case 201:case 204:case 206:case 304:{let P=v(c.getAllResponseHeaders()),it={data:ue(c.responseText,P,o[e.requestId]),headers:P,status:c.status};c=null,t(it);break}case 0:break;default:if(!c)break;let p,d;try{d=v(c.getAllResponseHeaders());let P=ue(c.responseText,d,o[e.requestId]);if(Array.isArray(P)){n(P);break}p=P.error}catch{c.response.length>0?p={message:c.response}:p={message:"Unexpected Error"}}let R={status:c.status,statusText:c.statusText,headers:d};c=null,n(r.handleHttpError(p,R));break}},e.timeout&&(c.timeout=e.timeout),c.onerror=function(){let p=v(c.getAllResponseHeaders());n(r.handleHttpError({status:c.status,statusText:c.statusText,message:c.responseText||"Network Error",headers:p})),c=null},c.ontimeout=function(){let p=v(c.getAllResponseHeaders());n(r.handleHttpError({name:"TimeoutError",status:c.status,statusText:c.statusText,message:c.responseText||"Request Timed Out",headers:p})),c=null},c.onabort=function(){if(!c)return;let p=v(c.getAllResponseHeaders());n(r.handleHttpError({status:c.status,statusText:c.statusText,message:"Request aborted",headers:p})),c=null};let y=()=>{if(!c)return;let p=v(c.getAllResponseHeaders());n(r.handleHttpError({name:"AbortError",code:20,status:c.status,statusText:c.statusText,message:"The user aborted a request.",headers:p})),c.abort(),c=null};s&&s.addEventListener("abort",y),i?c.send(i):c.send(),q.afterSendEvent&&q.afterSendEvent()}var q,Ye=h(()=>{"use strict";A();ce();Qe();q=class{}});var en={};ge(en,{DynamicsWebApi:()=>ye});T();A();T();T();A();b();var C=null,Xe=e=>{C=e},V=(e,t)=>{if(e.path=e.path||"",e.functionName=e.functionName||"",e.url)r.stringParameterCheck(e.url,`DynamicsWebApi.${e.functionName}`,"request.url"),e.path=e.url.replace(t.dataApi.url,"");else if(!e._isUnboundRequest&&!e.contentId&&!e.collection&&r.parameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.collection!=null&&(r.stringParameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.path=e.collection,e.key&&(e.key=r.keyParameterCheck(e.key,`DynamicsWebApi.${e.functionName}`,"request.key"),e.path+=`(${e.key})`)),e.contentId&&(r.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")&&(e.path=e.path?`${e.contentId}/${e.path}`:e.contentId)),e.addPath&&(e.path&&(e.path+="/"),e.path+=e.addPath),e.path=Le(e,t,e.path),e.fetchXml){r.stringParameterCheck(e.fetchXml,`DynamicsWebApi.${e.functionName}`,"request.fetchXml");let n=e.path.indexOf("?")===-1?"?":"&";e.path+=`${n}fetchXml=${encodeURIComponent(e.fetchXml)}`}return e.hasOwnProperty("async")&&e.async!=null?r.boolParameterCheck(e.async,`DynamicsWebApi.${e.functionName}`,"request.async"):e.async=!0,e.headers=kt(e,t),e},Le=(e,t,n="",i="&")=>{let a=[];if(e){if(e.navigationProperty){if(r.stringParameterCheck(e.navigationProperty,`DynamicsWebApi.${e.functionName}`,"request.navigationProperty"),n+="/"+e.navigationProperty,e.navigationPropertyKey){let o=r.keyParameterCheck(e.navigationPropertyKey,`DynamicsWebApi.${e.functionName}`,"request.navigationPropertyKey");n+="("+o+")"}e.navigationProperty==="Attributes"&&e.metadataAttributeType&&(r.stringParameterCheck(e.metadataAttributeType,`DynamicsWebApi.${e.functionName}`,"request.metadataAttributeType"),n+="/"+e.metadataAttributeType)}if(e.select?.length&&(r.arrayParameterCheck(e.select,`DynamicsWebApi.${e.functionName}`,"request.select"),e.functionName=="retrieve"&&e.select.length==1&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&e.functionName=="retrieve"&&(e.navigationProperty==null?n+=e.select.shift():e.select.shift()),e.select.length&&a.push("$select="+e.select.join(",")))),e.filter){r.stringParameterCheck(e.filter,`DynamicsWebApi.${e.functionName}`,"request.filter");let o=Pe(e.filter);a.push("$filter="+encodeURIComponent(o))}if(e.fieldName&&(r.stringParameterCheck(e.fieldName,`DynamicsWebApi.${e.functionName}`,"request.fieldName"),e.property||(e.property=e.fieldName),delete e.fieldName),e.property&&(r.stringParameterCheck(e.property,`DynamicsWebApi.${e.functionName}`,"request.property"),n+="/"+e.property),e.savedQuery&&a.push("savedQuery="+r.guidParameterCheck(e.savedQuery,`DynamicsWebApi.${e.functionName}`,"request.savedQuery")),e.userQuery&&a.push("userQuery="+r.guidParameterCheck(e.userQuery,`DynamicsWebApi.${e.functionName}`,"request.userQuery")),e.apply&&(r.stringParameterCheck(e.apply,`DynamicsWebApi.${e.functionName}`,"request.apply"),a.push("$apply="+e.apply)),e.count&&(r.boolParameterCheck(e.count,`DynamicsWebApi.${e.functionName}`,"request.count"),a.push("$count="+e.count)),e.top&&e.top>0&&(r.numberParameterCheck(e.top,`DynamicsWebApi.${e.functionName}`,"request.top"),a.push("$top="+e.top)),e.orderBy!=null&&e.orderBy.length&&(r.arrayParameterCheck(e.orderBy,`DynamicsWebApi.${e.functionName}`,"request.orderBy"),a.push("$orderby="+e.orderBy.join(","))),e.partitionId&&(r.stringParameterCheck(e.partitionId,`DynamicsWebApi.${e.functionName}`,"request.partitionId"),a.push("partitionid='"+e.partitionId+"'")),e.downloadSize&&(r.stringParameterCheck(e.downloadSize,`DynamicsWebApi.${e.functionName}`,"request.downloadSize"),a.push("size="+e.downloadSize)),e.queryParams?.length&&(r.arrayParameterCheck(e.queryParams,`DynamicsWebApi.${e.functionName}`,"request.queryParams"),a.push(e.queryParams.join("&"))),e.fileName&&(r.stringParameterCheck(e.fileName,`DynamicsWebApi.${e.functionName}`,"request.fileName"),a.push("x-ms-file-name="+e.fileName)),e.data&&r.parameterCheck(e.data,`DynamicsWebApi.${e.functionName}`,"request.data"),e.isBatch&&r.boolParameterCheck(e.isBatch,`DynamicsWebApi.${e.functionName}`,"request.isBatch"),f(e.inChangeSet)||r.boolParameterCheck(e.inChangeSet,`DynamicsWebApi.${e.functionName}`,"request.inChangeSet"),e.isBatch&&f(e.inChangeSet)&&(e.inChangeSet=!0),e.timeout&&r.numberParameterCheck(e.timeout,`DynamicsWebApi.${e.functionName}`,"request.timeout"),e.expand?.length)if(r.stringOrArrayParameterCheck(e.expand,`DynamicsWebApi.${e.functionName}`,"request.expand"),typeof e.expand=="string")a.push("$expand="+e.expand);else{let o=[];for(let{property:s,...c}of e.expand){if(!s)continue;let y={functionName:`${e.functionName} $expand`,...c},p=Le(y,t,"",";");p&&(p=`(${p.slice(1)})`),o.push(s+p)}o.length&&a.push("$expand="+o.join(","))}}return a.length?n+"?"+a.join(i):n},kt=(e,t)=>{let n={...t.headers,...e.userHeaders},i=Tt(e,t);if(i.length&&(n.Prefer=i),e.collection==="$metadata"&&(n.Accept="application/xml"),e.transferMode&&(n["x-ms-transfer-mode"]=e.transferMode),e.ifmatch!=null&&e.ifnonematch!=null)throw new Error(`DynamicsWebApi.${e.functionName}. Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.`);return e.ifmatch&&(r.stringParameterCheck(e.ifmatch,`DynamicsWebApi.${e.functionName}`,"request.ifmatch"),n["If-Match"]=e.ifmatch),e.ifnonematch&&(r.stringParameterCheck(e.ifnonematch,`DynamicsWebApi.${e.functionName}`,"request.ifnonematch"),n["If-None-Match"]=e.ifnonematch),e.impersonate&&(r.stringParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate"),n.MSCRMCallerID=r.guidParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate")),e.impersonateAAD&&(r.stringParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD"),n.CallerObjectId=r.guidParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD")),e.token&&(r.stringParameterCheck(e.token,`DynamicsWebApi.${e.functionName}`,"request.token"),n.Authorization="Bearer "+e.token),e.duplicateDetection&&(r.boolParameterCheck(e.duplicateDetection,`DynamicsWebApi.${e.functionName}`,"request.duplicateDetection"),n["MSCRM.SuppressDuplicateDetection"]="false"),e.bypassCustomPluginExecution&&(r.boolParameterCheck(e.bypassCustomPluginExecution,`DynamicsWebApi.${e.functionName}`,"request.bypassCustomPluginExecution"),n["MSCRM.BypassCustomPluginExecution"]="true"),e.noCache&&(r.boolParameterCheck(e.noCache,`DynamicsWebApi.${e.functionName}`,"request.noCache"),n["Cache-Control"]="no-cache"),e.mergeLabels&&(r.boolParameterCheck(e.mergeLabels,`DynamicsWebApi.${e.functionName}`,"request.mergeLabels"),n["MSCRM.MergeLabels"]="true"),e.contentId&&(r.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")||(n["Content-ID"]=e.contentId)),e.contentRange&&(r.stringParameterCheck(e.contentRange,`DynamicsWebApi.${e.functionName}`,"request.contentRange"),n["Content-Range"]=e.contentRange),e.range&&(r.stringParameterCheck(e.range,`DynamicsWebApi.${e.functionName}`,"request.range"),n.Range=e.range),n},Tt=(e,t)=>{let{returnRepresentation:n,includeAnnotations:i,maxPageSize:a,trackChanges:o,continueOnError:s}=e;e.prefer&&e.prefer.length&&(r.stringOrArrayParameterCheck(e.prefer,`DynamicsWebApi.${e.functionName}`,"request.prefer"),(typeof e.prefer=="string"?e.prefer.split(","):e.prefer).forEach(p=>{let d=p.trim();d==="return=representation"?n=!0:d.includes("odata.include-annotations=")?i=J(d.replace("odata.include-annotations=","")):d.startsWith("odata.maxpagesize=")?a=Number(J(d.replace("odata.maxpagesize=","")))||0:d.includes("odata.track-changes")?o=!0:d.includes("odata.continue-on-error")&&(s=!0)}));let c=[];return t&&(n==null&&(n=t.returnRepresentation),i=i??t.includeAnnotations,a=a??t.maxPageSize),n&&(r.boolParameterCheck(n,`DynamicsWebApi.${e.functionName}`,"request.returnRepresentation"),c.push("return=representation")),i&&(r.stringParameterCheck(i,`DynamicsWebApi.${e.functionName}`,"request.includeAnnotations"),c.push(`odata.include-annotations="${i}"`)),a&&a>0&&(r.numberParameterCheck(a,`DynamicsWebApi.${e.functionName}`,"request.maxPageSize"),c.push("odata.maxpagesize="+a)),o&&(r.boolParameterCheck(o,`DynamicsWebApi.${e.functionName}`,"request.trackChanges"),c.push("odata.track-changes")),s&&(r.boolParameterCheck(s,`DynamicsWebApi.${e.functionName}`,"request.continueOnError"),c.push("odata.continue-on-error")),c.join(",")},ne=(e,t,n)=>{let i=`dwa_batch_${D()}`,a=[],o=null,s=1e5,c=(p,d)=>{for(let R in p)R==="Authorization"||R==="Content-ID"||d.push(`${R}: ${p[R]}`)};e.forEach(p=>{p.functionName="executeBatch",n?.inChangeSet===!1&&(p.inChangeSet=!1);let d=p.method==="GET"?!1:!!p.inChangeSet;if(!d&&o&&(a.push(`
--${o}--`),o=null,s=1e5),o||(a.push(`
--${i}`),d&&(o=`changeset_${D()}`,a.push("Content-Type: multipart/mixed;boundary="+o))),d&&a.push(`
--${o}`),a.push("Content-Type: application/http"),a.push("Content-Transfer-Encoding: binary"),d){let R=p.headers.hasOwnProperty("Content-ID")?p.headers["Content-ID"]:++s;a.push(`Content-ID: ${R}`)}p.path?.startsWith("$")?a.push(`
${p.method} ${p.path} HTTP/1.1`):a.push(`
${p.method} ${t.dataApi.url}${p.path} HTTP/1.1`),p.method==="GET"?a.push("Accept: application/json"):a.push("Content-Type: application/json"),p.headers&&c(p.headers,a),p.data&&a.push(`
${ae(p.data,t)}`)}),o&&a.push(`
--${o}--`),a.push(`
--${i}--`);let y=ie(n?.userHeaders);return y["Content-Type"]=`multipart/mixed;boundary=${i}`,{headers:y,body:a.join(`
`)}},F=e=>{if(f(C))return null;let t=C[e];if(!t){for(let n in C)if(C[n]===e)return e}return t},ae=(e,t)=>{if(!e)return null;if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;let n=o=>{let s=ee.exec(o);if(s&&s.length>2){let c=F(s[1]);if(!f(c))return o.replace(ee,`${c}$2`)}return o},i=(o,s)=>(s.startsWith(t.dataApi.url)||(o.endsWith("@odata.bind")?s.startsWith("/")||(s=`/${s}`):s=`${t.dataApi.url}${Te(s)}`),s),a=JSON.stringify(e,(o,s)=>{if(o.endsWith("@odata.bind")||o.endsWith("@odata.id"))typeof s=="string"&&!s.startsWith("$")&&(s=Y(s),t.useEntityNames&&(s=n(s)),s=i(o,s));else if(o.startsWith("oData")||o.endsWith("_Formatted")||o.endsWith("_NavigationProperty")||o.endsWith("_LogicalName"))return;return s});return Ee(a)},ie=(e={})=>(e.Accept||(e.Accept="application/json"),e["OData-MaxVersion"]||(e["OData-MaxVersion"]="4.0"),e["OData-Version"]||(e["OData-Version"]="4.0"),e["Content-Range"]?e["Content-Type"]="application/octet-stream":e["Content-Type"]||(e["Content-Type"]="application/json; charset=utf-8"),e);A();async function Je(e){return(Ye(),Re(je)).executeRequest(e)}var Ze=(e,t)=>{X[e]?X[e].push(t):X[e]=[t]},Kt=(e,t)=>{W[e]?W[e].push(t):W[e]=[t]},me=e=>{delete X[e],W.hasOwnProperty(e)&&delete W[e]},et=async(e,t)=>{try{let n=await Yt(e,t);return me(e.requestId),n}catch(n){throw me(e.requestId),n}finally{me(e.requestId)}},W={},X={},Vt=["$metadata","EntityDefinitions","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions","query","suggest","autocomplete"],zt=e=>Vt.indexOf(e)>-1,Qt=async(e,t)=>{if(!f(C))return F(e)||e;let n=V({method:"GET",collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0,functionName:"retrieveMultiple"},t),i=await et(n,t);Xe({});for(let a=0;a<i.data.value.length;a++)C[i.data.value[a].LogicalName]=i.data.value[a].EntitySetName;return F(e)||e},jt=async(e,t)=>{if(!e||zt(e)||(e=e.toLowerCase(),!t.useEntityNames))return e;try{return await Qt(e,t)}catch(n){throw new Error("Unable to fetch Collection Names. Error: "+n.message)}},Yt=async(e,t)=>{e.headers=e.headers||{},e.responseParameters=e.responseParameters||{},e.requestId=e.requestId||D(),Ze(e.requestId,e.responseParameters);let n=null,i=e.responseParameters?.convertedToBatch;if(e.path==="$batch"&&!i){let s=W[e.requestId];if(!s)throw r.batchIsEmpty();let c=ne(s,t,e);n=c.body,e.headers={...c.headers,...e.headers},delete W[e.requestId]}else n=i?e.data:ae(e.data,t),i||(e.headers=ie(e.headers));t.impersonate&&!e.headers.MSCRMCallerID&&(e.headers.MSCRMCallerID=t.impersonate),t.impersonateAAD&&!e.headers.CallerObjectId&&(e.headers.CallerObjectId=t.impersonateAAD);let a=null;if(t.onTokenRefresh&&(!e.headers||e.headers&&!e.headers.Authorization)&&(a=await t.onTokenRefresh(),!a))throw new Error("Token is empty. Request is aborted.");a&&(e.headers.Authorization="Bearer "+(a.hasOwnProperty("accessToken")?a.accessToken:a)),K()&&(e.headers.__RequestVerificationToken=await window.shell.getTokenDeferred());let o=e.apiConfig?e.apiConfig.url:t.dataApi.url;return await Je({method:e.method,uri:o.toString()+e.path,data:n,proxy:t.proxy,isAsync:e.async,headers:e.headers,requestId:e.requestId,abortSignal:e.signal,responseParams:X,timeout:e.timeout||t.timeout})},tt=async(e,t)=>{if(e.responseParameters=e.responseParameters||{},e.userHeaders=e.headers,delete e.headers,!e.isBatch){let n=await jt(e.collection,t);if(e.collection=n,V(e,t),e.responseParameters.convertedToBatch=!1,e.path.length>2e3){let i=ne([e],t);e.headers.Authorization&&(i.headers.Authorization=e.headers.Authorization),e.method="POST",e.path="$batch",e.data=i.body,e.headers={...i.headers,...e.userHeaders},e.responseParameters.convertedToBatch=!0}return et(e,t)}V(e,t),Ze(e.requestId,e.responseParameters),Kt(e.requestId,e)};var nt=e=>F(e);b();A();T();var Jt="DynamicsWebApi.create",at=async(e,t)=>{r.parameterCheck(e,Jt,"request");let n;return e.functionName?n=e:(n=m(e),n.functionName="create"),n.method="POST",(await t.makeRequest(n))?.data};T();A();var Zt=(e,t)=>K()?new URL("_api",window.location.origin).toString()+"/":(e||(e=Fe()),new URL(`api/${t.path}/v${t.version}`,e).toString()+"/"),de=(e,t,n)=>{let i=n[t];e?.version&&(r.stringParameterCheck(e.version,"DynamicsWebApi.setConfig",`config.${t}.version`),i.version=e.version),e?.path&&(r.stringParameterCheck(e.path,"DynamicsWebApi.setConfig",`config.${t}.path`),i.path=e.path),i.url=Zt(n.serverUrl,i)},N=class{static merge(t,n){n?.serverUrl&&(r.stringParameterCheck(n.serverUrl,"DynamicsWebApi.setConfig","config.serverUrl"),t.serverUrl=n.serverUrl),de(n?.dataApi,"dataApi",t),de(n?.searchApi,"searchApi",t),n?.impersonate&&(t.impersonate=r.guidParameterCheck(n.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),n?.impersonateAAD&&(t.impersonateAAD=r.guidParameterCheck(n.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),n?.onTokenRefresh&&(r.callbackParameterCheck(n.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=n.onTokenRefresh),n?.includeAnnotations&&(r.stringParameterCheck(n.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=n.includeAnnotations),n?.timeout&&(r.numberParameterCheck(n.timeout,"DynamicsWebApi.setConfig","config.timeout"),t.timeout=n.timeout),n?.maxPageSize&&(r.numberParameterCheck(n.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=n.maxPageSize),n?.returnRepresentation&&(r.boolParameterCheck(n.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=n.returnRepresentation),n?.useEntityNames&&(r.boolParameterCheck(n.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),t.useEntityNames=n.useEntityNames),n?.headers&&(t.headers=n.headers)}static default(){return{serverUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null,proxy:null,dataApi:{path:"data",version:"9.2",url:""},searchApi:{path:"search",version:"1.0",url:""}}}};N.mergeApiConfigs=de;var I,$,S,Q=class{constructor(t){U(this,I,N.default());U(this,$,!1);U(this,S,null);this.setConfig=t=>N.merge(l(this,I),t);this.makeRequest=t=>(t.isBatch=l(this,$),l(this,S)&&(t.requestId=l(this,S)),tt(t,l(this,I)));N.merge(l(this,I),t)}get batchRequestId(){return l(this,S)}set batchRequestId(t){w(this,S,t)}get config(){return l(this,I)}get isBatch(){return l(this,$)}set isBatch(t){w(this,$,t)}};I=new WeakMap,$=new WeakMap,S=new WeakMap;var u,fe=class fe{constructor(t){U(this,u);this.setConfig=t=>l(this,u).setConfig(t);this.create=async t=>at(t,l(this,u));this.retrieve=async t=>{r.parameterCheck(t,"DynamicsWebApi.retrieve","request");let n;return t.functionName?n=t:(n=m(t),n.functionName="retrieve"),n.method="GET",n.responseParameters={isRef:n.select?.length===1&&n.select[0].endsWith("/$ref")},(await l(this,u).makeRequest(n))?.data};this.update=async t=>{r.parameterCheck(t,"DynamicsWebApi.update","request");let n;t.functionName?n=t:(n=m(t),n.functionName="update"),n.method??(n.method=Se(n.collection)),n.responseParameters={valueIfEmpty:!0},n.ifmatch??(n.ifmatch="*");let i=n.ifmatch;try{return(await l(this,u).makeRequest(n))?.data}catch(a){if(i&&a.status===412)return!1;throw a}};this.updateSingleProperty=async t=>{r.parameterCheck(t,"DynamicsWebApi.updateSingleProperty","request"),r.parameterCheck(t.fieldValuePair,"DynamicsWebApi.updateSingleProperty","request.fieldValuePair");var n=Object.keys(t.fieldValuePair)[0],i=t.fieldValuePair[n];let a=m(t);return a.navigationProperty=n,a.data={value:i},a.functionName="updateSingleProperty",a.method="PUT",delete a.fieldValuePair,(await l(this,u).makeRequest(a))?.data};this.deleteRecord=async t=>{r.parameterCheck(t,"DynamicsWebApi.deleteRecord","request");let n;t.functionName?n=t:(n=m(t),n.functionName="deleteRecord"),n.method="DELETE",n.responseParameters={valueIfEmpty:!0};let i=n.ifmatch;try{return(await l(this,u).makeRequest(n))?.data}catch(a){if(i&&a.status===412)return!1;throw a}};this.upsert=async t=>{r.parameterCheck(t,"DynamicsWebApi.upsert","request");let n=m(t);n.method="PATCH",n.functionName="upsert";let i=n.ifnonematch,a=n.ifmatch;try{return(await l(this,u).makeRequest(n))?.data}catch(o){if(i&&o.status===412)return null;if(a&&o.status===404)return null;throw o}};this._uploadFileChunk=async(t,n,i,a=0)=>{if(Ge(t,n,i,a),await l(this,u).makeRequest(t),a+=i,a<=n.length)return this._uploadFileChunk(t,n,i,a)};this.uploadFile=async t=>{r.throwBatchIncompatible("DynamicsWebApi.uploadFile",l(this,u).isBatch),r.parameterCheck(t,"DynamicsWebApi.uploadFile","request");let n=m(t,["data"]);n.method="PATCH",n.functionName="uploadFile",n.transferMode="chunked";let i=await l(this,u).makeRequest(n);return n.url=i?.data.location,delete n.transferMode,delete n.fieldName,delete n.property,delete n.fileName,this._uploadFileChunk(n,t.data,i?.data.chunkSize)};this._downloadFileChunk=async(t,n=0,i="")=>{t.range="bytes="+n+"-"+(n+te-1),t.downloadSize="full";let a=await l(this,u).makeRequest(t);return t.url=a?.data.location,i+=a?.data.value,n+=te,n<=a?.data.fileSize?this._downloadFileChunk(t,n,i):{fileName:a?.data.fileName,fileSize:a?.data.fileSize,data:qe(i)}};this.downloadFile=t=>{r.throwBatchIncompatible("DynamicsWebApi.downloadFile",l(this,u).isBatch),r.parameterCheck(t,"DynamicsWebApi.downloadFile","request");let n=m(t);return n.method="GET",n.functionName="downloadFile",n.responseParameters={parse:!0},this._downloadFileChunk(n)};this.retrieveMultiple=async(t,n)=>{r.parameterCheck(t,"DynamicsWebApi.retrieveMultiple","request");let i;return t.functionName?i=t:(i=m(t),i.functionName="retrieveMultiple"),i.method="GET",n&&(r.stringParameterCheck(n,"DynamicsWebApi.retrieveMultiple","nextPageLink"),i.url=n),(await l(this,u).makeRequest(i))?.data};this._retrieveAllRequest=async(t,n,i=[])=>{let a=await this.retrieveMultiple(t,n);i=i.concat(a.value);let o=a.oDataNextLink;if(o)return this._retrieveAllRequest(t,o,i);let s={value:i};return a.oDataDeltaLink&&(s["@odata.deltaLink"]=a.oDataDeltaLink,s.oDataDeltaLink=a.oDataDeltaLink),s};this.retrieveAll=t=>(r.throwBatchIncompatible("DynamicsWebApi.retrieveAll",l(this,u).isBatch),this._retrieveAllRequest(t));this.count=async t=>{r.parameterCheck(t,"DynamicsWebApi.count","request");let n=m(t);return n.method="GET",n.functionName="count",n.filter?.length?n.count=!0:n.navigationProperty="$count",n.responseParameters={toCount:n.count},(await l(this,u).makeRequest(n))?.data};this.countAll=async t=>{r.throwBatchIncompatible("DynamicsWebApi.countAll",l(this,u).isBatch),r.parameterCheck(t,"DynamicsWebApi.countAll","request");let n=await this._retrieveAllRequest(t);return n&&n.value?n.value.length:0};this.fetch=async t=>{r.parameterCheck(t,"DynamicsWebApi.fetch","request");let n=m(t);if(n.method="GET",n.functionName="fetch",r.stringParameterCheck(n.fetchXml,"DynamicsWebApi.fetch","request.fetchXml"),n.fetchXml&&!Ue.test(n.fetchXml)){let a="";$e.test(n.fetchXml)||(n.pageNumber=n.pageNumber||1,r.numberParameterCheck(n.pageNumber,"DynamicsWebApi.fetch","request.pageNumber"),a=`$1 page="${n.pageNumber}"`),n.pagingCookie!=null&&(r.stringParameterCheck(n.pagingCookie,"DynamicsWebApi.fetch","request.pagingCookie"),a+=` paging-cookie="${n.pagingCookie}"`),a&&(n.fetchXml=n.fetchXml.replace(we,a))}return n.responseParameters={pageNumber:n.pageNumber},(await l(this,u).makeRequest(n))?.data};this.fetchAll=async t=>{r.parameterCheck(t,"DynamicsWebApi.fetchAll","request");let n=async(i,a=[])=>{let o=await this.fetch(i);return a=a.concat(o.value),o.PagingInfo?(i.pageNumber=o.PagingInfo.nextPage,i.pagingCookie=o.PagingInfo.cookie,n(i,a)):{value:a}};return r.throwBatchIncompatible("DynamicsWebApi.fetchAll",l(this,u).isBatch),n(t)};this.associate=async t=>{r.parameterCheck(t,"DynamicsWebApi.associate","request");let n=m(t);n.method="POST",n.functionName="associate",r.stringParameterCheck(t.relatedCollection,"DynamicsWebApi.associate","request.relatedcollection"),r.stringParameterCheck(t.relationshipName,"DynamicsWebApi.associate","request.relationshipName");let i=r.keyParameterCheck(t.primaryKey,"DynamicsWebApi.associate","request.primaryKey"),a=r.keyParameterCheck(t.relatedKey,"DynamicsWebApi.associate","request.relatedKey");n.navigationProperty=t.relationshipName+"/$ref",n.key=i,n.data={"@odata.id":`${t.relatedCollection}(${a})`},await l(this,u).makeRequest(n)};this.disassociate=async t=>{r.parameterCheck(t,"DynamicsWebApi.disassociate","request");let n=m(t);n.method="DELETE",n.functionName="disassociate",r.stringParameterCheck(t.relationshipName,"DynamicsWebApi.disassociate","request.relationshipName");let i=r.keyParameterCheck(t.primaryKey,"DynamicsWebApi.disassociate","request.primaryKey"),a=r.keyParameterCheck(t.relatedKey,"DynamicsWebApi.disassociate","request.relatedId");n.key=i,n.navigationProperty=`${t.relationshipName}(${a})/$ref`,await l(this,u).makeRequest(n)};this.associateSingleValued=async t=>{r.parameterCheck(t,"DynamicsWebApi.associateSingleValued","request");let n=m(t);n.method="PUT",n.functionName="associateSingleValued";let i=r.keyParameterCheck(t.primaryKey,"DynamicsWebApi.associateSingleValued","request.primaryKey"),a=r.keyParameterCheck(t.relatedKey,"DynamicsWebApi.associateSingleValued","request.relatedKey");r.stringParameterCheck(t.navigationProperty,"DynamicsWebApi.associateSingleValued","request.navigationProperty"),r.stringParameterCheck(t.relatedCollection,"DynamicsWebApi.associateSingleValued","request.relatedcollection"),n.navigationProperty+="/$ref",n.key=i,n.data={"@odata.id":`${t.relatedCollection}(${a})`},await l(this,u).makeRequest(n)};this.disassociateSingleValued=async t=>{r.parameterCheck(t,"DynamicsWebApi.disassociateSingleValued","request");let n=m(t);n.method="DELETE",n.functionName="disassociateSingleValued";let i=r.keyParameterCheck(t.primaryKey,"DynamicsWebApi.disassociateSingleValued","request.primaryKey");r.stringParameterCheck(t.navigationProperty,"DynamicsWebApi.disassociateSingleValued","request.navigationProperty"),n.navigationProperty+="/$ref",n.key=i,await l(this,u).makeRequest(n)};this.callFunction=async t=>{r.parameterCheck(t,"DynamicsWebApi.callFunction","request");let n=p=>p.name||p.functionName,i=typeof t!="string",a=i?n(t):t,o=i?"request.name":"name",s=i?k(t,["name"]):{functionName:a};r.stringParameterCheck(a,"DynamicsWebApi.callFunction",o);let c=Be(s.parameters);return s.method="GET",s.addPath=a+c.key,s.queryParams=c.queryParams,s._isUnboundRequest=!s.collection,s.functionName="callFunction",(await l(this,u).makeRequest(s))?.data};this.callAction=async t=>{r.parameterCheck(t,"DynamicsWebApi.callAction","request"),r.stringParameterCheck(t.actionName,"DynamicsWebApi.callAction","request.actionName");let n=m(t,["action"]);return n.method="POST",n.functionName="callAction",n.addPath=t.actionName,n._isUnboundRequest=!n.collection,n.data=t.action,(await l(this,u).makeRequest(n))?.data};this.createEntity=t=>{r.parameterCheck(t,"DynamicsWebApi.createEntity","request"),r.parameterCheck(t.data,"DynamicsWebApi.createEntity","request.data");let n=m(t);return n.collection="EntityDefinitions",n.functionName="createEntity",this.create(n)};this.updateEntity=t=>{r.parameterCheck(t,"DynamicsWebApi.updateEntity","request"),r.parameterCheck(t.data,"DynamicsWebApi.updateEntity","request.data"),r.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateEntity","request.data.MetadataId");let n=m(t);return n.collection="EntityDefinitions",n.key=n.data.MetadataId,n.functionName="updateEntity",n.method="PUT",this.update(n)};this.retrieveEntity=t=>{r.parameterCheck(t,"DynamicsWebApi.retrieveEntity","request"),r.keyParameterCheck(t.key,"DynamicsWebApi.retrieveEntity","request.key");let n=m(t);return n.collection="EntityDefinitions",n.functionName="retrieveEntity",this.retrieve(n)};this.retrieveEntities=t=>{let n=t?m(t):{};return n.collection="EntityDefinitions",n.functionName="retrieveEntities",this.retrieveMultiple(n)};this.createAttribute=t=>{r.parameterCheck(t,"DynamicsWebApi.createAttribute","request"),r.parameterCheck(t.data,"DynamicsWebApi.createAttribute","request.data"),r.keyParameterCheck(t.entityKey,"DynamicsWebApi.createAttribute","request.entityKey");let n=m(t);return n.collection="EntityDefinitions",n.functionName="retrieveEntity",n.navigationProperty="Attributes",n.key=t.entityKey,this.create(n)};this.updateAttribute=t=>{r.parameterCheck(t,"DynamicsWebApi.updateAttribute","request"),r.parameterCheck(t.data,"DynamicsWebApi.updateAttribute","request.data"),r.keyParameterCheck(t.entityKey,"DynamicsWebApi.updateAttribute","request.entityKey"),r.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateAttribute","request.data.MetadataId"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.updateAttribute","request.castType");let n=m(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.navigationPropertyKey=t.data.MetadataId,n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="updateAttribute",n.method="PUT",this.update(n)};this.retrieveAttributes=t=>{r.parameterCheck(t,"DynamicsWebApi.retrieveAttributes","request"),r.keyParameterCheck(t.entityKey,"DynamicsWebApi.retrieveAttributes","request.entityKey"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveAttributes","request.castType");let n=m(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="retrieveAttributes",this.retrieveMultiple(n)};this.retrieveAttribute=t=>{r.parameterCheck(t,"DynamicsWebApi.retrieveAttributes","request"),r.keyParameterCheck(t.entityKey,"DynamicsWebApi.retrieveAttribute","request.entityKey"),r.keyParameterCheck(t.attributeKey,"DynamicsWebApi.retrieveAttribute","request.attributeKey"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveAttribute","request.castType");let n=m(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.navigationPropertyKey=t.attributeKey,n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="retrieveAttribute",this.retrieve(n)};this.createRelationship=t=>{r.parameterCheck(t,"DynamicsWebApi.createRelationship","request"),r.parameterCheck(t.data,"DynamicsWebApi.createRelationship","request.data");let n=m(t);return n.collection="RelationshipDefinitions",n.functionName="createRelationship",this.create(n)};this.updateRelationship=t=>{r.parameterCheck(t,"DynamicsWebApi.updateRelationship","request"),r.parameterCheck(t.data,"DynamicsWebApi.updateRelationship","request.data"),r.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateRelationship","request.data.MetadataId"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.updateRelationship","request.castType");let n=m(t);return n.collection="RelationshipDefinitions",n.key=t.data.MetadataId,n.navigationProperty=t.castType,n.functionName="updateRelationship",n.method="PUT",this.update(n)};this.deleteRelationship=t=>{r.parameterCheck(t,"DynamicsWebApi.deleteRelationship","request"),r.keyParameterCheck(t.key,"DynamicsWebApi.deleteRelationship","request.key");let n=m(t);return n.collection="RelationshipDefinitions",n.functionName="deleteRelationship",this.deleteRecord(n)};this.retrieveRelationships=t=>{let n=t?m(t):{};return n.collection="RelationshipDefinitions",n.functionName="retrieveRelationships",t&&t.castType&&(r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveRelationships","request.castType"),n.navigationProperty=t.castType),this.retrieveMultiple(n)};this.retrieveRelationship=t=>{r.parameterCheck(t,"DynamicsWebApi.retrieveRelationship","request"),r.keyParameterCheck(t.key,"DynamicsWebApi.retrieveRelationship","request.key"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveRelationship","request.castType");let n=m(t);return n.collection="RelationshipDefinitions",n.navigationProperty=t.castType,n.functionName="retrieveRelationship",this.retrieve(n)};this.createGlobalOptionSet=t=>{r.parameterCheck(t,"DynamicsWebApi.createGlobalOptionSet","request"),r.parameterCheck(t.data,"DynamicsWebApi.createGlobalOptionSet","request.data");let n=m(t);return n.collection="GlobalOptionSetDefinitions",n.functionName="createGlobalOptionSet",this.create(n)};this.updateGlobalOptionSet=t=>{r.parameterCheck(t,"DynamicsWebApi.updateGlobalOptionSet","request"),r.parameterCheck(t.data,"DynamicsWebApi.updateGlobalOptionSet","request.data"),r.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","request.data.MetadataId"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.updateGlobalOptionSet","request.castType");let n=m(t);return n.collection="GlobalOptionSetDefinitions",n.key=t.data.MetadataId,n.functionName="updateGlobalOptionSet",n.method="PUT",this.update(n)};this.deleteGlobalOptionSet=t=>{r.parameterCheck(t,"DynamicsWebApi.deleteGlobalOptionSet","request");let n=m(t);return n.collection="GlobalOptionSetDefinitions",n.functionName="deleteGlobalOptionSet",this.deleteRecord(n)};this.retrieveGlobalOptionSet=t=>{r.parameterCheck(t,"DynamicsWebApi.retrieveGlobalOptionSet","request"),t.castType&&r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveGlobalOptionSet","request.castType");let n=m(t);return n.collection="GlobalOptionSetDefinitions",n.navigationProperty=t.castType,n.functionName="retrieveGlobalOptionSet",this.retrieve(n)};this.retrieveGlobalOptionSets=t=>{let n=t?m(t):{};return n.collection="GlobalOptionSetDefinitions",n.functionName="retrieveGlobalOptionSets",t?.castType&&(r.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveGlobalOptionSets","request.castType"),n.navigationProperty=t.castType),this.retrieveMultiple(n)};this.retrieveCsdlMetadata=async t=>{let n=t?m(t):{};return n.collection="$metadata",n.functionName="retrieveCsdlMetadata",t?.addAnnotations&&(r.boolParameterCheck(t.addAnnotations,"DynamicsWebApi.retrieveCsdlMetadata","request.addAnnotations"),n.includeAnnotations="*"),(await l(this,u).makeRequest(n))?.data};this.search=async t=>{r.parameterCheck(t,"DynamicsWebApi.search","request");let n=M(t),i=n?"request.query.search":"term",a=n?k(t):{query:{search:t}};return r.parameterCheck(a.query,"DynamicsWebApi.search","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.search",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.search",i,100),a.collection="query",a.functionName="search",a.method="POST",a.data=a.query,a.apiConfig=l(this,u).config.searchApi,delete a.query,(await l(this,u).makeRequest(a))?.data};this.suggest=async t=>{r.parameterCheck(t,"DynamicsWebApi.suggest","request");let n=M(t),i=n?"request.query.search":"term",a=n?k(t):{query:{search:t}};return r.parameterCheck(a.query,"DynamicsWebApi.suggest","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.suggest",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.suggest",i,100),a.functionName=a.collection="suggest",a.method="POST",a.data=a.query,a.apiConfig=l(this,u).config.searchApi,delete a.query,(await l(this,u).makeRequest(a))?.data};this.autocomplete=async t=>{r.parameterCheck(t,"DynamicsWebApi.autocomplete","request");let n=M(t),i=n?"request.query.search":"term",a=n?k(t):{query:{search:t}};return n&&r.parameterCheck(a.query,"DynamicsWebApi.autocomplete","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",i,100),a.functionName=a.collection="autocomplete",a.method="POST",a.data=a.query,a.apiConfig=l(this,u).config.searchApi,delete a.query,(await l(this,u).makeRequest(a))?.data};this.startBatch=()=>{l(this,u).isBatch=!0,l(this,u).batchRequestId=D()};this.executeBatch=async t=>{r.throwBatchNotStarted(l(this,u).isBatch);let n=t?m(t):{};return n.collection="$batch",n.method="POST",n.functionName="executeBatch",n.requestId=l(this,u).batchRequestId,l(this,u).batchRequestId=null,l(this,u).isBatch=!1,(await l(this,u).makeRequest(n))?.data};this.initializeInstance=t=>new fe(t||l(this,u).config);this.Utility={getCollectionName:t=>nt(t)};w(this,u,new Q(t))}};u=new WeakMap;var ye=fe;return Re(en);})();
var DynamicsWebApi = _dynamicsWebApiExports.DynamicsWebApi
//# sourceMappingURL=dynamics-web-api.min.js.map
