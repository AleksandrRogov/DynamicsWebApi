/*! dynamics-web-api v1.3.1 (c) 2017 Aleksandr Rogov */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("DynamicsWebApi",[],t):"object"==typeof exports?exports.DynamicsWebApi=t():e.DynamicsWebApi=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var a=n[r]={i:r,l:!1,exports:{}};return e[r].call(a.exports,a,a.exports,t),a.l=!0,a.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=6)}([function(e,t){var n={Types:{ResponseBase:function(){this.oDataContext=""},Response:function(){n.Types.ResponseBase.call(this),this.value={}},ReferenceResponse:function(){n.Types.ResponseBase.call(this),this.id="",this.collection=""},MultipleResponse:function(){n.Types.ResponseBase.call(this),this.oDataNextLink="",this.oDataCount=0,this.value=[]},FetchXmlResponse:function(){n.Types.ResponseBase.call(this),this.value=[],this.PagingInfo={cookie:"",page:0,nextPage:1}}},Prefer:{ReturnRepresentation:"return=representation",Annotations:{AssociatedNavigationProperty:"Microsoft.Dynamics.CRM.associatednavigationproperty",LookupLogicalName:"Microsoft.Dynamics.CRM.lookuplogicalname",All:"*",FormattedValue:"OData.Community.Display.V1.FormattedValue",FetchXmlPagingCookie:"Microsoft.Dynamics.CRM.fetchxmlpagingcookie"}}};e.exports=n},function(e,t){function n(e,t,n){throw new Error(n?e+" requires the "+t+" parameter to be of type "+n:e+" requires the "+t+" parameter.")}var r={handleErrorResponse:function(e){throw new Error("Error: "+e.status+": "+e.message)},parameterCheck:function(e,t,r,a){void 0!==e&&null!==e&&""!=e||n(t,r,a)},stringParameterCheck:function(e,t,r){"string"!=typeof e&&n(t,r,"String")},arrayParameterCheck:function(e,t,r){e.constructor!==Array&&n(t,r,"Array")},stringOrArrayParameterCheck:function(e,t,r){e.constructor!==Array&&"string"!=typeof e&&n(t,r,"String or Array")},numberParameterCheck:function(e,t,r){if("number"!=typeof e){if("string"==typeof e&&e&&!isNaN(parseInt(e)))return;n(t,r,"Number")}},boolParameterCheck:function(e,t,r){"boolean"!=typeof e&&n(t,r,"Boolean")},guidParameterCheck:function(e,t,r){try{return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e)[0]}catch(e){n(t,r,"GUID String")}},callbackParameterCheck:function(e,t,r){"function"!=typeof e&&n(t,r,"Function")}};e.exports=r},function(e,t){String.prototype.endsWith=function(e,t){var n=this.toString();("number"!=typeof t||!isFinite(t)||Math.floor(t)!==t||t>n.length)&&(t=n.length),t-=e.length;var r=n.lastIndexOf(e,t);return-1!==r&&r===t},String.prototype.startsWith=function(e,t){return t=t||0,this.substr(t,e.length)===e}},function(e,t,n){function r(){var e=(new Date).getTime();return"undefined"!=typeof performance&&"function"==typeof performance.now&&(e+=performance.now()),"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var n=(e+16*Math.random())%16|0;return e=Math.floor(e/16),("x"===t?n:3&n|8).toString(16)})}function a(e){return e.Accept="application/json",e["OData-MaxVersion"]="4.0",e["OData-Version"]="4.0",e["Content-Type"]="application/json; charset=utf-8",e}function i(e,t){var n;return e&&(n=JSON.stringify(e,function(e,n){return e.endsWith("@odata.bind")&&"string"==typeof n&&(/\(\{[\w\d-]+\}\)/g.test(n)&&(n=n.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),n.startsWith(t.webApiUrl)||(n=t.webApiUrl+n)),n}),n=n.replace(/[\u007F-\uFFFF]/g,function(e){return"\\u"+("0000"+e.charCodeAt(0).toString(16)).substr(-4)})),n}n(0);e.exports=function(e,t,o,c,s,u,l,p){s||(s={}),s=a(s);var h=i(c,o);if(t.length>2e3){var m="dwa_batch_"+r(),d=[];d.push("--"+m),d.push("Content-Type: application/http"),d.push("Content-Transfer-Encoding: binary\n"),d.push(e+" "+o.webApiUrl+t+" HTTP/1.1");for(var f in s)d.push(f+": "+s[f]),delete s[f];d.push("\n--"+m+"--"),h=d.join("\n"),s=a(s),s["Content-Type"]="multipart/mixed;boundary="+m,t="$batch",e="POST"}o.impersonate&&!s.MSCRMCallerID&&(s.MSCRMCallerID=o.impersonate);var y;"undefined"!=typeof XMLHttpRequest&&(y=n(10));var g=function(n){n&&(s||(s={}),s.Authorization="Bearer "+n.accessToken),y(e,o.webApiUrl+t,h,s,u,l,p)};o.onTokenRefresh&&(!s||s&&!s.Authorization)?o.onTokenRefresh(g):g()}},function(e,t,n){function r(e,t,n,a,i){var s={},u=[];if(a=null!=a?a:"&",e){e.navigationProperty&&(o.stringParameterCheck(e.navigationProperty,"DynamicsWebApi."+t,"request.navigationProperty"),n+="/"+e.navigationProperty),null!=e.select&&e.select.length&&(o.arrayParameterCheck(e.select,"DynamicsWebApi."+t,"request.select"),"retrieve"==t&&1==e.select.length&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&"retrieve"==t&&(null==e.navigationProperty?n+=e.select.shift():e.select.shift()),e.select.length&&u.push("$select="+e.select.join(",")))),e.filter&&(o.stringParameterCheck(e.filter,"DynamicsWebApi."+t,"request.filter"),u.push("$filter="+e.filter)),e.savedQuery&&u.push("savedQuery="+o.guidParameterCheck(e.savedQuery,"DynamicsWebApi."+t,"request.savedQuery")),e.userQuery&&u.push("userQuery="+o.guidParameterCheck(e.userQuery,"DynamicsWebApi."+t,"request.userQuery")),e.count&&(o.boolParameterCheck(e.count,"DynamicsWebApi."+t,"request.count"),u.push("$count="+e.count)),e.top&&e.top>0&&(o.numberParameterCheck(e.top,"DynamicsWebApi."+t,"request.top"),u.push("$top="+e.top)),null!=e.orderBy&&e.orderBy.length&&(o.arrayParameterCheck(e.orderBy,"DynamicsWebApi."+t,"request.orderBy"),u.push("$orderby="+e.orderBy.join(",")));var l=c(e,t,i);if(l.length&&(s.Prefer=l),null!=e.ifmatch&&null!=e.ifnonematch)throw new Error("DynamicsWebApi."+t+". Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.");if(e.ifmatch&&(o.stringParameterCheck(e.ifmatch,"DynamicsWebApi."+t,"request.ifmatch"),s["If-Match"]=e.ifmatch),e.ifnonematch&&(o.stringParameterCheck(e.ifnonematch,"DynamicsWebApi."+t,"request.ifnonematch"),s["If-None-Match"]=e.ifnonematch),e.impersonate&&(o.stringParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate"),s.MSCRMCallerID=o.guidParameterCheck(e.impersonate,"DynamicsWebApi."+t,"request.impersonate")),e.token&&(o.stringParameterCheck(e.token,"DynamicsWebApi."+t,"request.token"),s.Authorization="Bearer "+e.token),e.expand&&e.expand.length)if(o.stringOrArrayParameterCheck(e.expand,"DynamicsWebApi."+t,"request.expand"),"string"==typeof e.expand)u.push("$expand="+encodeURI(e.expand));else{for(var p=[],h=0;h<e.expand.length;h++)if(e.expand[h].property){var m=r(e.expand[h],t+" $expand",null,";"),d=m.query;d&&d.length&&(d="("+d+")"),p.push(e.expand[h].property+d)}p.length&&u.push("$expand="+encodeURI(p.join(",")))}}return{url:n,query:u.join(a),headers:s}}function a(e){return["EntityDefinitions"].indexOf(e)>-1?e:e.toLowerCase()}function i(e,t,n){e.collection?o.stringParameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection"):o.parameterCheck(e.collection,"DynamicsWebApi."+t,"request.collection");var i=a(e.collection);e.id&&(e.id=o.guidParameterCheck(e.id,"DynamicsWebApi."+t,"request.id"),i+="("+e.id+")");var c=r(e,t,i,"&",n);return c.query&&(c.url+="?"+encodeURI(c.query)),e.hasOwnProperty("async")&&null!=e.async?(o.boolParameterCheck(e.async,"DynamicsWebApi."+t,"request.async"),c.async=e.async):c.async=!0,{url:c.url,headers:c.headers,async:c.async}}var o=(n(0),n(1)),c=n(12),s={convertRequestOptions:r,convertRequest:i};e.exports=s},function(e,t,n){var r={buildFunctionParameters:n(11),getFetchXmlPagingCookie:n(14),convertToReferenceObject:n(13)};e.exports=r},function(e,t,n){function r(e){var t={webApiVersion:"8.0",webApiUrl:null,impersonate:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null};e||(e=t);var n=function(){if("undefined"!=typeof GetGlobalContext)return GetGlobalContext();if("undefined"!=typeof Xrm)return Xrm.Page.context;throw new Error("Xrm Context is not available.")},u=function(){var e=n();if(e){var t=e.getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}return""},l=function(){return u()+"/api/data/v"+t.webApiVersion+"/"};this.setConfig=function(e){e.webApiVersion&&(c.stringParameterCheck(e.webApiVersion,"DynamicsWebApi.setConfig","config.webApiVersion"),t.webApiVersion=e.webApiVersion),e.webApiUrl?(c.stringParameterCheck(e.webApiUrl,"DynamicsWebApi.setConfig","config.webApiUrl"),t.webApiUrl=e.webApiUrl):t.webApiUrl=l(),e.impersonate&&(t.impersonate=c.guidParameterCheck(e.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),e.onTokenRefresh&&(c.callbackParameterCheck(e.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=e.onTokenRefresh),e.includeAnnotations&&(c.stringParameterCheck(e.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=e.includeAnnotations),e.maxPageSize&&(c.numberParameterCheck(e.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=e.maxPageSize),e.returnRepresentation&&(c.boolParameterCheck(e.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=e.returnRepresentation)},this.setConfig(e);var p=function(e,n,r,a,i){return new Promise(function(o,c){s(e,n,t,r,a,o,c,i)})};this.create=function(e,n,r,a){c.parameterCheck(e,"DynamicsWebApi.create","object"),c.stringParameterCheck(n,"DynamicsWebApi.create","collection"),r&&c.stringOrArrayParameterCheck(r,"DynamicsWebApi.create","prefer"),a&&c.arrayParameterCheck(a,"DynamicsWebApi.create","select");var i={collection:n,select:a,prefer:r},s=o.convertRequest(i,"create",t);return p("POST",s.url,e,s.headers,s.async).then(function(e){return e.data?e.data:/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"])[0]})},this.retrieveRequest=function(e){c.parameterCheck(e,"DynamicsWebApi.retrieve","request");var n=o.convertRequest(e,"retrieve",t),r=e.select;return p("GET",n.url,null,n.headers,n.async).then(function(e){return null!=r&&1==r.length&&r[0].endsWith("/$ref")&&null!=e.data["@odata.id"]?i.convertToReferenceObject(e.data):e.data})},this.retrieve=function(e,t,n,r){c.stringParameterCheck(e,"DynamicsWebApi.retrieve","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.retrieve","id"),c.stringParameterCheck(t,"DynamicsWebApi.retrieve","collection"),n&&n.length&&c.arrayParameterCheck(n,"DynamicsWebApi.retrieve","select"),r&&r.length&&c.stringOrArrayParameterCheck(r,"DynamicsWebApi.retrieve","expand");var a={collection:t,id:e,select:n,expand:r};return this.retrieveRequest(a)},this.updateRequest=function(e){c.parameterCheck(e,"DynamicsWebApi.update","request"),c.parameterCheck(e.entity,"DynamicsWebApi.update","request.entity"),null==e.ifmatch&&(e.ifmatch="*");var n=o.convertRequest(e,"update",t),r=e.ifmatch;return p("PATCH",n.url,e.entity,n.headers,n.async).then(function(e){return!e.data||e.data}).catch(function(e){if(r&&412==e.status)return!1;throw e})},this.update=function(e,t,n,r,a){c.stringParameterCheck(e,"DynamicsWebApi.update","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.update","id"),c.parameterCheck(n,"DynamicsWebApi.update","object"),c.stringParameterCheck(t,"DynamicsWebApi.update","collection"),r&&c.stringOrArrayParameterCheck(r,"DynamicsWebApi.update","prefer"),a&&c.arrayParameterCheck(a,"DynamicsWebApi.update","select");var i={collection:t,id:e,select:a,prefer:r,entity:n};return this.updateRequest(i)},this.updateSingleProperty=function(e,n,r,a,i){c.stringParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.updateSingleProperty","id"),c.parameterCheck(r,"DynamicsWebApi.updateSingleProperty","keyValuePair"),c.stringParameterCheck(n,"DynamicsWebApi.updateSingleProperty","collection");var s=Object.keys(r)[0],u=r[s];a&&c.stringOrArrayParameterCheck(a,"DynamicsWebApi.updateSingleProperty","prefer"),i&&c.arrayParameterCheck(i,"DynamicsWebApi.updateSingleProperty","select");var l={collection:n,id:e,select:i,prefer:a,navigationProperty:s},h=o.convertRequest(l,"updateSingleProperty",t);return p("PUT",h.url,{value:u},h.headers,h.async).then(function(e){if(e.data)return e.data})},this.deleteRequest=function(e){c.parameterCheck(e,"DynamicsWebApi.delete","request");var n=o.convertRequest(e,"deleteRequest",t),r=e.ifmatch;return p("DELETE",n.url,null,n.headers,n.async).then(function(){return!0}).catch(function(e){if(r&&412==e.status)return!1;throw e})},this.deleteRecord=function(e,t,n){c.stringParameterCheck(e,"DynamicsWebApi.deleteRecord","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.deleteRecord","id"),c.stringParameterCheck(t,"DynamicsWebApi.deleteRecord","collection"),null!=n&&c.stringParameterCheck(n,"DynamicsWebApi.deleteRecord","propertyName");var r=t.toLowerCase()+"("+e+")";return null!=n&&(r+="/"+n),p("DELETE",r,null,null,!0).then(function(){})},this.upsertRequest=function(e){c.parameterCheck(e,"DynamicsWebApi.upsert","request"),c.parameterCheck(e.entity,"DynamicsWebApi.upsert","request.entity");var n=o.convertRequest(e,"upsert",t),r=e.ifnonematch,a=e.ifmatch;return p("PATCH",n.url,e.entity,n.headers,n.async).then(function(e){if(e.headers["OData-EntityId"]||e.headers["odata-entityid"]){return/[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}/i.exec(e.headers["OData-EntityId"]?e.headers["OData-EntityId"]:e.headers["odata-entityid"])[0]}if(e.data)return e.data}).catch(function(e){if(!(r&&412==e.status||a&&404==e.status))throw e})},this.upsert=function(e,t,n,r,a){c.stringParameterCheck(e,"DynamicsWebApi.upsert","id"),e=c.guidParameterCheck(e,"DynamicsWebApi.upsert","id"),c.parameterCheck(n,"DynamicsWebApi.upsert","object"),c.stringParameterCheck(t,"DynamicsWebApi.upsert","collection"),r&&c.stringOrArrayParameterCheck(r,"DynamicsWebApi.upsert","prefer"),a&&c.arrayParameterCheck(a,"DynamicsWebApi.upsert","select");var i={collection:t,id:e,select:a,prefer:r,entity:n};return this.upsertRequest(i)};var h=function(e,n){n&&!e.collection&&(e.collection="any");var r=o.convertRequest(e,"retrieveMultiple",t);n&&(c.stringParameterCheck(n,"DynamicsWebApi.retrieveMultiple","nextPageLink"),r.url=n.replace(t.webApiUrl,""));var a=e.count;return p("GET",r.url,null,r.headers,r.async).then(function(e){return a&&(e.data.oDataCount=e.data.oDataCount||0),e.data})};this.retrieveMultipleRequest=h;var m=function(e,t,n){var n=n||[];return h(e,t).then(function(t){return n=n.concat(t.value),t.oDataNextLink?m(e,t.oDataNextLink,n):{value:n}})};this.retrieveAllRequest=function(e){return m(e)},this.count=function(e,t){return null==t||null!=t&&!t.length?(c.stringParameterCheck(e,"DynamicsWebApi.count","collection"),p("GET",e.toLowerCase()+"/$count").then(function(e){return e.data?parseInt(e.data):0})):this.retrieveMultipleRequest({collection:e,filter:t,count:!0},null).then(function(e){return e.oDataCount?e.oDataCount:0})},this.countAll=function(e,t,n){return m({collection:e,filter:t,select:n}).then(function(e){return e&&e.value?e.value.length:0})},this.retrieveMultiple=function(e,t,n,r){return this.retrieveMultipleRequest({collection:e,select:t,filter:n},r)},this.retrieveAll=function(e,t,n){return m({collection:e,select:t,filter:n})};var d=function(e,n,r,s,u,l){c.stringParameterCheck(e,"DynamicsWebApi.executeFetchXml","type"),c.stringParameterCheck(n,"DynamicsWebApi.executeFetchXml","fetchXml"),s=s||1,c.numberParameterCheck(s,"DynamicsWebApi.executeFetchXml","pageNumber");var h='$1 page="'+s+'"';null!=u&&(c.stringParameterCheck(u,"DynamicsWebApi.executeFetchXml","pagingCookie"),h+=' paging-cookie="'+u+'"'),n=n.replace(/^(<fetch[\w\d\s'"=]+)/,h),r&&c.stringParameterCheck(r,"DynamicsWebApi.executeFetchXml","includeAnnotations"),l&&(l=c.guidParameterCheck(l,"DynamicsWebApi.executeFetchXml","impersonateUserId"));var m={collection:e,includeAnnotations:r,impersonate:l},d=o.convertRequest(m,"executeFetchXml",t),f=encodeURIComponent(n);return p("GET",d.url+"?fetchXml="+f,null,d.headers,d.async).then(function(e){return null!=e.data["@"+a.Prefer.Annotations.FetchXmlPagingCookie]&&(e.data.PagingInfo=i.getFetchXmlPagingCookie(e.data["@"+a.Prefer.Annotations.FetchXmlPagingCookie],s)),e.data})};this.fetch=this.executeFetchXml=d;var f=function(e,t,n,r,a,i,o){var o=o||[];return d(e,t,n,r,a,i).then(function(r){return o=o.concat(r.value),r.PagingInfo?f(e,t,n,r.PagingInfo.nextPage,r.PagingInfo.cookie,i,o):{value:o}})};this.fetchAll=this.executeFetchXmlAll=function(e,t,n,r){return f(e,t,n,null,null,r)},this.associate=function(e,n,r,a,i,o){c.stringParameterCheck(e,"DynamicsWebApi.associate","primarycollection"),c.stringParameterCheck(a,"DynamicsWebApi.associate","relatedcollection"),c.stringParameterCheck(r,"DynamicsWebApi.associate","relationshipName"),n=c.guidParameterCheck(n,"DynamicsWebApi.associate","primaryId"),i=c.guidParameterCheck(i,"DynamicsWebApi.associate","relatedId");var s={};return null!=o&&(o=c.guidParameterCheck(o,"DynamicsWebApi.associate","impersonateUserId"),s.MSCRMCallerID=o),p("POST",e+"("+n+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+a+"("+i+")"},s).then(function(){})},this.disassociate=function(e,t,n,r,a){c.stringParameterCheck(e,"DynamicsWebApi.disassociate","primarycollection"),c.stringParameterCheck(n,"DynamicsWebApi.disassociate","relationshipName"),t=c.guidParameterCheck(t,"DynamicsWebApi.disassociate","primaryId"),r=c.guidParameterCheck(r,"DynamicsWebApi.disassociate","relatedId");var i={};return null!=a&&(a=c.guidParameterCheck(a,"DynamicsWebApi.associate","impersonateUserId"),i.MSCRMCallerID=a),p("DELETE",e+"("+t+")/"+n+"("+r+")/$ref",null,i).then(function(){})},this.associateSingleValued=function(e,n,r,a,i,o){c.stringParameterCheck(e,"DynamicsWebApi.associateSingleValued","collection"),n=c.guidParameterCheck(n,"DynamicsWebApi.associateSingleValued","id"),i=c.guidParameterCheck(i,"DynamicsWebApi.associateSingleValued","relatedId"),c.stringParameterCheck(r,"DynamicsWebApi.associateSingleValued","singleValuedNavigationPropertyName"),c.stringParameterCheck(a,"DynamicsWebApi.associateSingleValued","relatedcollection");var s={};return null!=o&&(o=c.guidParameterCheck(o,"DynamicsWebApi.associate","impersonateUserId"),s.MSCRMCallerID=o),p("PUT",e+"("+n+")/"+r+"/$ref",{"@odata.id":t.webApiUrl+a+"("+i+")"},s).then(function(){})},this.disassociateSingleValued=function(e,t,n,r){c.stringParameterCheck(e,"DynamicsWebApi.disassociateSingleValued","collection"),t=c.guidParameterCheck(t,"DynamicsWebApi.disassociateSingleValued","id"),c.stringParameterCheck(n,"DynamicsWebApi.disassociateSingleValued","singleValuedNavigationPropertyName");var a={};return null!=r&&(r=c.guidParameterCheck(r,"DynamicsWebApi.associate","impersonateUserId"),a.MSCRMCallerID=r),p("DELETE",e+"("+t+")/"+n+"/$ref",null,a).then(function(){})},this.executeUnboundFunction=function(e,t,n){return y(e,t,null,null,n)},this.executeBoundFunction=function(e,t,n,r,a){return y(n,r,t,e,a)};var y=function(e,t,n,r,a){c.stringParameterCheck(e,"DynamicsWebApi.executeFunction","functionName");var o=e+i.buildFunctionParameters(t);null!=n&&(c.stringParameterCheck(n,"DynamicsWebApi.executeFunction","collection"),r=c.guidParameterCheck(r,"DynamicsWebApi.executeFunction","id"),o=n+"("+r+")/"+o);var s={};return a&&(s.MSCRMCallerID=c.guidParameterCheck(a,"DynamicsWebApi.executeFunction","impersonateUserId")),p("GET",o,null,s).then(function(e){if(e.data)return e.data})};this.executeUnboundAction=function(e,t,n){return g(e,t,null,null,n)},this.executeBoundAction=function(e,t,n,r,a){return g(n,r,t,e,a)};var g=function(e,t,n,r,a){c.stringParameterCheck(e,"DynamicsWebApi.executeAction","actionName");var i=e;null!=n&&(c.stringParameterCheck(n,"DynamicsWebApi.executeAction","collection"),r=c.guidParameterCheck(r,"DynamicsWebApi.executeAction","id"),i=n+"("+r+")/"+i);var o={};return null!=a&&(a=c.guidParameterCheck(a,"DynamicsWebApi.executeAction","impersonateUserId"),o.MSCRMCallerID=a),p("POST",i,t,o).then(function(e){if(e.data)return e.data})};this.initializeInstance=function(e){return e||(e=t),new r(e)}}var a=n(0),i=n(5),o=n(4),c=n(1),s=n(3);String.prototype.endsWith&&String.prototype.startsWith||n(2),e.exports=r},function(e,t){e.exports=function(e,t){return"string"==typeof t&&/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$/.exec(t)?new Date(t):t}},function(e,t,n){function r(e){var t=e.substr(0,e.indexOf("\r\n")),n=e.split(t);n.shift(),n.pop();for(var r=[],a=0;a<n.length;a++){var i=n[a],c=i.substring(i.indexOf("{"),i.lastIndexOf("}")+1);r.push(JSON.parse(c,o))}return r}function a(e){for(var t=Object.keys(e),n=0;n<t.length;n++){if(null!=e[t[n]]&&e[t[n]].constructor===Array)for(var r=0;r<e[t[n]].length;r++)e[t[n]][r]=a(e[t[n]][r]);if(-1!=t[n].indexOf("@")){var o=t[n].split("@"),c=null;switch(o[1]){case"odata.context":c="oDataContext";break;case"odata.count":c="oDataCount",e[t[n]]=null!=e[t[n]]?parseInt(e[t[n]]):0;break;case"odata.nextLink":c="oDataNextLink";break;case i.Prefer.Annotations.FormattedValue:c=o[0]+"_Formatted";break;case i.Prefer.Annotations.AssociatedNavigationProperty:c=o[0]+"_NavigationProperty";break;case i.Prefer.Annotations.LookupLogicalName:c=o[0]+"_LogicalName"}c&&(e[c]=e[t[n]])}}return e}var i=n(0),o=n(7);String.prototype.endsWith&&String.prototype.startsWith||n(2),e.exports=function(e){var t=null;return e.length&&(t=t=e.indexOf("--batchresponse_")>-1?r(e)[0]:JSON.parse(e,o),t=a(t)),t}},function(e,t){e.exports=function(e){var t={};if(!e)return t;for(var n=e.split("\r\n"),r=0,a=n.length;r<a;r++){var i=n[r],o=i.indexOf(": ");o>0&&(t[i.substring(0,o)]=i.substring(o+2))}return t}},function(e,t,n){var r=n(8),a=n(9),i=function(e,t,n,i,o,c,s){var u=new XMLHttpRequest;u.open(e,t,s);for(var l in i)u.setRequestHeader(l,i[l]);u.onreadystatechange=function(){if(4===u.readyState){switch(u.status){case 200:case 201:case 204:case 304:var e=r(u.responseText),t={data:e,headers:a(u.getAllResponseHeaders()),status:u.status};o(t);break;default:var n;try{n=JSON.parse(u.response).error}catch(e){n=u.response.length>0?{message:u.response}:{message:"Unexpected Error"}}n.status=u.status,c(n)}u=null}},u.onerror=function(){c({message:"Network Error"}),u=null},u.ontimeout=function(e){c({message:"Request Timed Out"}),u=null},n?u.send(n):u.send()};e.exports=i},function(e,t){e.exports=function(e){if(e){for(var t=Object.keys(e),n="",r="",a=1;a<=t.length;a++){var i=t[a-1],o=e[i];a>1&&(n+=",",r+="&"),n+=i+"=@p"+a,r+="@p"+a+"="+("string"==typeof o?"'"+o+"'":o)}return"("+n+")?"+r}return"()"}},function(e,t,n){var r=n(0),a=n(1);e.exports=function(e,t,n){var i=e.returnRepresentation,o=e.includeAnnotations,c=e.maxPageSize;if(e.prefer&&e.prefer.length){a.stringOrArrayParameterCheck(e.prefer,"DynamicsWebApi."+t,"request.prefer");var s=e.prefer;"string"==typeof s&&(s=s.split(","));for(var u in s){var l=s[u].trim();l===r.Prefer.ReturnRepresentation?i=!0:l.startsWith("odata.include-annotations=")?o=l.replace("odata.include-annotations=","").replace(/"/g,""):l.startsWith("odata.maxpagesize=")&&(c=l.replace("odata.maxpagesize=","").replace(/"/g,""))}}n&&(null==i&&(i=n.returnRepresentation),o=o||n.includeAnnotations,c=c||n.maxPageSize);var s=[];return i&&(a.boolParameterCheck(i,"DynamicsWebApi."+t,"request.returnRepresentation"),s.push(r.Prefer.ReturnRepresentation)),o&&(a.stringParameterCheck(o,"DynamicsWebApi."+t,"request.includeAnnotations"),s.push('odata.include-annotations="'+o+'"')),c&&c>0&&(a.numberParameterCheck(c,"DynamicsWebApi."+t,"request.maxPageSize"),s.push("odata.maxpagesize="+c)),s.join(",")}},function(e,t){e.exports=function(e){var t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}},function(e,t){e.exports=function(e,t){e=e||"",t=t||1,e=unescape(unescape(e));var n=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(null!=n){var r=parseInt(n[2]);return{cookie:n[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:r,nextPage:r+1}}return{cookie:"",page:t,nextPage:t+1}}}])});