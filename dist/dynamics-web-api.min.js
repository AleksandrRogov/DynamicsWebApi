/*! dynamics-web-api v2.1.5 (c) 2024 Aleksandr Rogov */
"use strict";var _dynamicsWebApiExports=(()=>{var _=Object.defineProperty;var he=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var ge=Object.prototype.hasOwnProperty;var f=(n,e)=>()=>(n&&(e=n(n=0)),e);var Z=(n,e)=>{for(var t in e)_(n,t,{get:e[t],enumerable:!0})},Re=(n,e,t,i)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of fe(e))!ge.call(n,a)&&a!==t&&_(n,a,{get:()=>e[a],enumerable:!(i=he(e,a))||i.enumerable});return n};var Y=n=>Re(_({},"__esModule",{value:!0}),n);function be(){return window.crypto}function ee(){return be().getRandomValues(new Uint8Array(1))}var te=f(()=>{"use strict"});function ne(n){return!!new RegExp(M,"i").exec(n)}function W(n){let e=new RegExp("^{?("+M+")}?$","i").exec(n);return e?e[1]:null}function F(n){let e=new RegExp("("+M+")\\)$","i").exec(n);return e?e[1]:null}var M,w=f(()=>{"use strict";M="[0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12}"});var Ae,y,l,D=f(()=>{"use strict";te();w();Ae=4194304,y=class y{static buildFunctionParameters(e){if(e){let t=Object.keys(e),i=[],a=[];for(let o=1;o<=t.length;o++){let c=t[o-1],s=e[c];s!=null&&(typeof s=="string"&&!s.startsWith("Microsoft.Dynamics.CRM")&&!ne(s)?s=`'${s}'`:typeof s=="object"&&(s=JSON.stringify(s)),i.push(`${c}=@p${o}`),a.push(`@p${o}=${W(s)||s}`))}return{key:`(${i.join(",")})`,queryParams:a}}else return{key:"()"}}static getFetchXmlPagingCookie(e="",t=1){e=decodeURIComponent(decodeURIComponent(e));let i=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/.exec(e);if(i!=null){let a=parseInt(i[2]);return{cookie:i[1].replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\"/g,"'").replace(/\'/g,"&quot;"),page:a,nextPage:a+1}}else return{cookie:"",page:t,nextPage:t+1}}static convertToReferenceObject(e){let t=/\/(\w+)\(([0-9A-F]{8}[-]?([0-9A-F]{4}[-]?){3}[0-9A-F]{12})/i.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}static isNull(e){return typeof e>"u"||e==null}static generateUUID(){return([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,e=>(e^ee()[0]&15>>e/4).toString(16))}static getXrmContext(){if(typeof GetGlobalContext<"u")return GetGlobalContext();if(typeof Xrm<"u"){if(!y.isNull(Xrm.Utility)&&!y.isNull(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!y.isNull(Xrm.Page)&&!y.isNull(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}static getClientUrl(){let t=y.getXrmContext().getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}static isRunningWithinPortals(){return!!window.shell}static isObject(e){return typeof e=="object"&&!!e&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Date]"}static copyObject(e,t){let i={};for(let a in e)e.hasOwnProperty(a)&&!t?.includes(a)&&(y.isObject(e[a])?i[a]=y.copyObject(e[a]):Array.isArray(e[a])?i[a]=e[a].slice():i[a]=e[a]);return i}static copyRequest(e,t=[]){t.includes("signal")||t.push("signal");let i=y.copyObject(e,t);return i.signal=e.signal,i}static setFileChunk(e,t,i,a){a=a||0;let o=a+i>t.length?t.length%i:i,c;c=new Uint8Array(o);for(let s=0;s<o;s++)c[s]=t[a+s];e.data=c,e.contentRange="bytes "+a+"-"+(a+o-1)+"/"+t.length}static convertToFileBuffer(e){let t=new Uint8Array(e.length);for(var i=0;i<e.length;i++)t[i]=e.charCodeAt(i);return t}};y.downloadChunkSize=Ae;l=y});function g(n,e,t){throw new Error(t?`${n} requires a ${e} parameter to be of type ${t}.`:`${n} requires a ${e} parameter.`)}var r,C=f(()=>{"use strict";w();r=class n{static handleErrorResponse(e){throw new Error(`Error: ${e.status}: ${e.message}`)}static parameterCheck(e,t,i,a){(typeof e>"u"||e===null||e==="")&&g(t,i,a)}static stringParameterCheck(e,t,i){typeof e!="string"&&g(t,i,"String")}static maxLengthStringParameterCheck(e,t,i,a){if(e&&e.length>a)throw new Error(`${i} has a ${a} character limit.`)}static arrayParameterCheck(e,t,i){e.constructor!==Array&&g(t,i,"Array")}static stringOrArrayParameterCheck(e,t,i){e.constructor!==Array&&typeof e!="string"&&g(t,i,"String or Array")}static numberParameterCheck(e,t,i){if(typeof e!="number"){if(typeof e=="string"&&e&&!isNaN(parseInt(e)))return;g(t,i,"Number")}}static batchIsEmpty(){return[new Error("Payload of the batch operation is empty. Please make that you have other operations in between startBatch() and executeBatch() to successfuly build a batch payload.")]}static handleHttpError(e,t){let i=new Error;return Object.keys(e).forEach(a=>{i[a]=e[a]}),t&&Object.keys(t).forEach(a=>{i[a]=t[a]}),i}static boolParameterCheck(e,t,i){typeof e!="boolean"&&g(t,i,"Boolean")}static guidParameterCheck(e,t,i){let a=W(e);return a||g(t,i,"GUID String"),a}static keyParameterCheck(e,t,i){try{n.stringParameterCheck(e,t,i);let a=W(e);if(a)return a;let o=e.split(",");if(o.length)for(let c=0;c<o.length;c++)o[c]=o[c].trim().replace(/"/g,"'"),/^[\w\d\_]+\=(.+)$/i.exec(o[c])[0];return o.join(",")}catch{g(t,i,"String representing GUID or Alternate Key")}}static callbackParameterCheck(e,t,i){typeof e!="function"&&g(t,i,"Function")}static throwBatchIncompatible(e,t){if(t)throw t=!1,new Error(e+" cannot be used in a BATCH request.")}static throwBatchNotStarted(e){if(!e)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")}}});var P,S,O,b,ie=f(()=>{"use strict";O=class O{};O.Prefer=(S=class{static get(e){return`${O.Prefer.IncludeAnnotations}="${e}"`}},S.ReturnRepresentation="return=representation",S.Annotations=(P=class{},P.AssociatedNavigationProperty="Microsoft.Dynamics.CRM.associatednavigationproperty",P.LookupLogicalName="Microsoft.Dynamics.CRM.lookuplogicalname",P.All="*",P.FormattedValue="OData.Community.Display.V1.FormattedValue",P.FetchXmlPagingCookie="Microsoft.Dynamics.CRM.fetchxmlpagingcookie",P),S.IncludeAnnotations="odata.include-annotations",S);b=O});function H(n,e){if(typeof e=="string"){let t=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/.exec(e);if(t)return new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4],+t[5],+t[6]))}return e}var re=f(()=>{"use strict"});function X(n,e){let t=null;if(n.indexOf("@")!==-1){let i=n.split("@");switch(i[1]){case"odata.context":t="oDataContext";break;case"odata.count":t="oDataCount",e=e!=null?parseInt(e):0;break;case"odata.nextLink":t="oDataNextLink";break;case"odata.deltaLink":t="oDataDeltaLink";break;case b.Prefer.Annotations.FormattedValue:t=i[0]+"_Formatted";break;case b.Prefer.Annotations.AssociatedNavigationProperty:t=i[0]+"_NavigationProperty";break;case b.Prefer.Annotations.LookupLogicalName:t=i[0]+"_LogicalName";break}}return[t,e]}function B(n,e){if(e){if(e.isRef&&n["@odata.id"]!=null)return l.convertToReferenceObject(n);if(e.toCount)return X("@odata.count",n["@odata.count"])[1]||0}let t=Object.keys(n);for(let a=0;a<t.length;a++){let o=t[a];if(n[o]!=null)if(n[o].constructor===Array)for(var i=0;i<n[o].length;i++)n[o][i]=B(n[o][i]);else typeof n[o]=="object"&&B(n[o]);let c=X(o,n[o]);if(c[0]&&(n[c[0]]=c[1]),o.indexOf("_x002e_")!==-1){let s=o.split("_x002e_");if(!n.hasOwnProperty(s[0]))n[s[0]]={_dwaType:"alias"};else if(typeof n[s[0]]!="object"||typeof n[s[0]]=="object"&&!n[s[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!");n[s[0]][s[1]]=n[o],c=X(s[1],n[o]),c[0]&&(n[s[0]][c[0]]=c[1])}}return e&&e.hasOwnProperty("pageNumber")&&n["@"+b.Prefer.Annotations.FetchXmlPagingCookie]!=null&&(n.PagingInfo=l.getFetchXmlPagingCookie(n["@"+b.Prefer.Annotations.FetchXmlPagingCookie],e.pageNumber)),n}function Te(n){let e={position:0},t={},i,a,o;do o=e.position,a=ve(n,e),i=De.exec(a),i!==null?t[i[1].toLowerCase()]=i[2]:e.position=o;while(a&&i);return t}function ve(n,e){return We(n,e,`\r
`)}function We(n,e,t){let i=e.position||0,a=n.length;if(t){if(a=n.indexOf(t,i),a===-1)return null;e.position=a+t.length}else e.position=a;return n.substring(i,a)}function se(n,e,t=0){let i=n.substr(0,n.indexOf(`\r
`)),a=n.split(i);a.shift(),a.pop();let o=[];for(let c=0;c<a.length;c++){let s=a[c];if(s.indexOf("--changesetresponse_")>-1){s=s.trim();let p=s.substring(s.indexOf(`\r
`)+1).trim();o=o.concat(se(p,e,t))}else{let p=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/gm.exec(s),u=parseInt(p[1]),d=p[2].trim(),I=s.substring(s.indexOf("{"),s.lastIndexOf("}")+1);if(I){let m=B(JSON.parse(I,H),e[t]);if(u>=400){let h=Te(s.substring(s.indexOf(p[0])+p[0].length+1,s.indexOf("{")));o.push(r.handleHttpError(m,{status:u,statusText:d,statusMessage:d,headers:h}))}else o.push(m)}else if(/Content-Type: text\/plain/i.test(s)){let m=/\w+$/gi.exec(s.trim()),h=m&&m.length?m[0]:void 0;o.push(isNaN(Number(h))?h:Number(h))}else if(e.length&&e[t]&&e[t].hasOwnProperty("valueIfEmpty"))o.push(e[t].valueIfEmpty);else{let m=/OData-EntityId.+/i.exec(s);if(m&&m.length){let h=F(m[0]);o.push(h||void 0)}else o.push(void 0)}}t++}return o}function Ne(n){return window.atob(n)}function Se(n,e,t){let i=n;t.hasOwnProperty("parse")&&(i=JSON.parse(i).value,i=Ne(i));var a={value:i};return e["x-ms-file-name"]&&(a.fileName=e["x-ms-file-name"]),e["x-ms-file-size"]&&(a.fileSize=parseInt(e["x-ms-file-size"])),U(e,"Location")&&(a.location=q(e,"Location")),a}function U(n,e){return n.hasOwnProperty(e)||n.hasOwnProperty(e.toLowerCase())}function q(n,e){return n[e]?n[e]:n[e.toLowerCase()]}function j(n,e,t){let i;if(n.length)if(n.indexOf("--batchresponse_")>-1){let a=se(n,t);i=t.length===1&&t[0].convertedToBatch?a[0]:a}else U(e,"Content-Disposition")?i=Se(n,e,t[0]):q(e,"Content-Type").startsWith("application/json")?i=B(JSON.parse(n,H),t[0]):i=isNaN(Number(n))?n:Number(n);else if(t.length&&t[0].hasOwnProperty("valueIfEmpty"))i=t[0].valueIfEmpty;else if(U(e,"OData-EntityId")){let a=q(e,"OData-EntityId"),o=F(a);o&&(i=o)}else U(e,"Location")&&(i={location:q(e,"Location")},e["x-ms-chunk-size"]&&(i.chunkSize=parseInt(e["x-ms-chunk-size"])));return i}var De,oe=f(()=>{"use strict";ie();D();C();re();w();De=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/});function k(n){let e={};if(!n)return e;let t=n.split(`\r
`);for(let i=0,a=t.length;i<a;i++){let o=t[i],c=o.indexOf(": ");c>0&&(e[o.substring(0,c)]=o.substring(c+2))}return e}var ce=f(()=>{"use strict"});var le={};Z(le,{XhrWrapper:()=>E,executeRequest:()=>Ee});function Ee(n){return new Promise((e,t)=>{Ie(n,e,t)})}function Ie(n,e,t){let i=n.data,a=n.headers,o=n.responseParams,c=n.abortSignal;if(c?.aborted){t(r.handleHttpError({name:"AbortError",code:20,message:"The user aborted a request."}));return}let s=new XMLHttpRequest;s.open(n.method,n.uri,n.isAsync||!1);for(let u in a)s.setRequestHeader(u,a[u]);s.onreadystatechange=function(){if(s.readyState===4)switch(c&&c.removeEventListener("abort",p),s.status){case 200:case 201:case 204:case 206:case 304:{let m=k(s.getAllResponseHeaders()),ye={data:j(s.responseText,m,o[n.requestId]),headers:m,status:s.status};s=null,e(ye);break}case 0:break;default:if(!s)break;let u,d;try{d=k(s.getAllResponseHeaders());let m=j(s.responseText,d,o[n.requestId]);if(Array.isArray(m)){t(m);break}u=m.error}catch{s.response.length>0?u={message:s.response}:u={message:"Unexpected Error"}}let I={status:s.status,statusText:s.statusText,headers:d};s=null,t(r.handleHttpError(u,I));break}},n.timeout&&(s.timeout=n.timeout),s.onerror=function(){let u=k(s.getAllResponseHeaders());t(r.handleHttpError({status:s.status,statusText:s.statusText,message:s.responseText||"Network Error",headers:u})),s=null},s.ontimeout=function(){let u=k(s.getAllResponseHeaders());t(r.handleHttpError({name:"TimeoutError",status:s.status,statusText:s.statusText,message:s.responseText||"Request Timed Out",headers:u})),s=null},s.onabort=function(){if(!s)return;let u=k(s.getAllResponseHeaders());t(r.handleHttpError({status:s.status,statusText:s.statusText,message:"Request aborted",headers:u})),s=null};let p=()=>{if(!s)return;let u=k(s.getAllResponseHeaders());t(r.handleHttpError({name:"AbortError",code:20,status:s.status,statusText:s.statusText,message:"The user aborted a request.",headers:u})),s.abort(),s=null};c&&c.addEventListener("abort",p),i?s.send(i):s.send(),E.afterSendEvent&&E.afterSendEvent()}var E,pe=f(()=>{"use strict";C();oe();ce();E=class{}});var Be={};Z(Be,{DynamicsWebApi:()=>J});D();C();var Ce=(n,e)=>l.isRunningWithinPortals()?new URL("_api",window.location.origin).toString()+"/":(n||(n=l.getClientUrl()),new URL(`api/${e.path}/v${e.version}`,n).toString()+"/"),K=(n,e,t)=>{let i=t[e];n?.version&&(r.stringParameterCheck(n.version,"DynamicsWebApi.setConfig",`config.${e}.version`),i.version=n.version),n?.path&&(r.stringParameterCheck(n.path,"DynamicsWebApi.setConfig",`config.${e}.path`),i.path=n.path),i.url=Ce(t.serverUrl,i)},x=class{static merge(e,t){t?.serverUrl&&(r.stringParameterCheck(t.serverUrl,"DynamicsWebApi.setConfig","config.serverUrl"),e.serverUrl=t.serverUrl),K(t?.dataApi,"dataApi",e),K(t?.searchApi,"searchApi",e),t?.impersonate&&(e.impersonate=r.guidParameterCheck(t.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),t?.impersonateAAD&&(e.impersonateAAD=r.guidParameterCheck(t.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),t?.onTokenRefresh&&(r.callbackParameterCheck(t.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),e.onTokenRefresh=t.onTokenRefresh),t?.includeAnnotations&&(r.stringParameterCheck(t.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),e.includeAnnotations=t.includeAnnotations),t?.timeout&&(r.numberParameterCheck(t.timeout,"DynamicsWebApi.setConfig","config.timeout"),e.timeout=t.timeout),t?.maxPageSize&&(r.numberParameterCheck(t.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),e.maxPageSize=t.maxPageSize),t?.returnRepresentation&&(r.boolParameterCheck(t.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),e.returnRepresentation=t.returnRepresentation),t?.useEntityNames&&(r.boolParameterCheck(t.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),e.useEntityNames=t.useEntityNames),t?.headers&&(e.headers=t.headers)}static default(){return{serverUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null,proxy:null,dataApi:{path:"data",version:"9.2",url:""},searchApi:{path:"search",version:"1.0",url:""}}}};x.mergeApiConfigs=K;D();C();D();D();C();var R=null,G=n=>{R=n},$=(n,e)=>{if(n.path=n.path||"",n.functionName=n.functionName||"",n.url)r.stringParameterCheck(n.url,`DynamicsWebApi.${n.functionName}`,"request.url"),n.path=n.url.replace(e.dataApi.url,"");else if(!n._isUnboundRequest&&!n.contentId&&!n.collection&&r.parameterCheck(n.collection,`DynamicsWebApi.${n.functionName}`,"request.collection"),n.collection!=null&&(r.stringParameterCheck(n.collection,`DynamicsWebApi.${n.functionName}`,"request.collection"),n.path=n.collection,n.key&&(n.key=r.keyParameterCheck(n.key,`DynamicsWebApi.${n.functionName}`,"request.key"),n.path+=`(${n.key})`)),n.contentId&&(r.stringParameterCheck(n.contentId,`DynamicsWebApi.${n.functionName}`,"request.contentId"),n.contentId.startsWith("$")&&(n.path=n.path?`${n.contentId}/${n.path}`:n.contentId)),n.addPath&&(n.path&&(n.path+="/"),n.path+=n.addPath),n.path=ae(n,e,n.path),n.fetchXml){r.stringParameterCheck(n.fetchXml,`DynamicsWebApi.${n.functionName}`,"request.fetchXml");let t=n.path.indexOf("?")===-1?"?":"&";n.path+=`${t}fetchXml=${encodeURIComponent(n.fetchXml)}`}return n.hasOwnProperty("async")&&n.async!=null?r.boolParameterCheck(n.async,`DynamicsWebApi.${n.functionName}`,"request.async"):n.async=!0,n.headers=xe(n,e),n},ae=(n,e,t="",i="&")=>{let a=[];if(n){if(n.navigationProperty){if(r.stringParameterCheck(n.navigationProperty,`DynamicsWebApi.${n.functionName}`,"request.navigationProperty"),t+="/"+n.navigationProperty,n.navigationPropertyKey){let o=r.keyParameterCheck(n.navigationPropertyKey,`DynamicsWebApi.${n.functionName}`,"request.navigationPropertyKey");t+="("+o+")"}n.navigationProperty==="Attributes"&&n.metadataAttributeType&&(r.stringParameterCheck(n.metadataAttributeType,`DynamicsWebApi.${n.functionName}`,"request.metadataAttributeType"),t+="/"+n.metadataAttributeType)}if(n.select?.length&&(r.arrayParameterCheck(n.select,`DynamicsWebApi.${n.functionName}`,"request.select"),n.functionName=="retrieve"&&n.select.length==1&&n.select[0].endsWith("/$ref")?t+="/"+n.select[0]:(n.select[0].startsWith("/")&&n.functionName=="retrieve"&&(n.navigationProperty==null?t+=n.select.shift():n.select.shift()),n.select.length&&a.push("$select="+n.select.join(",")))),n.filter){r.stringParameterCheck(n.filter,`DynamicsWebApi.${n.functionName}`,"request.filter");let o=/[^"']{([\w\d]{8}[-]?(?:[\w\d]{4}[-]?){3}[\w\d]{12})}(?:[^"']|$)/g,c=n.filter,s=null;for(;(s=o.exec(c))!==null;){s.index===o.lastIndex&&o.lastIndex++;let p=s[0].endsWith(")")?")":" ";c=c.replace(s[0]," "+s[1]+p)}a.push("$filter="+encodeURIComponent(c))}if(n.fieldName&&(r.stringParameterCheck(n.fieldName,`DynamicsWebApi.${n.functionName}`,"request.fieldName"),t+="/"+n.fieldName),n.savedQuery&&a.push("savedQuery="+r.guidParameterCheck(n.savedQuery,`DynamicsWebApi.${n.functionName}`,"request.savedQuery")),n.userQuery&&a.push("userQuery="+r.guidParameterCheck(n.userQuery,`DynamicsWebApi.${n.functionName}`,"request.userQuery")),n.apply&&(r.stringParameterCheck(n.apply,`DynamicsWebApi.${n.functionName}`,"request.apply"),a.push("$apply="+n.apply)),n.count&&(r.boolParameterCheck(n.count,`DynamicsWebApi.${n.functionName}`,"request.count"),a.push("$count="+n.count)),n.top&&n.top>0&&(r.numberParameterCheck(n.top,`DynamicsWebApi.${n.functionName}`,"request.top"),a.push("$top="+n.top)),n.orderBy!=null&&n.orderBy.length&&(r.arrayParameterCheck(n.orderBy,`DynamicsWebApi.${n.functionName}`,"request.orderBy"),a.push("$orderby="+n.orderBy.join(","))),n.partitionId&&(r.stringParameterCheck(n.partitionId,`DynamicsWebApi.${n.functionName}`,"request.partitionId"),a.push("partitionid='"+n.partitionId+"'")),n.downloadSize&&(r.stringParameterCheck(n.downloadSize,`DynamicsWebApi.${n.functionName}`,"request.downloadSize"),a.push("size="+n.downloadSize)),n.queryParams?.length&&(r.arrayParameterCheck(n.queryParams,`DynamicsWebApi.${n.functionName}`,"request.queryParams"),a.push(n.queryParams.join("&"))),n.fileName&&(r.stringParameterCheck(n.fileName,`DynamicsWebApi.${n.functionName}`,"request.fileName"),a.push("x-ms-file-name="+n.fileName)),n.data&&r.parameterCheck(n.data,`DynamicsWebApi.${n.functionName}`,"request.data"),n.isBatch&&r.boolParameterCheck(n.isBatch,`DynamicsWebApi.${n.functionName}`,"request.isBatch"),l.isNull(n.inChangeSet)||r.boolParameterCheck(n.inChangeSet,`DynamicsWebApi.${n.functionName}`,"request.inChangeSet"),n.isBatch&&l.isNull(n.inChangeSet)&&(n.inChangeSet=!0),n.timeout&&r.numberParameterCheck(n.timeout,`DynamicsWebApi.${n.functionName}`,"request.timeout"),n.expand?.length)if(r.stringOrArrayParameterCheck(n.expand,`DynamicsWebApi.${n.functionName}`,"request.expand"),typeof n.expand=="string")a.push("$expand="+n.expand);else{let o=[];for(let c=0;c<n.expand.length;c++)if(n.expand[c].property){let s=n.expand[c];s.functionName=`${n.functionName} $expand`;let p=ae(s,e,"",";");p&&(p=`(${p.substr(1)})`),o.push(n.expand[c].property+p)}o.length&&a.push("$expand="+o.join(","))}}return a.length?t+"?"+a.join(i):t},xe=(n,e)=>{let t={...e.headers,...n.userHeaders},i=Pe(n,e);if(i.length&&(t.Prefer=i),n.collection==="$metadata"&&(t.Accept="application/xml"),n.transferMode&&(t["x-ms-transfer-mode"]=n.transferMode),n.ifmatch!=null&&n.ifnonematch!=null)throw new Error(`DynamicsWebApi.${n.functionName}. Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.`);return n.ifmatch&&(r.stringParameterCheck(n.ifmatch,`DynamicsWebApi.${n.functionName}`,"request.ifmatch"),t["If-Match"]=n.ifmatch),n.ifnonematch&&(r.stringParameterCheck(n.ifnonematch,`DynamicsWebApi.${n.functionName}`,"request.ifnonematch"),t["If-None-Match"]=n.ifnonematch),n.impersonate&&(r.stringParameterCheck(n.impersonate,`DynamicsWebApi.${n.functionName}`,"request.impersonate"),t.MSCRMCallerID=r.guidParameterCheck(n.impersonate,`DynamicsWebApi.${n.functionName}`,"request.impersonate")),n.impersonateAAD&&(r.stringParameterCheck(n.impersonateAAD,`DynamicsWebApi.${n.functionName}`,"request.impersonateAAD"),t.CallerObjectId=r.guidParameterCheck(n.impersonateAAD,`DynamicsWebApi.${n.functionName}`,"request.impersonateAAD")),n.token&&(r.stringParameterCheck(n.token,`DynamicsWebApi.${n.functionName}`,"request.token"),t.Authorization="Bearer "+n.token),n.duplicateDetection&&(r.boolParameterCheck(n.duplicateDetection,`DynamicsWebApi.${n.functionName}`,"request.duplicateDetection"),t["MSCRM.SuppressDuplicateDetection"]="false"),n.bypassCustomPluginExecution&&(r.boolParameterCheck(n.bypassCustomPluginExecution,`DynamicsWebApi.${n.functionName}`,"request.bypassCustomPluginExecution"),t["MSCRM.BypassCustomPluginExecution"]="true"),n.noCache&&(r.boolParameterCheck(n.noCache,`DynamicsWebApi.${n.functionName}`,"request.noCache"),t["Cache-Control"]="no-cache"),n.mergeLabels&&(r.boolParameterCheck(n.mergeLabels,`DynamicsWebApi.${n.functionName}`,"request.mergeLabels"),t["MSCRM.MergeLabels"]="true"),n.contentId&&(r.stringParameterCheck(n.contentId,`DynamicsWebApi.${n.functionName}`,"request.contentId"),n.contentId.startsWith("$")||(t["Content-ID"]=n.contentId)),n.contentRange&&(r.stringParameterCheck(n.contentRange,`DynamicsWebApi.${n.functionName}`,"request.contentRange"),t["Content-Range"]=n.contentRange),n.range&&(r.stringParameterCheck(n.range,`DynamicsWebApi.${n.functionName}`,"request.range"),t.Range=n.range),t},Pe=(n,e)=>{let t=n.returnRepresentation,i=n.includeAnnotations,a=n.maxPageSize,o=n.trackChanges,c=n.continueOnError,s=[];if(n.prefer&&n.prefer.length){r.stringOrArrayParameterCheck(n.prefer,`DynamicsWebApi.${n.functionName}`,"request.prefer"),typeof n.prefer=="string"&&(s=n.prefer.split(","));for(let p in s){let u=s[p].trim();u==="return=representation"?t=!0:u.includes("odata.include-annotations=")?i=u.replace("odata.include-annotations=","").replace(/"/g,""):u.startsWith("odata.maxpagesize=")?a=Number(u.replace("odata.maxpagesize=","").replace(/"/g,""))||0:u.includes("odata.track-changes")?o=!0:u.includes("odata.continue-on-error")&&(c=!0)}}return s=[],e&&(t==null&&(t=e.returnRepresentation),i=i||e.includeAnnotations,a=a||e.maxPageSize),t&&(r.boolParameterCheck(t,`DynamicsWebApi.${n.functionName}`,"request.returnRepresentation"),s.push("return=representation")),i&&(r.stringParameterCheck(i,`DynamicsWebApi.${n.functionName}`,"request.includeAnnotations"),s.push(`odata.include-annotations="${i}"`)),a&&a>0&&(r.numberParameterCheck(a,`DynamicsWebApi.${n.functionName}`,"request.maxPageSize"),s.push("odata.maxpagesize="+a)),o&&(r.boolParameterCheck(o,`DynamicsWebApi.${n.functionName}`,"request.trackChanges"),s.push("odata.track-changes")),c&&(r.boolParameterCheck(c,`DynamicsWebApi.${n.functionName}`,"request.continueOnError"),s.push("odata.continue-on-error")),s.join(",")},L=(n,e,t)=>{let i=`dwa_batch_${l.generateUUID()}`,a=[],o=null,c=1e5;n.forEach(p=>{p.functionName="executeBatch",t?.inChangeSet===!1&&(p.inChangeSet=!1);let u=p.method==="GET"?!1:!!p.inChangeSet;if(!u&&o&&(a.push(`
--${o}--`),o=null,c=1e5),o||(a.push(`
--${i}`),u&&(o=`changeset_${l.generateUUID()}`,a.push("Content-Type: multipart/mixed;boundary="+o))),u&&a.push(`
--${o}`),a.push("Content-Type: application/http"),a.push("Content-Transfer-Encoding: binary"),u){let d=p.headers.hasOwnProperty("Content-ID")?p.headers["Content-ID"]:++c;a.push(`Content-ID: ${d}`)}p.path?.startsWith("$")?a.push(`
${p.method} ${p.path} HTTP/1.1`):a.push(`
${p.method} ${e.dataApi.url}${p.path} HTTP/1.1`),p.method==="GET"?a.push("Accept: application/json"):a.push("Content-Type: application/json");for(let d in p.headers)d==="Authorization"||d==="Content-ID"||a.push(`${d}: ${p.headers[d]}`);p.data&&a.push(`
${V(p.data,e)}`)}),o&&a.push(`
--${o}--`),a.push(`
--${i}--`);let s=z(t?.userHeaders);return s["Content-Type"]=`multipart/mixed;boundary=${i}`,{headers:s,body:a.join(`
`)}},N=n=>{let e=null;if(!l.isNull(R)&&(e=R[n],!e)){for(let t in R)if(R[t]===n)return n}return e},V=(n,e)=>{let t=null;if(n){if(n instanceof Uint8Array||n instanceof Uint16Array||n instanceof Uint32Array)return n;t=JSON.stringify(n,(i,a)=>{if(i.endsWith("@odata.bind")||i.endsWith("@odata.id")){if(typeof a=="string"&&!a.startsWith("$")){if(/\(\{[\w\d-]+\}\)/g.test(a)&&(a=a.replace(/(.+)\(\{([\w\d-]+)\}\)/g,"$1($2)")),e.useEntityNames){let o=/([\w_]+)(\([\d\w-]+\))$/,c=o.exec(a);if(c&&c.length>2){let s=N(c[1]);l.isNull(s)||(a=a.replace(o,s+"$2"))}}a.startsWith(e.dataApi.url)||(i.endsWith("@odata.bind")?a.startsWith("/")||(a="/"+a):a=e.dataApi.url+a.replace(/^\//,""))}}else(i.startsWith("oData")||i.endsWith("_Formatted")||i.endsWith("_NavigationProperty")||i.endsWith("_LogicalName"))&&(a=void 0);return a}),t=t.replace(/[\u007F-\uFFFF]/g,function(i){return"\\u"+("0000"+i.charCodeAt(0).toString(16)).slice(-4)})}return t},z=(n={})=>(n.Accept||(n.Accept="application/json"),n["OData-MaxVersion"]||(n["OData-MaxVersion"]="4.0"),n["OData-Version"]||(n["OData-Version"]="4.0"),n["Content-Range"]?n["Content-Type"]="application/octet-stream":n["Content-Type"]||(n["Content-Type"]="application/json; charset=utf-8"),n);C();async function ue(n){return(pe(),Y(le)).executeRequest(n)}var me=(n,e)=>{T[n]?T[n].push(e):T[n]=[e]},we=(n,e)=>{A[n]?A[n].push(e):A[n]=[e]},Q=n=>{delete T[n],A.hasOwnProperty(n)&&delete A[n]},de=async(n,e)=>{try{let t=await v.sendRequest(n,e);return Q(n.requestId),t}catch(t){throw Q(n.requestId),t}finally{Q(n.requestId)}},A={},T={},$e=["$metadata","EntityDefinitions","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions","query","suggest","autocomplete"],Oe=n=>$e.indexOf(n)>-1,Ue=async(n,e)=>{if(!l.isNull(R))return N(n)||n;let t=$({method:"GET",collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0,functionName:"retrieveMultiple"},e),i=await de(t,e);G({});for(let a=0;a<i.data.value.length;a++)R[i.data.value[a].LogicalName]=i.data.value[a].EntitySetName;return N(n)||n},qe=async(n,e)=>{if(!n||Oe(n)||(n=n.toLowerCase(),!e.useEntityNames))return n;try{return await Ue(n,e)}catch(t){throw new Error("Unable to fetch Collection Names. Error: "+t.message)}},v=class{static async sendRequest(e,t){e.headers=e.headers||{},e.responseParameters=e.responseParameters||{},e.requestId=e.requestId||l.generateUUID(),me(e.requestId,e.responseParameters);let i=null,a=e.responseParameters?.convertedToBatch;if(e.path==="$batch"&&!a){let s=A[e.requestId];if(!s)throw r.batchIsEmpty();let p=L(s,t,e);i=p.body,e.headers={...p.headers,...e.headers},delete A[e.requestId]}else i=a?e.data:V(e.data,t),a||(e.headers=z(e.headers));t.impersonate&&!e.headers.MSCRMCallerID&&(e.headers.MSCRMCallerID=t.impersonate),t.impersonateAAD&&!e.headers.CallerObjectId&&(e.headers.CallerObjectId=t.impersonateAAD);let o=null;if(t.onTokenRefresh&&(!e.headers||e.headers&&!e.headers.Authorization)&&(o=await t.onTokenRefresh(),!o))throw new Error("Token is empty. Request is aborted.");o&&(e.headers.Authorization="Bearer "+(o.hasOwnProperty("accessToken")?o.accessToken:o)),l.isRunningWithinPortals()&&(e.headers.__RequestVerificationToken=await window.shell.getTokenDeferred());let c=e.apiConfig?e.apiConfig.url:t.dataApi.url;return await ue({method:e.method,uri:c.toString()+e.path,data:i,proxy:t.proxy,isAsync:e.async,headers:e.headers,requestId:e.requestId,abortSignal:e.signal,responseParams:T,timeout:e.timeout||t.timeout})}static async makeRequest(e,t){if(e.responseParameters=e.responseParameters||{},e.userHeaders=e.headers,delete e.headers,!e.isBatch){let i=await qe(e.collection,t);if(e.collection=i,$(e,t),e.responseParameters.convertedToBatch=!1,e.path.length>2e3){let a=L([e],t);e.headers.Authorization&&(a.headers.Authorization=e.headers.Authorization),e.method="POST",e.path="$batch",e.data=a.body,e.headers={...a.headers,...e.userHeaders},e.responseParameters.convertedToBatch=!0}return de(e,t)}$(e,t),me(e.requestId,e.responseParameters),we(e.requestId,e)}static _clearTestData(){G(null),T={},A={}}static getCollectionName(e){return N(e)}};var J=class n{constructor(e){this._config=x.default();this._isBatch=!1;this._batchRequestId=null;this.setConfig=e=>x.merge(this._config,e);this._makeRequest=async e=>(e.isBatch=this._isBatch,this._batchRequestId&&(e.requestId=this._batchRequestId),v.makeRequest(e,this._config));this.create=async e=>{r.parameterCheck(e,"DynamicsWebApi.create","request");let t;return e.functionName?t=e:(t=l.copyRequest(e),t.functionName="create"),t.method="POST",(await this._makeRequest(t))?.data};this.retrieve=async e=>{r.parameterCheck(e,"DynamicsWebApi.retrieve","request");let t;return e.functionName?t=e:(t=l.copyRequest(e),t.functionName="retrieve"),t.method="GET",t.responseParameters={isRef:t.select?.length===1&&t.select[0].endsWith("/$ref")},(await this._makeRequest(t))?.data};this.update=async e=>{r.parameterCheck(e,"DynamicsWebApi.update","request");let t;e.functionName?t=e:(t=l.copyRequest(e),t.functionName="update"),t.method||(t.method=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/.test(t.collection||"")?"PUT":"PATCH"),t.responseParameters={valueIfEmpty:!0},t.ifmatch==null&&(t.ifmatch="*");let i=t.ifmatch;try{return(await this._makeRequest(t))?.data}catch(a){if(i&&a.status===412)return!1;throw a}};this.updateSingleProperty=async e=>{r.parameterCheck(e,"DynamicsWebApi.updateSingleProperty","request"),r.parameterCheck(e.fieldValuePair,"DynamicsWebApi.updateSingleProperty","request.fieldValuePair");var t=Object.keys(e.fieldValuePair)[0],i=e.fieldValuePair[t];let a=l.copyRequest(e);return a.navigationProperty=t,a.data={value:i},a.functionName="updateSingleProperty",a.method="PUT",delete a.fieldValuePair,(await this._makeRequest(a))?.data};this.deleteRecord=async e=>{r.parameterCheck(e,"DynamicsWebApi.deleteRecord","request");let t;e.functionName?t=e:(t=l.copyRequest(e),t.functionName="deleteRecord"),t.method="DELETE",t.responseParameters={valueIfEmpty:!0};let i=t.ifmatch;try{return(await this._makeRequest(t))?.data}catch(a){if(i&&a.status===412)return!1;throw a}};this.upsert=async e=>{r.parameterCheck(e,"DynamicsWebApi.upsert","request");let t=l.copyRequest(e);t.method="PATCH",t.functionName="upsert";let i=t.ifnonematch,a=t.ifmatch;try{return(await this._makeRequest(t))?.data}catch(o){if(i&&o.status===412)return null;if(a&&o.status===404)return null;throw o}};this._uploadFileChunk=async(e,t,i,a=0)=>{if(l.setFileChunk(e,t,i,a),await this._makeRequest(e),a+=i,a<=t.length)return this._uploadFileChunk(e,t,i,a)};this.uploadFile=async e=>{r.throwBatchIncompatible("DynamicsWebApi.uploadFile",this._isBatch),r.parameterCheck(e,"DynamicsWebApi.uploadFile","request");let t=l.copyRequest(e,["data"]);t.method="PATCH",t.functionName="uploadFile",t.transferMode="chunked";let i=await this._makeRequest(t);return t.url=i?.data.location,delete t.transferMode,delete t.fieldName,delete t.fileName,this._uploadFileChunk(t,e.data,i?.data.chunkSize)};this._downloadFileChunk=async(e,t=0,i="")=>{e.range="bytes="+t+"-"+(t+l.downloadChunkSize-1),e.downloadSize="full";let a=await this._makeRequest(e);return e.url=a?.data.location,i+=a?.data.value,t+=l.downloadChunkSize,t<=a?.data.fileSize?this._downloadFileChunk(e,t,i):{fileName:a?.data.fileName,fileSize:a?.data.fileSize,data:l.convertToFileBuffer(i)}};this.downloadFile=e=>{r.throwBatchIncompatible("DynamicsWebApi.downloadFile",this._isBatch),r.parameterCheck(e,"DynamicsWebApi.downloadFile","request");let t=l.copyRequest(e);return t.method="GET",t.functionName="downloadFile",t.responseParameters={parse:!0},this._downloadFileChunk(t)};this.retrieveMultiple=async(e,t)=>{r.parameterCheck(e,"DynamicsWebApi.retrieveMultiple","request");let i;return e.functionName?i=e:(i=l.copyRequest(e),i.functionName="retrieveMultiple"),i.method="GET",t&&(r.stringParameterCheck(t,"DynamicsWebApi.retrieveMultiple","nextPageLink"),i.url=t),(await this._makeRequest(i))?.data};this._retrieveAllRequest=async(e,t,i=[])=>{let a=await this.retrieveMultiple(e,t);i=i.concat(a.value);let o=a.oDataNextLink;if(o)return this._retrieveAllRequest(e,o,i);let c={value:i};return a.oDataDeltaLink&&(c["@odata.deltaLink"]=a.oDataDeltaLink,c.oDataDeltaLink=a.oDataDeltaLink),c};this.retrieveAll=e=>(r.throwBatchIncompatible("DynamicsWebApi.retrieveAll",this._isBatch),this._retrieveAllRequest(e));this.count=async e=>{r.parameterCheck(e,"DynamicsWebApi.count","request");let t=l.copyRequest(e);return t.method="GET",t.functionName="count",t.filter?.length?t.count=!0:t.navigationProperty="$count",t.responseParameters={toCount:t.count},(await this._makeRequest(t))?.data};this.countAll=async e=>{r.throwBatchIncompatible("DynamicsWebApi.countAll",this._isBatch),r.parameterCheck(e,"DynamicsWebApi.countAll","request");let t=await this._retrieveAllRequest(e);return t&&t.value?t.value.length:0};this.fetch=async e=>{r.parameterCheck(e,"DynamicsWebApi.fetch","request");let t=l.copyRequest(e);if(t.method="GET",t.functionName="fetch",r.stringParameterCheck(t.fetchXml,"DynamicsWebApi.fetch","request.fetchXml"),t.fetchXml&&!/^<fetch.+top=/.test(t.fetchXml)){let a="";/^<fetch.+page=/.test(t.fetchXml)||(t.pageNumber=t.pageNumber||1,r.numberParameterCheck(t.pageNumber,"DynamicsWebApi.fetch","request.pageNumber"),a=`$1 page="${t.pageNumber}"`),t.pagingCookie!=null&&(r.stringParameterCheck(t.pagingCookie,"DynamicsWebApi.fetch","request.pagingCookie"),a+=` paging-cookie="${t.pagingCookie}"`),a&&(t.fetchXml=t.fetchXml.replace(/^(<fetch)/,a))}return t.responseParameters={pageNumber:t.pageNumber},(await this._makeRequest(t))?.data};this.fetchAll=async e=>{r.parameterCheck(e,"DynamicsWebApi.fetchAll","request");let t=async(i,a=[])=>{let o=await this.fetch(i);return a=a.concat(o.value),o.PagingInfo?(i.pageNumber=o.PagingInfo.nextPage,i.pagingCookie=o.PagingInfo.cookie,t(i,a)):{value:a}};return r.throwBatchIncompatible("DynamicsWebApi.fetchAll",this._isBatch),t(e)};this.associate=async e=>{r.parameterCheck(e,"DynamicsWebApi.associate","request");let t=l.copyRequest(e);t.method="POST",t.functionName="associate",r.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associate","request.relatedcollection"),r.stringParameterCheck(e.relationshipName,"DynamicsWebApi.associate","request.relationshipName");let i=r.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associate","request.primaryKey"),a=r.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associate","request.relatedKey");t.navigationProperty=e.relationshipName+"/$ref",t.key=i,t.data={"@odata.id":`${e.relatedCollection}(${a})`},await this._makeRequest(t)};this.disassociate=async e=>{r.parameterCheck(e,"DynamicsWebApi.disassociate","request");let t=l.copyRequest(e);t.method="DELETE",t.functionName="disassociate",r.stringParameterCheck(e.relationshipName,"DynamicsWebApi.disassociate","request.relationshipName");let i=r.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociate","request.primaryKey"),a=r.keyParameterCheck(e.relatedKey,"DynamicsWebApi.disassociate","request.relatedId");t.key=i,t.navigationProperty=`${e.relationshipName}(${a})/$ref`,await this._makeRequest(t)};this.associateSingleValued=async e=>{r.parameterCheck(e,"DynamicsWebApi.associateSingleValued","request");let t=l.copyRequest(e);t.method="PUT",t.functionName="associateSingleValued";let i=r.keyParameterCheck(e.primaryKey,"DynamicsWebApi.associateSingleValued","request.primaryKey"),a=r.keyParameterCheck(e.relatedKey,"DynamicsWebApi.associateSingleValued","request.relatedKey");r.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.associateSingleValued","request.navigationProperty"),r.stringParameterCheck(e.relatedCollection,"DynamicsWebApi.associateSingleValued","request.relatedcollection"),t.navigationProperty+="/$ref",t.key=i,t.data={"@odata.id":`${e.relatedCollection}(${a})`},await this._makeRequest(t)};this.disassociateSingleValued=async e=>{r.parameterCheck(e,"DynamicsWebApi.disassociateSingleValued","request");let t=l.copyRequest(e);t.method="DELETE",t.functionName="disassociateSingleValued";let i=r.keyParameterCheck(e.primaryKey,"DynamicsWebApi.disassociateSingleValued","request.primaryKey");r.stringParameterCheck(e.navigationProperty,"DynamicsWebApi.disassociateSingleValued","request.navigationProperty"),t.navigationProperty+="/$ref",t.key=i,await this._makeRequest(t)};this.callFunction=async e=>{r.parameterCheck(e,"DynamicsWebApi.callFunction","request");let t=u=>u.name||u.functionName,i=typeof e!="string",a=i?t(e):e,o=i?"request.name":"name",c=i?l.copyObject(e,["name"]):{functionName:a};r.stringParameterCheck(a,"DynamicsWebApi.callFunction",o);let s=l.buildFunctionParameters(c.parameters);return c.method="GET",c.addPath=a+s.key,c.queryParams=s.queryParams,c._isUnboundRequest=!c.collection,c.functionName="callFunction",(await this._makeRequest(c))?.data};this.callAction=async e=>{r.parameterCheck(e,"DynamicsWebApi.callAction","request"),r.stringParameterCheck(e.actionName,"DynamicsWebApi.callAction","request.actionName");let t=l.copyRequest(e,["action"]);return t.method="POST",t.functionName="callAction",t.addPath=e.actionName,t._isUnboundRequest=!t.collection,t.data=e.action,(await this._makeRequest(t))?.data};this.createEntity=e=>{r.parameterCheck(e,"DynamicsWebApi.createEntity","request"),r.parameterCheck(e.data,"DynamicsWebApi.createEntity","request.data");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="createEntity",this.create(t)};this.updateEntity=e=>{r.parameterCheck(e,"DynamicsWebApi.updateEntity","request"),r.parameterCheck(e.data,"DynamicsWebApi.updateEntity","request.data"),r.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateEntity","request.data.MetadataId");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.key=t.data.MetadataId,t.functionName="updateEntity",t.method="PUT",this.update(t)};this.retrieveEntity=e=>{r.parameterCheck(e,"DynamicsWebApi.retrieveEntity","request"),r.keyParameterCheck(e.key,"DynamicsWebApi.retrieveEntity","request.key");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",this.retrieve(t)};this.retrieveEntities=e=>{let t=e?l.copyRequest(e):{};return t.collection="EntityDefinitions",t.functionName="retrieveEntities",this.retrieveMultiple(t)};this.createAttribute=e=>{r.parameterCheck(e,"DynamicsWebApi.createAttribute","request"),r.parameterCheck(e.data,"DynamicsWebApi.createAttribute","request.data"),r.keyParameterCheck(e.entityKey,"DynamicsWebApi.createAttribute","request.entityKey");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.functionName="retrieveEntity",t.navigationProperty="Attributes",t.key=e.entityKey,this.create(t)};this.updateAttribute=e=>{r.parameterCheck(e,"DynamicsWebApi.updateAttribute","request"),r.parameterCheck(e.data,"DynamicsWebApi.updateAttribute","request.data"),r.keyParameterCheck(e.entityKey,"DynamicsWebApi.updateAttribute","request.entityKey"),r.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateAttribute","request.data.MetadataId"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.updateAttribute","request.castType");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.data.MetadataId,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="updateAttribute",t.method="PUT",this.update(t)};this.retrieveAttributes=e=>{r.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),r.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttributes","request.entityKey"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttributes","request.castType");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttributes",this.retrieveMultiple(t)};this.retrieveAttribute=e=>{r.parameterCheck(e,"DynamicsWebApi.retrieveAttributes","request"),r.keyParameterCheck(e.entityKey,"DynamicsWebApi.retrieveAttribute","request.entityKey"),r.keyParameterCheck(e.attributeKey,"DynamicsWebApi.retrieveAttribute","request.attributeKey"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveAttribute","request.castType");let t=l.copyRequest(e);return t.collection="EntityDefinitions",t.navigationProperty="Attributes",t.navigationPropertyKey=e.attributeKey,t.metadataAttributeType=e.castType,t.key=e.entityKey,t.functionName="retrieveAttribute",this.retrieve(t)};this.createRelationship=e=>{r.parameterCheck(e,"DynamicsWebApi.createRelationship","request"),r.parameterCheck(e.data,"DynamicsWebApi.createRelationship","request.data");let t=l.copyRequest(e);return t.collection="RelationshipDefinitions",t.functionName="createRelationship",this.create(t)};this.updateRelationship=e=>{r.parameterCheck(e,"DynamicsWebApi.updateRelationship","request"),r.parameterCheck(e.data,"DynamicsWebApi.updateRelationship","request.data"),r.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateRelationship","request.data.MetadataId"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.updateRelationship","request.castType");let t=l.copyRequest(e);return t.collection="RelationshipDefinitions",t.key=e.data.MetadataId,t.navigationProperty=e.castType,t.functionName="updateRelationship",t.method="PUT",this.update(t)};this.deleteRelationship=e=>{r.parameterCheck(e,"DynamicsWebApi.deleteRelationship","request"),r.keyParameterCheck(e.key,"DynamicsWebApi.deleteRelationship","request.key");let t=l.copyRequest(e);return t.collection="RelationshipDefinitions",t.functionName="deleteRelationship",this.deleteRecord(t)};this.retrieveRelationships=e=>{let t=e?l.copyRequest(e):{};return t.collection="RelationshipDefinitions",t.functionName="retrieveRelationships",e&&e.castType&&(r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationships","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)};this.retrieveRelationship=e=>{r.parameterCheck(e,"DynamicsWebApi.retrieveRelationship","request"),r.keyParameterCheck(e.key,"DynamicsWebApi.retrieveRelationship","request.key"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveRelationship","request.castType");let t=l.copyRequest(e);return t.collection="RelationshipDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveRelationship",this.retrieve(t)};this.createGlobalOptionSet=e=>{r.parameterCheck(e,"DynamicsWebApi.createGlobalOptionSet","request"),r.parameterCheck(e.data,"DynamicsWebApi.createGlobalOptionSet","request.data");let t=l.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="createGlobalOptionSet",this.create(t)};this.updateGlobalOptionSet=e=>{r.parameterCheck(e,"DynamicsWebApi.updateGlobalOptionSet","request"),r.parameterCheck(e.data,"DynamicsWebApi.updateGlobalOptionSet","request.data"),r.guidParameterCheck(e.data.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","request.data.MetadataId"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.updateGlobalOptionSet","request.castType");let t=l.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.key=e.data.MetadataId,t.functionName="updateGlobalOptionSet",t.method="PUT",this.update(t)};this.deleteGlobalOptionSet=e=>{r.parameterCheck(e,"DynamicsWebApi.deleteGlobalOptionSet","request");let t=l.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.functionName="deleteGlobalOptionSet",this.deleteRecord(t)};this.retrieveGlobalOptionSet=e=>{r.parameterCheck(e,"DynamicsWebApi.retrieveGlobalOptionSet","request"),e.castType&&r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSet","request.castType");let t=l.copyRequest(e);return t.collection="GlobalOptionSetDefinitions",t.navigationProperty=e.castType,t.functionName="retrieveGlobalOptionSet",this.retrieve(t)};this.retrieveGlobalOptionSets=e=>{let t=e?l.copyRequest(e):{};return t.collection="GlobalOptionSetDefinitions",t.functionName="retrieveGlobalOptionSets",e?.castType&&(r.stringParameterCheck(e.castType,"DynamicsWebApi.retrieveGlobalOptionSets","request.castType"),t.navigationProperty=e.castType),this.retrieveMultiple(t)};this.retrieveCsdlMetadata=async e=>{let t=e?l.copyRequest(e):{};return t.collection="$metadata",t.functionName="retrieveCsdlMetadata",e?.addAnnotations&&(r.boolParameterCheck(e.addAnnotations,"DynamicsWebApi.retrieveCsdlMetadata","request.addAnnotations"),t.includeAnnotations="*"),(await this._makeRequest(t))?.data};this.search=async e=>{r.parameterCheck(e,"DynamicsWebApi.search","request");let t=l.isObject(e),i=t?"request.query.search":"term",a=t?l.copyObject(e):{query:{search:e}};return r.parameterCheck(a.query,"DynamicsWebApi.search","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.search",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.search",i,100),a.collection="query",a.functionName="search",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,(await this._makeRequest(a))?.data};this.suggest=async e=>{r.parameterCheck(e,"DynamicsWebApi.suggest","request");let t=l.isObject(e),i=t?"request.query.search":"term",a=t?l.copyObject(e):{query:{search:e}};return r.parameterCheck(a.query,"DynamicsWebApi.suggest","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.suggest",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.suggest",i,100),a.functionName=a.collection="suggest",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,(await this._makeRequest(a))?.data};this.autocomplete=async e=>{r.parameterCheck(e,"DynamicsWebApi.autocomplete","request");let t=l.isObject(e),i=t?"request.query.search":"term",a=t?l.copyObject(e):{query:{search:e}};return t&&r.parameterCheck(a.query,"DynamicsWebApi.autocomplete","request.query"),r.stringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",i),r.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",i,100),a.functionName=a.collection="autocomplete",a.method="POST",a.data=a.query,a.apiConfig=this._config.searchApi,delete a.query,(await this._makeRequest(a))?.data};this.startBatch=()=>{this._isBatch=!0,this._batchRequestId=l.generateUUID()};this.executeBatch=async e=>{r.throwBatchNotStarted(this._isBatch);let t=e?l.copyRequest(e):{};return t.collection="$batch",t.method="POST",t.functionName="executeBatch",t.requestId=this._batchRequestId,this._batchRequestId=null,this._isBatch=!1,(await this._makeRequest(t))?.data};this.initializeInstance=e=>new n(e||this._config);this.Utility={getCollectionName:e=>v.getCollectionName(e)};x.merge(this._config,e)}};return Y(Be);})();
var DynamicsWebApi = _dynamicsWebApiExports.DynamicsWebApi
//# sourceMappingURL=dynamics-web-api.min.js.map
