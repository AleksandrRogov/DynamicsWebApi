/*! dynamics-web-api v2.3.0-beta (c) 2025 Aleksandr Rogov. License: MIT */
"use strict";var _dynamicsWebApiExports=(()=>{var se=Object.defineProperty;var yn=Object.getOwnPropertyDescriptor;var fn=Object.getOwnPropertyNames;var hn=Object.prototype.hasOwnProperty;var ve=e=>{throw TypeError(e)};var A=(e,t)=>()=>(e&&(t=e(e=0)),t);var Ie=(e,t)=>{for(var n in t)se(e,n,{get:t[n],enumerable:!0})},gn=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let a of fn(t))!hn.call(e,a)&&a!==n&&se(e,a,{get:()=>t[a],enumerable:!(r=yn(t,a))||r.enumerable});return e};var Se=e=>gn(se({},"__esModule",{value:!0}),e);var Ue=(e,t,n)=>t.has(e)||ve("Cannot "+n);var l=(e,t,n)=>(Ue(e,t,"read from private field"),n?n.call(e):t.get(e)),$=(e,t,n)=>t.has(e)?ve("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),W=(e,t,n,r)=>(Ue(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n);function _e(){return window.crypto}var $e=A(()=>{"use strict"});function Me(e){return!!Rn.exec(e)}function w(e){let t=An.exec(e);return t?t[1]:null}function V(e){if(!e)return null;let t=Cn.exec(e);return t?t[1]:null}function ce(e){return e.replace(bn,(t,n)=>n)}function We(e){return e.split(En).map((n,r)=>r%2===0?ce(n):n).join("")}function qe(e){let t=xn.exec(e["@odata.id"]);return{id:t[2],collection:t[1],oDataContext:e["@odata.context"]}}function we(e){let t=Tn.exec(e);if(!t)return null;let n=parseInt(t[2],10),r=Dn(t[1]);return{page:n,sanitizedCookie:r}}function Dn(e){let t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};return e.replace(Pn,n=>t[n])}function Oe(e){return e.replace(kn,"")}function Be(e){return e.replace(Nn,t=>`\\u${("0000"+t.charCodeAt(0).toString(16)).slice(-4)}`)}function pe(e){return e.replace(vn,"")}function He(e){return In.test(e??"")?"PUT":"PATCH"}var q,Rn,An,Cn,bn,xn,En,Tn,Pn,kn,Nn,vn,Fe,le,Ge,Le,Xe,z,me,In,Ke,Ve,ze,Qe,C=A(()=>{"use strict";q="[0-9a-fA-F]{8}[-]?([0-9a-fA-F]{4}[-]?){3}[0-9a-fA-F]{12}",Rn=new RegExp(q,"i"),An=new RegExp("^{?("+q+")}?$","i"),Cn=new RegExp("("+q+")\\)$","i"),bn=new RegExp(`{(${q})}`,"g"),xn=new RegExp(`\\/(\\w+)\\((${q})`,"i");En=/(["'].*?["'])/;Tn=/pagingcookie="(<cookie page="(\d+)".+<\/cookie>)/,Pn=/[<>"']/g;kn=/^\//;Nn=/[\u007F-\uFFFF]/g;vn=/"/g;Fe=/^([^()<>@,;:\\"\/[\]?={} \t]+)\s?:\s?(.*)/,le=/HTTP\/?\s*[\d.]*\s+(\d{3})\s+([\w\s]*)$/m,Ge=/Content-Type: text\/plain/i,Le=/OData-EntityId.+/i,Xe=/\w+$/g,z=/\r?\n/,me=/(\w+)(\([\d\w-]+\))$/,In=/EntityDefinitions|RelationshipDefinitions|GlobalOptionSetDefinitions/;Ke=/^<fetch.+top=/,Ve=/^<fetch.+page=/,ze=/^(<fetch)/,Qe=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2})(?:Z|[-+]\d{2}:\d{2})$/});function Sn(e){return e==null?"":typeof e=="string"&&!e.startsWith("Microsoft.Dynamics.CRM")&&!Me(e)?`'${e}'`:typeof e=="object"?JSON.stringify(e):e.toString()}function Un(e){let t=Object.keys(e),n=[],r=[];return t.forEach((a,o)=>{let s=e[a];if(s==null)return;s=Sn(s);let c=o+1;n.push(`${a}=@p${c}`),r.push(`@p${c}=${w(s)||s}`)}),{key:`(${n.join(",")})`,queryParams:r}}function Ye(e,t){return e.hasOwnProperty(t)||e.hasOwnProperty(t.toLowerCase())}function O(e,t){return e[t]?e[t]:e[t.toLowerCase()]}function je(e){return e?Un(e):{key:"()"}}function Je(e="",t=1){e=decodeURIComponent(decodeURIComponent(e));let n=we(e);return{cookie:n?.sanitizedCookie||"",page:n?.page||t,nextPage:n?.page?n.page+1:t+1}}function R(e){return typeof e>"u"||e==null}function k(){return _e().randomUUID()}function _n(){if(typeof GetGlobalContext<"u")return GetGlobalContext();if(typeof Xrm<"u"){if(!R(Xrm.Utility)&&!R(Xrm.Utility.getGlobalContext))return Xrm.Utility.getGlobalContext();if(!R(Xrm.Page)&&!R(Xrm.Page.context))return Xrm.Page.context}throw new Error("Xrm Context is not available. In most cases, it can be resolved by adding a reference to a ClientGlobalContext.js.aspx. Please refer to MSDN documentation for more details.")}function Ze(){let t=_n().getClientUrl();return t.match(/\/$/)&&(t=t.substring(0,t.length-1)),t}function Q(){return!!window.shell}function B(e){return typeof e=="object"&&!!e&&!Array.isArray(e)&&Object.prototype.toString.call(e)!=="[object Date]"}function E(e,t){let n={};for(let r in e)e.hasOwnProperty(r)&&!t?.includes(r)&&(B(e[r])?n[r]=E(e[r]):Array.isArray(e[r])?n[r]=e[r].slice():n[r]=e[r]);return n}function p(e,t=[]){t.includes("signal")||t.push("signal");let n=E(e,t);return n.signal=e.signal,n}function et(e,t,n,r){r=r||0;let a=r+n>t.length?t.length%n:n,o;o=new Uint8Array(a);for(let s=0;s<a;s++)o[s]=t[r+s];e.data=o,e.contentRange="bytes "+r+"-"+(r+a-1)+"/"+t.length}function tt(e){let t=new Uint8Array(e.length);for(var n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}var ue,f=A(()=>{"use strict";$e();C();ue=4194304});function b(e,t,n){throw new Error(n?`${e} requires a ${t} parameter to be of type ${n}.`:`${e} requires a ${t} parameter.`)}var i,y=A(()=>{"use strict";C();i=class e{static handleErrorResponse(t){throw new Error(`Error: ${t.status}: ${t.message}`)}static parameterCheck(t,n,r,a){(typeof t>"u"||t===null||t==="")&&b(n,r,a)}static stringParameterCheck(t,n,r){typeof t!="string"&&b(n,r,"String")}static maxLengthStringParameterCheck(t,n,r,a){if(t&&t.length>a)throw new Error(`${r} has a ${a} character limit.`)}static arrayParameterCheck(t,n,r){t.constructor!==Array&&b(n,r,"Array")}static stringOrArrayParameterCheck(t,n,r){t.constructor!==Array&&typeof t!="string"&&b(n,r,"String or Array")}static numberParameterCheck(t,n,r){if(typeof t!="number"){if(typeof t=="string"&&t&&!isNaN(parseInt(t)))return;b(n,r,"Number")}}static batchIsEmpty(){return[new Error("Payload of the batch operation is empty. Please make that you have other operations in between startBatch() and executeBatch() to successfuly build a batch payload.")]}static handleHttpError(t,n){let r=new Error;return Object.keys(t).forEach(a=>{r[a]=t[a]}),n&&Object.keys(n).forEach(a=>{r[a]=n[a]}),r}static boolParameterCheck(t,n,r){typeof t!="boolean"&&b(n,r,"Boolean")}static guidParameterCheck(t,n,r){let a=w(t);return a||b(n,r,"GUID String"),a}static keyParameterCheck(t,n,r){try{e.stringParameterCheck(t,n,r);let a=w(t);if(a)return a;let o=t.split(",");if(o.length)for(let s=0;s<o.length;s++)o[s]=o[s].trim().replace(/"/g,"'"),/^[\w\d\_]+\=(.+)$/i.exec(o[s])[0];return o.join(",")}catch{b(n,r,"String representing GUID or Alternate Key")}}static callbackParameterCheck(t,n,r){typeof t!="function"&&b(n,r,"Function")}static throwBatchIncompatible(t,n){if(n)throw n=!1,new Error(t+" cannot be used in a BATCH request.")}static throwBatchNotStarted(t){if(!t)throw new Error("Batch operation has not been started. Please call a DynamicsWebApi.startBatch() function prior to calling DynamicsWebApi.executeBatch() to perform a batch request correctly.")}}});var N,G,j,P,at=A(()=>{"use strict";j=class j{};j.Prefer=(G=class{static get(t){return`${j.Prefer.IncludeAnnotations}="${t}"`}},G.ReturnRepresentation="return=representation",G.Annotations=(N=class{},N.AssociatedNavigationProperty="Microsoft.Dynamics.CRM.associatednavigationproperty",N.LookupLogicalName="Microsoft.Dynamics.CRM.lookuplogicalname",N.All="*",N.FormattedValue="OData.Community.Display.V1.FormattedValue",N.FetchXmlPagingCookie="Microsoft.Dynamics.CRM.fetchxmlpagingcookie",N),G.IncludeAnnotations="odata.include-annotations",G);P=j});function it(e,t){if(typeof t=="string"){let n=Qe.exec(t);if(n)return new Date(Date.UTC(+n[1],+n[2]-1,+n[3],+n[4],+n[5],+n[6]))}return t}var ot=A(()=>{"use strict";C()});function qn(e){let t={position:0},n={},r,a,o;do{if(o=t.position,a=wn(e,t),!a)break;r=Fe.exec(a),r!==null?n[r[1].toLowerCase()]=r[2]:t.position=o}while(a&&r);return n}function wn(e,t){return On(e,t,z)}function On(e,t,n){let r=t.position||0,a=e.slice(r),o=n.exec(a);if(!o)return null;let s=r+o.index;return t.position=s+o[0].length,e.substring(r,s)}function Bn(e){let t=le.exec(e);return{httpStatusString:t[0],httpStatus:parseInt(t[1]),httpStatusMessage:t[2].trim()}}function Fn(e){le.lastIndex=0;let t=Xe.exec(e.trim());return t?.length?t[0]:void 0}function Gn(e,t,n){let r=Fn(e);return Re(r)}function Ln(e,t,n){if(t?.[n]?.valueIfEmpty!==void 0)return t[n].valueIfEmpty;{let r=Le.exec(e);return V(r?.[0])??void 0}}function Xn(e,t,n){let{httpStatusString:r,httpStatus:a,httpStatusMessage:o}=Bn(e),s=e.substring(e.indexOf("{"),e.lastIndexOf("}")+1);if(!s)return Ge.test(e)?Gn(e,t,n):Ln(e,t,n);let c=ge(s,t,n);if(a<400)return c;let g=qn(e.substring(e.indexOf(r)+r.length+1,e.indexOf("{")));return i.handleHttpError(c,{status:a,statusText:o,statusMessage:o,headers:g})}function he(e,t,n=0){let r=e.substring(0,e.search(z)),a=e.split(r);a.shift(),a.pop();let o=[];for(let s of a){if(s.indexOf("--changesetresponse_")===-1){o.push(Xn(s,t,n++));continue}s=s.trim();let c=s.substring(s.search(z)+1).trim();o=o.concat(he(c,t,n++))}return o}var st=A(()=>{"use strict";y();C();Ae()});function Ce(e,t){let n=null;if(e.indexOf("@")!==-1){let r=e.split("@");switch(r[1]){case"odata.context":n="oDataContext";break;case"odata.count":n="oDataCount",t=t!=null?parseInt(t):0;break;case"odata.nextLink":n="oDataNextLink";break;case"odata.deltaLink":n="oDataDeltaLink";break;case P.Prefer.Annotations.FormattedValue:n=r[0]+"_Formatted";break;case P.Prefer.Annotations.AssociatedNavigationProperty:n=r[0]+"_NavigationProperty";break;case P.Prefer.Annotations.LookupLogicalName:n=r[0]+"_LogicalName";break}}return[n,t]}function be(e,t){if(t){if(t.isRef&&e["@odata.id"]!=null)return qe(e);if(t.toCount)return Ce("@odata.count",e["@odata.count"])[1]||0}for(let r in e){if(e[r]!=null)if(Array.isArray(e[r]))for(var n=0;n<e[r].length;n++)e[r][n]=be(e[r][n]);else typeof e[r]=="object"&&be(e[r]);let a=Ce(r,e[r]);if(a[0]&&(e[a[0]]=a[1]),r.indexOf("_x002e_")!==-1){let o=r.split("_x002e_");if(!e.hasOwnProperty(o[0]))e[o[0]]={_dwaType:"alias"};else if(typeof e[o[0]]!="object"||typeof e[o[0]]=="object"&&!e[o[0]].hasOwnProperty("_dwaType"))throw new Error("The alias name of the linked entity must be unique!");e[o[0]][o[1]]=e[r],a=Ce(o[1],e[r]),a[0]&&(e[o[0]][a[0]]=a[1])}}return t&&t.hasOwnProperty("pageNumber")&&e["@"+P.Prefer.Annotations.FetchXmlPagingCookie]!=null&&(e.PagingInfo=Je(e["@"+P.Prefer.Annotations.FetchXmlPagingCookie],t.pageNumber)),e}function Hn(e){return window.atob(e)}function Kn(e,t,n){let r=e;n?.hasOwnProperty("parse")&&(r=JSON.parse(r).value,r=Hn(r));let a={value:r};t["x-ms-file-name"]&&(a.fileName=t["x-ms-file-name"]),t["x-ms-file-size"]&&(a.fileSize=parseInt(t["x-ms-file-size"]));let o=O(t,"Location");return o&&(a.location=o),a}function Vn(e){return e.indexOf("--batchresponse_")>-1}function zn(e){return Ye(e,"Content-Disposition")}function Qn(e){return O(e,"Content-Type")?.startsWith("application/json")==!0}function Yn(e,t){let n=he(e,t);return t?.[0].convertedToBatch?n[0]:n}function jn(e,t,n){return Kn(e,t,n[0])}function ge(e,t,n=0){return be(JSON.parse(e,it),t[n])}function Re(e){let t=Number(e);return isFinite(t)?t:e}function Jn(e,t){if(t?.[0]?.valueIfEmpty!==void 0)return t[0].valueIfEmpty;let n=O(e,"OData-EntityId");if(n)return V(n)??void 0;let r=O(e,"Location");if(r){let a={location:r};return e["x-ms-chunk-size"]&&(a.chunkSize=parseInt(e["x-ms-chunk-size"])),a}}function xe(e,t,n){return e.length?Vn(e)?Yn(e,n):zn(t)?jn(e,t,n):Qn(t)?ge(e,n):Re(e):Jn(t,n)}var Ae=A(()=>{"use strict";at();f();ot();C();st()});function v(e){let t={};if(!e)return t;let n=e.split(`\r
`);for(let r=0,a=n.length;r<a;r++){let o=n[r],s=o.indexOf(": ");s>0&&(t[o.substring(0,s)]=o.substring(s+2))}return t}var ct=A(()=>{"use strict"});var pt={};Ie(pt,{XhrWrapper:()=>L,executeRequest:()=>Zn});function Zn(e){return new Promise((t,n)=>{er(e,t,n)})}function er(e,t,n){let r=e.data,a=e.headers,o=e.responseParams,s=e.abortSignal;if(s?.aborted){n(i.handleHttpError({name:"AbortError",code:20,message:"The user aborted a request."}));return}let c=new XMLHttpRequest;c.open(e.method,e.uri,e.isAsync||!1);for(let u in a)c.setRequestHeader(u,a[u]);c.onreadystatechange=function(){if(c.readyState===4)switch(s&&s.removeEventListener("abort",g),c.status){case 200:case 201:case 204:case 206:case 304:{let D=v(c.getAllResponseHeaders()),dn={data:xe(c.responseText,D,o[e.requestId]),headers:D,status:c.status};c=null,t(dn);break}case 0:break;default:if(!c)break;let u,h;try{h=v(c.getAllResponseHeaders());let D=xe(c.responseText,h,o[e.requestId]);if(Array.isArray(D)){n(D);break}u=D.error}catch{c.response.length>0?u={message:c.response}:u={message:"Unexpected Error"}}let x={status:c.status,statusText:c.statusText,headers:h};c=null,n(i.handleHttpError(u,x));break}},e.timeout&&(c.timeout=e.timeout),c.onerror=function(){let u=v(c.getAllResponseHeaders());n(i.handleHttpError({status:c.status,statusText:c.statusText,message:c.responseText||"Network Error",headers:u})),c=null},c.ontimeout=function(){let u=v(c.getAllResponseHeaders());n(i.handleHttpError({name:"TimeoutError",status:c.status,statusText:c.statusText,message:c.responseText||"Request Timed Out",headers:u})),c=null},c.onabort=function(){if(!c)return;let u=v(c.getAllResponseHeaders());n(i.handleHttpError({status:c.status,statusText:c.statusText,message:"Request aborted",headers:u})),c=null};let g=()=>{if(!c)return;let u=v(c.getAllResponseHeaders());n(i.handleHttpError({name:"AbortError",code:20,status:c.status,statusText:c.statusText,message:"The user aborted a request.",headers:u})),c.abort(),c=null};s&&s.addEventListener("abort",g),r?c.send(r):c.send(),L.afterSendEvent&&L.afterSendEvent()}var L,lt=A(()=>{"use strict";y();Ae();ct();L=class{}});var Ar={};Ie(Ar,{DynamicsWebApi:()=>ke});f();y();f();f();y();C();var T=null,nt=e=>{T=e},Y=(e,t)=>{if(e.path=e.path||"",e.functionName=e.functionName||"",e.url)i.stringParameterCheck(e.url,`DynamicsWebApi.${e.functionName}`,"request.url"),e.path=e.url.replace(t.dataApi.url,"");else if(!e._isUnboundRequest&&!e.contentId&&!e.collection&&i.parameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.collection!=null&&(i.stringParameterCheck(e.collection,`DynamicsWebApi.${e.functionName}`,"request.collection"),e.path=e.collection,e.key&&(e.key=i.keyParameterCheck(e.key,`DynamicsWebApi.${e.functionName}`,"request.key"),e.path+=`(${e.key})`)),e.contentId&&(i.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")&&(e.path=e.path?`${e.contentId}/${e.path}`:e.contentId)),e.addPath&&(e.path&&(e.path+="/"),e.path+=e.addPath),e.path=rt(e,t,e.path),e.fetchXml){i.stringParameterCheck(e.fetchXml,`DynamicsWebApi.${e.functionName}`,"request.fetchXml");let n=e.path.indexOf("?")===-1?"?":"&";e.path+=`${n}fetchXml=${encodeURIComponent(e.fetchXml)}`}return e.hasOwnProperty("async")&&e.async!=null?i.boolParameterCheck(e.async,`DynamicsWebApi.${e.functionName}`,"request.async"):e.async=!0,e.headers=$n(e,t),e},rt=(e,t,n="",r="&")=>{let a=[];if(e){if(e.navigationProperty){if(i.stringParameterCheck(e.navigationProperty,`DynamicsWebApi.${e.functionName}`,"request.navigationProperty"),n+="/"+e.navigationProperty,e.navigationPropertyKey){let o=i.keyParameterCheck(e.navigationPropertyKey,`DynamicsWebApi.${e.functionName}`,"request.navigationPropertyKey");n+="("+o+")"}e.navigationProperty==="Attributes"&&e.metadataAttributeType&&(i.stringParameterCheck(e.metadataAttributeType,`DynamicsWebApi.${e.functionName}`,"request.metadataAttributeType"),n+="/"+e.metadataAttributeType)}if(e.select?.length&&(i.arrayParameterCheck(e.select,`DynamicsWebApi.${e.functionName}`,"request.select"),e.functionName=="retrieve"&&e.select.length==1&&e.select[0].endsWith("/$ref")?n+="/"+e.select[0]:(e.select[0].startsWith("/")&&e.functionName=="retrieve"&&(e.navigationProperty==null?n+=e.select.shift():e.select.shift()),e.select.length&&a.push("$select="+e.select.join(",")))),e.filter){i.stringParameterCheck(e.filter,`DynamicsWebApi.${e.functionName}`,"request.filter");let o=We(e.filter);a.push("$filter="+encodeURIComponent(o))}if(e.fieldName&&(i.stringParameterCheck(e.fieldName,`DynamicsWebApi.${e.functionName}`,"request.fieldName"),e.property||(e.property=e.fieldName),delete e.fieldName),e.property&&(i.stringParameterCheck(e.property,`DynamicsWebApi.${e.functionName}`,"request.property"),n+="/"+e.property),e.savedQuery&&a.push("savedQuery="+i.guidParameterCheck(e.savedQuery,`DynamicsWebApi.${e.functionName}`,"request.savedQuery")),e.userQuery&&a.push("userQuery="+i.guidParameterCheck(e.userQuery,`DynamicsWebApi.${e.functionName}`,"request.userQuery")),e.apply&&(i.stringParameterCheck(e.apply,`DynamicsWebApi.${e.functionName}`,"request.apply"),a.push("$apply="+e.apply)),e.count&&(i.boolParameterCheck(e.count,`DynamicsWebApi.${e.functionName}`,"request.count"),a.push("$count="+e.count)),e.top&&e.top>0&&(i.numberParameterCheck(e.top,`DynamicsWebApi.${e.functionName}`,"request.top"),a.push("$top="+e.top)),e.orderBy!=null&&e.orderBy.length&&(i.arrayParameterCheck(e.orderBy,`DynamicsWebApi.${e.functionName}`,"request.orderBy"),a.push("$orderby="+e.orderBy.join(","))),e.partitionId&&(i.stringParameterCheck(e.partitionId,`DynamicsWebApi.${e.functionName}`,"request.partitionId"),a.push("partitionid='"+e.partitionId+"'")),e.downloadSize&&(i.stringParameterCheck(e.downloadSize,`DynamicsWebApi.${e.functionName}`,"request.downloadSize"),a.push("size="+e.downloadSize)),e.queryParams?.length&&(i.arrayParameterCheck(e.queryParams,`DynamicsWebApi.${e.functionName}`,"request.queryParams"),a.push(e.queryParams.join("&"))),e.fileName&&(i.stringParameterCheck(e.fileName,`DynamicsWebApi.${e.functionName}`,"request.fileName"),a.push("x-ms-file-name="+e.fileName)),e.data&&i.parameterCheck(e.data,`DynamicsWebApi.${e.functionName}`,"request.data"),e.isBatch&&i.boolParameterCheck(e.isBatch,`DynamicsWebApi.${e.functionName}`,"request.isBatch"),R(e.inChangeSet)||i.boolParameterCheck(e.inChangeSet,`DynamicsWebApi.${e.functionName}`,"request.inChangeSet"),e.isBatch&&R(e.inChangeSet)&&(e.inChangeSet=!0),e.timeout&&i.numberParameterCheck(e.timeout,`DynamicsWebApi.${e.functionName}`,"request.timeout"),e.expand?.length)if(i.stringOrArrayParameterCheck(e.expand,`DynamicsWebApi.${e.functionName}`,"request.expand"),typeof e.expand=="string")a.push("$expand="+e.expand);else{let o=[];for(let{property:s,...c}of e.expand){if(!s)continue;let g={functionName:`${e.functionName} $expand`,...c},u=rt(g,t,"",";");u&&(u=`(${u.slice(1)})`),o.push(s+u)}o.length&&a.push("$expand="+o.join(","))}}return a.length?n+"?"+a.join(r):n},$n=(e,t)=>{let n={...t.headers,...e.userHeaders},r=Mn(e,t);if(r.length&&(n.Prefer=r),e.collection==="$metadata"&&(n.Accept="application/xml"),e.transferMode&&(n["x-ms-transfer-mode"]=e.transferMode),e.ifmatch!=null&&e.ifnonematch!=null)throw new Error(`DynamicsWebApi.${e.functionName}. Either one of request.ifmatch or request.ifnonematch parameters should be used in a call, not both.`);return e.ifmatch&&(i.stringParameterCheck(e.ifmatch,`DynamicsWebApi.${e.functionName}`,"request.ifmatch"),n["If-Match"]=e.ifmatch),e.ifnonematch&&(i.stringParameterCheck(e.ifnonematch,`DynamicsWebApi.${e.functionName}`,"request.ifnonematch"),n["If-None-Match"]=e.ifnonematch),e.impersonate&&(i.stringParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate"),n.MSCRMCallerID=i.guidParameterCheck(e.impersonate,`DynamicsWebApi.${e.functionName}`,"request.impersonate")),e.impersonateAAD&&(i.stringParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD"),n.CallerObjectId=i.guidParameterCheck(e.impersonateAAD,`DynamicsWebApi.${e.functionName}`,"request.impersonateAAD")),e.token&&(i.stringParameterCheck(e.token,`DynamicsWebApi.${e.functionName}`,"request.token"),n.Authorization="Bearer "+e.token),e.duplicateDetection&&(i.boolParameterCheck(e.duplicateDetection,`DynamicsWebApi.${e.functionName}`,"request.duplicateDetection"),n["MSCRM.SuppressDuplicateDetection"]="false"),e.bypassCustomPluginExecution&&(i.boolParameterCheck(e.bypassCustomPluginExecution,`DynamicsWebApi.${e.functionName}`,"request.bypassCustomPluginExecution"),n["MSCRM.BypassCustomPluginExecution"]="true"),e.noCache&&(i.boolParameterCheck(e.noCache,`DynamicsWebApi.${e.functionName}`,"request.noCache"),n["Cache-Control"]="no-cache"),e.mergeLabels&&(i.boolParameterCheck(e.mergeLabels,`DynamicsWebApi.${e.functionName}`,"request.mergeLabels"),n["MSCRM.MergeLabels"]="true"),e.contentId&&(i.stringParameterCheck(e.contentId,`DynamicsWebApi.${e.functionName}`,"request.contentId"),e.contentId.startsWith("$")||(n["Content-ID"]=e.contentId)),e.contentRange&&(i.stringParameterCheck(e.contentRange,`DynamicsWebApi.${e.functionName}`,"request.contentRange"),n["Content-Range"]=e.contentRange),e.range&&(i.stringParameterCheck(e.range,`DynamicsWebApi.${e.functionName}`,"request.range"),n.Range=e.range),n},Mn=(e,t)=>{let{returnRepresentation:n,includeAnnotations:r,maxPageSize:a,trackChanges:o,continueOnError:s}=e;e.prefer&&e.prefer.length&&(i.stringOrArrayParameterCheck(e.prefer,`DynamicsWebApi.${e.functionName}`,"request.prefer"),(typeof e.prefer=="string"?e.prefer.split(","):e.prefer).forEach(u=>{let h=u.trim();h==="return=representation"?n=!0:h.includes("odata.include-annotations=")?r=pe(h.replace("odata.include-annotations=","")):h.startsWith("odata.maxpagesize=")?a=Number(pe(h.replace("odata.maxpagesize=","")))||0:h.includes("odata.track-changes")?o=!0:h.includes("odata.continue-on-error")&&(s=!0)}));let c=[];return t&&(n==null&&(n=t.returnRepresentation),r=r??t.includeAnnotations,a=a??t.maxPageSize),n&&(i.boolParameterCheck(n,`DynamicsWebApi.${e.functionName}`,"request.returnRepresentation"),c.push("return=representation")),r&&(i.stringParameterCheck(r,`DynamicsWebApi.${e.functionName}`,"request.includeAnnotations"),c.push(`odata.include-annotations="${r}"`)),a&&a>0&&(i.numberParameterCheck(a,`DynamicsWebApi.${e.functionName}`,"request.maxPageSize"),c.push("odata.maxpagesize="+a)),o&&(i.boolParameterCheck(o,`DynamicsWebApi.${e.functionName}`,"request.trackChanges"),c.push("odata.track-changes")),s&&(i.boolParameterCheck(s,`DynamicsWebApi.${e.functionName}`,"request.continueOnError"),c.push("odata.continue-on-error")),c.join(",")},de=(e,t,n)=>{let r=`dwa_batch_${k()}`,a=[],o=null,s=1e5,c=(u,h)=>{for(let x in u)x==="Authorization"||x==="Content-ID"||h.push(`${x}: ${u[x]}`)};e.forEach(u=>{u.functionName="executeBatch",n?.inChangeSet===!1&&(u.inChangeSet=!1);let h=u.method==="GET"?!1:!!u.inChangeSet;if(!h&&o&&(a.push(`
--${o}--`),o=null,s=1e5),o||(a.push(`
--${r}`),h&&(o=`changeset_${k()}`,a.push("Content-Type: multipart/mixed;boundary="+o))),h&&a.push(`
--${o}`),a.push("Content-Type: application/http"),a.push("Content-Transfer-Encoding: binary"),h){let x=u.headers.hasOwnProperty("Content-ID")?u.headers["Content-ID"]:++s;a.push(`Content-ID: ${x}`)}u.path?.startsWith("$")?a.push(`
${u.method} ${u.path} HTTP/1.1`):a.push(`
${u.method} ${t.dataApi.url}${u.path} HTTP/1.1`),u.method==="GET"?a.push("Accept: application/json"):a.push("Content-Type: application/json"),u.headers&&c(u.headers,a),u.data&&a.push(`
${ye(u.data,t)}`)}),o&&a.push(`
--${o}--`),a.push(`
--${r}--`);let g=fe(n?.userHeaders);return g["Content-Type"]=`multipart/mixed;boundary=${r}`,{headers:g,body:a.join(`
`)}},F=e=>{if(R(T))return null;let t=T[e];if(!t){for(let n in T)if(T[n]===e)return e}return t},ye=(e,t)=>{if(!e)return null;if(e instanceof Uint8Array||e instanceof Uint16Array||e instanceof Uint32Array)return e;let n=o=>{let s=me.exec(o);if(s&&s.length>2){let c=F(s[1]);if(!R(c))return o.replace(me,`${c}$2`)}return o},r=(o,s)=>(s.startsWith(t.dataApi.url)||(o.endsWith("@odata.bind")?s.startsWith("/")||(s=`/${s}`):s=`${t.dataApi.url}${Oe(s)}`),s),a=JSON.stringify(e,(o,s)=>{if(o.endsWith("@odata.bind")||o.endsWith("@odata.id"))typeof s=="string"&&!s.startsWith("$")&&(s=ce(s),t.useEntityNames&&(s=n(s)),s=r(o,s));else if(o.startsWith("oData")||o.endsWith("_Formatted")||o.endsWith("_NavigationProperty")||o.endsWith("_LogicalName"))return;return s});return Be(a)},fe=(e={})=>(e.Accept||(e.Accept="application/json"),e["OData-MaxVersion"]||(e["OData-MaxVersion"]="4.0"),e["OData-Version"]||(e["OData-Version"]="4.0"),e["Content-Range"]?e["Content-Type"]="application/octet-stream":e["Content-Type"]||(e["Content-Type"]="application/json; charset=utf-8"),e);y();async function mt(e){return(lt(),Se(pt)).executeRequest(e)}var ut=(e,t)=>{X[e]?X[e].push(t):X[e]=[t]},tr=(e,t)=>{I[e]?I[e].push(t):I[e]=[t]},Ee=e=>{delete X[e],I.hasOwnProperty(e)&&delete I[e]},dt=async(e,t)=>{try{let n=await or(e,t);return Ee(e.requestId),n}catch(n){throw Ee(e.requestId),n}finally{Ee(e.requestId)}},I={},X={},nr=["$metadata","EntityDefinitions","RelationshipDefinitions","GlobalOptionSetDefinitions","ManagedPropertyDefinitions","query","suggest","autocomplete"],rr=e=>nr.indexOf(e)>-1,ar=async(e,t)=>{if(!R(T))return F(e)||e;let n=Y({method:"GET",collection:"EntityDefinitions",select:["EntitySetName","LogicalName"],noCache:!0,functionName:"retrieveMultiple"},t),r=await dt(n,t);nt({});for(let a=0;a<r.data.value.length;a++)T[r.data.value[a].LogicalName]=r.data.value[a].EntitySetName;return F(e)||e},ir=async(e,t)=>{if(!e||rr(e)||(e=e.toLowerCase(),!t.useEntityNames))return e;try{return await ar(e,t)}catch(n){throw new Error("Unable to fetch Collection Names. Error: "+n.message)}},or=async(e,t)=>{e.headers=e.headers||{},e.responseParameters=e.responseParameters||{},e.requestId=e.requestId||k(),ut(e.requestId,e.responseParameters);let n=null,r=e.responseParameters?.convertedToBatch;if(e.path==="$batch"&&!r){let s=I[e.requestId];if(!s)throw i.batchIsEmpty();let c=de(s,t,e);n=c.body,e.headers={...c.headers,...e.headers},delete I[e.requestId]}else n=r?e.data:ye(e.data,t),r||(e.headers=fe(e.headers));t.impersonate&&!e.headers.MSCRMCallerID&&(e.headers.MSCRMCallerID=t.impersonate),t.impersonateAAD&&!e.headers.CallerObjectId&&(e.headers.CallerObjectId=t.impersonateAAD);let a=null;if(t.onTokenRefresh&&(!e.headers||e.headers&&!e.headers.Authorization)&&(a=await t.onTokenRefresh(),!a))throw new Error("Token is empty. Request is aborted.");a&&(e.headers.Authorization="Bearer "+(a.hasOwnProperty("accessToken")?a.accessToken:a)),Q()&&(e.headers.__RequestVerificationToken=await window.shell.getTokenDeferred());let o=e.apiConfig?e.apiConfig.url:t.dataApi.url;return await mt({method:e.method,uri:o.toString()+e.path,data:n,proxy:t.proxy,isAsync:e.async,headers:e.headers,requestId:e.requestId,abortSignal:e.signal,responseParams:X,timeout:e.timeout||t.timeout})},yt=async(e,t)=>{if(e.responseParameters=e.responseParameters||{},e.userHeaders=e.headers,delete e.headers,!e.isBatch){let n=await ir(e.collection,t);if(e.collection=n,Y(e,t),e.responseParameters.convertedToBatch=!1,e.path.length>2e3){let r=de([e],t);e.headers.Authorization&&(r.headers.Authorization=e.headers.Authorization),e.method="POST",e.path="$batch",e.data=r.body,e.headers={...r.headers,...e.userHeaders},e.responseParameters.convertedToBatch=!0}return dt(e,t)}Y(e,t),ut(e.requestId,e.responseParameters),tr(e.requestId,e)};var ft=e=>F(e);y();f();var m="DynamicsWebApi";var ht="associate",H=`${m}.${ht}`,gt=async(e,t)=>{i.parameterCheck(e,H,"request");let n=p(e);n.method="POST",n.functionName=ht,i.stringParameterCheck(e.relatedCollection,H,"request.relatedcollection"),i.stringParameterCheck(e.relationshipName,H,"request.relationshipName");let r=i.keyParameterCheck(e.primaryKey,H,"request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,H,"request.relatedKey");n.navigationProperty=e.relationshipName+"/$ref",n.key=r,n.data={"@odata.id":`${e.relatedCollection}(${a})`},await t.makeRequest(n)};y();f();var Rt="associateSingleValued",K=`${m}.${Rt}`,At=async(e,t)=>{i.parameterCheck(e,K,"request");let n=p(e);n.method="PUT",n.functionName=Rt;let r=i.keyParameterCheck(e.primaryKey,K,"request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,K,"request.relatedKey");i.stringParameterCheck(e.navigationProperty,K,"request.navigationProperty"),i.stringParameterCheck(e.relatedCollection,K,"request.relatedcollection"),n.navigationProperty+="/$ref",n.key=r,n.data={"@odata.id":`${e.relatedCollection}(${a})`},await t.makeRequest(n)};y();f();var bt="callAction",Ct=`${m}.${bt}`,xt=async(e,t)=>{i.parameterCheck(e,Ct,"request"),i.stringParameterCheck(e.actionName,Ct,"request.actionName");let n=p(e,["action"]);return n.method="POST",n.functionName=bt,n.addPath=e.actionName,n._isUnboundRequest=!n.collection,n.data=e.action,(await t.makeRequest(n))?.data};y();f();var Tt="callFunction",Et=`${m}.${Tt}`,Pt=async(e,t)=>{i.parameterCheck(e,Et,"request");let n=u=>u.name||u.functionName,r=typeof e!="string",a=r?n(e):e,o=r?"request.name":"name",s=r?E(e,["name"]):{functionName:a};i.stringParameterCheck(a,Et,o);let c=je(s.parameters);return s.method="GET",s.addPath=a+c.key,s.queryParams=c.queryParams,s._isUnboundRequest=!s.collection,s.functionName=Tt,(await t.makeRequest(s))?.data};y();f();var Dt="create",sr=`${m}.${Dt}`,J=async(e,t)=>{i.parameterCheck(e,sr,"request");let n;return e.functionName?n=e:(n=p(e),n.functionName=Dt),n.method="POST",(await t.makeRequest(n))?.data};y();f();var kt="count",cr=`${m}.${kt}`,Nt=async(e,t)=>{i.parameterCheck(e,cr,"request");let n=p(e);return n.method="GET",n.functionName=kt,n.filter?.length?n.count=!0:n.navigationProperty="$count",n.responseParameters={toCount:n.count},(await t.makeRequest(n))?.data};y();y();y();f();var It="retrieveMultiple",vt=`${m}.${It}`,Z=async(e,t,n)=>{i.parameterCheck(e,vt,"request");let r;return e.functionName?r=e:(r=p(e),r.functionName=It),r.method="GET",n&&(i.stringParameterCheck(n,vt,"nextPageLink"),r.url=n),(await t.makeRequest(r))?.data};var pr="retrieveAll",lr=`${m}.${pr}`,ee=async(e,t,n,r=[])=>{let a=await Z(e,t,n);r=r.concat(a.value);let o=a.oDataNextLink;if(o)return ee(e,t,o,r);let s={value:r};return a.oDataDeltaLink&&(s["@odata.deltaLink"]=a.oDataDeltaLink,s.oDataDeltaLink=a.oDataDeltaLink),s},Te=(e,t)=>(i.throwBatchIncompatible(lr,t.isBatch),ee(e,t));var mr="countAll",St=`${m}.${mr}`,Ut=async(e,t)=>{i.throwBatchIncompatible(St,t.isBatch),i.parameterCheck(e,St,"request");let n=await ee(e,t);return n&&n.value?n.value.length:0};y();f();var _t="disassociate",te=`${m}.${_t}`,$t=async(e,t)=>{i.parameterCheck(e,te,"request");let n=p(e);n.method="DELETE",n.functionName=_t,i.stringParameterCheck(e.relationshipName,te,"request.relationshipName");let r=i.keyParameterCheck(e.primaryKey,te,"request.primaryKey"),a=i.keyParameterCheck(e.relatedKey,te,"request.relatedId");n.key=r,n.navigationProperty=`${e.relationshipName}(${a})/$ref`,await t.makeRequest(n)};y();f();var Mt="disassociateSingleValued",Pe=`${m}.${Mt}`,Wt=async(e,t)=>{i.parameterCheck(e,Pe,"request");let n=p(e);n.method="DELETE",n.functionName=Mt,i.stringParameterCheck(e.navigationProperty,Pe,"request.navigationProperty");let r=i.keyParameterCheck(e.primaryKey,Pe,"request.primaryKey");n.navigationProperty+="/$ref",n.key=r,await t.makeRequest(n)};y();f();var qt="retrieve",ur=`${m}.${qt}`,ne=async(e,t)=>{i.parameterCheck(e,ur,"request");let n;return e.functionName?n=e:(n=p(e),n.functionName=qt),n.method="GET",n.responseParameters={isRef:n.select?.length===1&&n.select[0].endsWith("/$ref")},(await t.makeRequest(n))?.data};y();C();f();var wt="fetch",re=`${m}.${wt}`,ae=async(e,t)=>{i.parameterCheck(e,re,"request");let n=p(e);if(n.method="GET",n.functionName=wt,i.stringParameterCheck(n.fetchXml,re,"request.fetchXml"),n.fetchXml&&!Ke.test(n.fetchXml)){let a="";Ve.test(n.fetchXml)||(n.pageNumber=n.pageNumber||1,i.numberParameterCheck(n.pageNumber,re,"request.pageNumber"),a=`$1 page="${n.pageNumber}"`),n.pagingCookie!=null&&(i.stringParameterCheck(n.pagingCookie,re,"request.pagingCookie"),a+=` paging-cookie="${n.pagingCookie}"`),a&&(n.fetchXml=n.fetchXml.replace(ze,a))}return n.responseParameters={pageNumber:n.pageNumber},(await t.makeRequest(n))?.data};y();var dr="fetchAll",Ot=`${m}.${dr}`,Bt=async(e,t,n=[])=>{let r=await ae(e,t);return n=n.concat(r.value),r.PagingInfo?(e.pageNumber=r.PagingInfo.nextPage,e.pagingCookie=r.PagingInfo.cookie,Bt(e,t,n)):{value:n}},Ft=async(e,t)=>(i.parameterCheck(e,Ot,"request"),i.throwBatchIncompatible(Ot,t.isBatch),Bt(e,t));y();C();f();var Gt="update",yr=`${m}.${Gt}`,ie=async(e,t)=>{i.parameterCheck(e,yr,"request");let n;e.functionName?n=e:(n=p(e),n.functionName=Gt),n.method??(n.method=He(n.collection)),n.responseParameters={valueIfEmpty:!0},n.ifmatch??(n.ifmatch="*");let r=n.ifmatch;try{return(await t.makeRequest(n))?.data}catch(a){if(r&&a.status===412)return!1;throw a}};y();f();var Xt="updateSingleProperty",Lt=`${m}.${Xt}`,Ht=async(e,t)=>{i.parameterCheck(e,Lt,"request"),i.parameterCheck(e.fieldValuePair,Lt,"request.fieldValuePair");var n=Object.keys(e.fieldValuePair)[0],r=e.fieldValuePair[n];let a=p(e);return a.navigationProperty=n,a.data={value:r},a.functionName=Xt,a.method="PUT",delete a.fieldValuePair,(await t.makeRequest(a))?.data};y();f();var Kt="upsert",fr=`${m}.${Kt}`,Vt=async(e,t)=>{i.parameterCheck(e,fr,"request");let n=p(e);n.method="PATCH",n.functionName=Kt;let r=n.ifnonematch,a=n.ifmatch;try{return(await t.makeRequest(n))?.data}catch(o){if(r&&o.status===412)return null;if(a&&o.status===404)return null;throw o}};y();f();var zt="deleteRecord",hr=`${m}.${zt}`,Qt=async(e,t)=>{i.parameterCheck(e,hr,"request");let n;e.functionName?n=e:(n=p(e),n.functionName=zt),n.method="DELETE",n.responseParameters={valueIfEmpty:!0};let r=n.ifmatch;try{return(await t.makeRequest(n))?.data}catch(a){if(r&&a.status===412)return!1;throw a}};y();f();var jt="uploadFile",Yt=`${m}.${jt}`,Jt=async(e,t,n,r,a=0)=>{if(et(e,n,r,a),await t.makeRequest(e),a+=r,a<=n.length)return Jt(e,t,n,r,a)},Zt=async(e,t)=>{i.throwBatchIncompatible(Yt,t.isBatch),i.parameterCheck(e,Yt,"request");let n=p(e,["data"]);n.method="PATCH",n.functionName=jt,n.transferMode="chunked";let r=await t.makeRequest(n);return n.url=r?.data.location,delete n.transferMode,delete n.fieldName,delete n.property,delete n.fileName,Jt(n,t,e.data,r?.data.chunkSize)};y();f();var tn="deleteRecord",en=`${m}.${tn}`,nn=async(e,t,n=0,r="")=>{e.range="bytes="+n+"-"+(n+ue-1),e.downloadSize="full";let a=await t.makeRequest(e);return e.url=a?.data.location,r+=a?.data.value,n+=ue,n<=a?.data.fileSize?nn(e,t,n,r):{fileName:a?.data.fileName,fileSize:a?.data.fileSize,data:tt(r)}},rn=(e,t)=>{i.throwBatchIncompatible(en,t.isBatch),i.parameterCheck(e,en,"request");let n=p(e);return n.method="GET",n.functionName=tn,n.responseParameters={parse:!0},nn(n,t)};y();f();var on="createEntity",an=`${m}.${on}`,sn=async(e,t)=>{i.parameterCheck(e,an,"request"),i.parameterCheck(e.data,an,"request.data");let n=p(e);return n.collection="EntityDefinitions",n.functionName=on,J(n,t)};y();f();var pn="updateEntity",cn=`${m}.${pn}`,ln=async(e,t)=>{i.parameterCheck(e,cn,"request"),i.parameterCheck(e.data,cn,"request.data");let n=p(e);return n.collection="EntityDefinitions",n.functionName=pn,n.key=n.data.MetadataId,n.method="PUT",await ie(n,t)};y();f();var gr="retrieveEntity",mn=`${m}.${gr}`,un=async(e,t)=>{i.parameterCheck(e,mn,"request"),i.keyParameterCheck(e.key,mn,"request.key");let n=p(e);return n.collection="EntityDefinitions",n.functionName="retrieveEntity",await ne(n,t)};f();y();var Rr=(e,t)=>Q()?new URL("_api",window.location.origin).toString()+"/":(e||(e=Ze()),new URL(`api/${t.path}/v${t.version}`,e).toString()+"/"),De=(e,t,n)=>{let r=n[t];e?.version&&(i.stringParameterCheck(e.version,"DynamicsWebApi.setConfig",`config.${t}.version`),r.version=e.version),e?.path&&(i.stringParameterCheck(e.path,"DynamicsWebApi.setConfig",`config.${t}.path`),r.path=e.path),r.url=Rr(n.serverUrl,r)},S=class{static merge(t,n){n?.serverUrl&&(i.stringParameterCheck(n.serverUrl,"DynamicsWebApi.setConfig","config.serverUrl"),t.serverUrl=n.serverUrl),De(n?.dataApi,"dataApi",t),De(n?.searchApi,"searchApi",t),n?.impersonate&&(t.impersonate=i.guidParameterCheck(n.impersonate,"DynamicsWebApi.setConfig","config.impersonate")),n?.impersonateAAD&&(t.impersonateAAD=i.guidParameterCheck(n.impersonateAAD,"DynamicsWebApi.setConfig","config.impersonateAAD")),n?.onTokenRefresh&&(i.callbackParameterCheck(n.onTokenRefresh,"DynamicsWebApi.setConfig","config.onTokenRefresh"),t.onTokenRefresh=n.onTokenRefresh),n?.includeAnnotations&&(i.stringParameterCheck(n.includeAnnotations,"DynamicsWebApi.setConfig","config.includeAnnotations"),t.includeAnnotations=n.includeAnnotations),n?.timeout&&(i.numberParameterCheck(n.timeout,"DynamicsWebApi.setConfig","config.timeout"),t.timeout=n.timeout),n?.maxPageSize&&(i.numberParameterCheck(n.maxPageSize,"DynamicsWebApi.setConfig","config.maxPageSize"),t.maxPageSize=n.maxPageSize),n?.returnRepresentation&&(i.boolParameterCheck(n.returnRepresentation,"DynamicsWebApi.setConfig","config.returnRepresentation"),t.returnRepresentation=n.returnRepresentation),n?.useEntityNames&&(i.boolParameterCheck(n.useEntityNames,"DynamicsWebApi.setConfig","config.useEntityNames"),t.useEntityNames=n.useEntityNames),n?.headers&&(t.headers=n.headers)}static default(){return{serverUrl:null,impersonate:null,impersonateAAD:null,onTokenRefresh:null,includeAnnotations:null,maxPageSize:null,returnRepresentation:null,proxy:null,dataApi:{path:"data",version:"9.2",url:""},searchApi:{path:"search",version:"1.0",url:""}}}};S.mergeApiConfigs=De;var U,M,_,oe=class{constructor(t){$(this,U,S.default());$(this,M,!1);$(this,_,null);this.setConfig=t=>S.merge(l(this,U),t);this.makeRequest=t=>(t.isBatch=l(this,M),l(this,_)&&(t.requestId=l(this,_)),yt(t,l(this,U)));S.merge(l(this,U),t)}get batchRequestId(){return l(this,_)}set batchRequestId(t){W(this,_,t)}get config(){return l(this,U)}get isBatch(){return l(this,M)}set isBatch(t){W(this,M,t)}};U=new WeakMap,M=new WeakMap,_=new WeakMap;var d,Ne=class Ne{constructor(t){$(this,d);this.setConfig=t=>l(this,d).setConfig(t);this.create=async t=>J(t,l(this,d));this.retrieve=async t=>ne(t,l(this,d));this.update=async t=>ie(t,l(this,d));this.updateSingleProperty=async t=>Ht(t,l(this,d));this.deleteRecord=async t=>Qt(t,l(this,d));this.upsert=async t=>Vt(t,l(this,d));this.uploadFile=async t=>Zt(t,l(this,d));this.downloadFile=t=>rn(t,l(this,d));this.retrieveMultiple=async(t,n)=>Z(t,l(this,d),n);this.retrieveAll=t=>Te(t,l(this,d));this.count=async t=>Nt(t,l(this,d));this.countAll=async t=>Ut(t,l(this,d));this.fetch=async t=>ae(t,l(this,d));this.fetchAll=async t=>Ft(t,l(this,d));this.associate=async t=>gt(t,l(this,d));this.disassociate=async t=>$t(t,l(this,d));this.associateSingleValued=async t=>At(t,l(this,d));this.disassociateSingleValued=async t=>Wt(t,l(this,d));this.callFunction=async t=>Pt(t,l(this,d));this.callAction=async t=>xt(t,l(this,d));this.createEntity=t=>sn(t,l(this,d));this.updateEntity=t=>ln(t,l(this,d));this.retrieveEntity=t=>un(t,l(this,d));this.retrieveEntities=t=>{let n=t?p(t):{};return n.collection="EntityDefinitions",n.functionName="retrieveEntities",this.retrieveMultiple(n)};this.createAttribute=t=>{i.parameterCheck(t,"DynamicsWebApi.createAttribute","request"),i.parameterCheck(t.data,"DynamicsWebApi.createAttribute","request.data"),i.keyParameterCheck(t.entityKey,"DynamicsWebApi.createAttribute","request.entityKey");let n=p(t);return n.collection="EntityDefinitions",n.functionName="retrieveEntity",n.navigationProperty="Attributes",n.key=t.entityKey,this.create(n)};this.updateAttribute=t=>{i.parameterCheck(t,"DynamicsWebApi.updateAttribute","request"),i.parameterCheck(t.data,"DynamicsWebApi.updateAttribute","request.data"),i.keyParameterCheck(t.entityKey,"DynamicsWebApi.updateAttribute","request.entityKey"),i.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateAttribute","request.data.MetadataId"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.updateAttribute","request.castType");let n=p(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.navigationPropertyKey=t.data.MetadataId,n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="updateAttribute",n.method="PUT",this.update(n)};this.retrieveAttributes=t=>{i.parameterCheck(t,"DynamicsWebApi.retrieveAttributes","request"),i.keyParameterCheck(t.entityKey,"DynamicsWebApi.retrieveAttributes","request.entityKey"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveAttributes","request.castType");let n=p(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="retrieveAttributes",this.retrieveMultiple(n)};this.retrieveAttribute=t=>{i.parameterCheck(t,"DynamicsWebApi.retrieveAttributes","request"),i.keyParameterCheck(t.entityKey,"DynamicsWebApi.retrieveAttribute","request.entityKey"),i.keyParameterCheck(t.attributeKey,"DynamicsWebApi.retrieveAttribute","request.attributeKey"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveAttribute","request.castType");let n=p(t);return n.collection="EntityDefinitions",n.navigationProperty="Attributes",n.navigationPropertyKey=t.attributeKey,n.metadataAttributeType=t.castType,n.key=t.entityKey,n.functionName="retrieveAttribute",this.retrieve(n)};this.createRelationship=t=>{i.parameterCheck(t,"DynamicsWebApi.createRelationship","request"),i.parameterCheck(t.data,"DynamicsWebApi.createRelationship","request.data");let n=p(t);return n.collection="RelationshipDefinitions",n.functionName="createRelationship",this.create(n)};this.updateRelationship=t=>{i.parameterCheck(t,"DynamicsWebApi.updateRelationship","request"),i.parameterCheck(t.data,"DynamicsWebApi.updateRelationship","request.data"),i.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateRelationship","request.data.MetadataId"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.updateRelationship","request.castType");let n=p(t);return n.collection="RelationshipDefinitions",n.key=t.data.MetadataId,n.navigationProperty=t.castType,n.functionName="updateRelationship",n.method="PUT",this.update(n)};this.deleteRelationship=t=>{i.parameterCheck(t,"DynamicsWebApi.deleteRelationship","request"),i.keyParameterCheck(t.key,"DynamicsWebApi.deleteRelationship","request.key");let n=p(t);return n.collection="RelationshipDefinitions",n.functionName="deleteRelationship",this.deleteRecord(n)};this.retrieveRelationships=t=>{let n=t?p(t):{};return n.collection="RelationshipDefinitions",n.functionName="retrieveRelationships",t&&t.castType&&(i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveRelationships","request.castType"),n.navigationProperty=t.castType),this.retrieveMultiple(n)};this.retrieveRelationship=t=>{i.parameterCheck(t,"DynamicsWebApi.retrieveRelationship","request"),i.keyParameterCheck(t.key,"DynamicsWebApi.retrieveRelationship","request.key"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveRelationship","request.castType");let n=p(t);return n.collection="RelationshipDefinitions",n.navigationProperty=t.castType,n.functionName="retrieveRelationship",this.retrieve(n)};this.createGlobalOptionSet=t=>{i.parameterCheck(t,"DynamicsWebApi.createGlobalOptionSet","request"),i.parameterCheck(t.data,"DynamicsWebApi.createGlobalOptionSet","request.data");let n=p(t);return n.collection="GlobalOptionSetDefinitions",n.functionName="createGlobalOptionSet",this.create(n)};this.updateGlobalOptionSet=t=>{i.parameterCheck(t,"DynamicsWebApi.updateGlobalOptionSet","request"),i.parameterCheck(t.data,"DynamicsWebApi.updateGlobalOptionSet","request.data"),i.guidParameterCheck(t.data.MetadataId,"DynamicsWebApi.updateGlobalOptionSet","request.data.MetadataId"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.updateGlobalOptionSet","request.castType");let n=p(t);return n.collection="GlobalOptionSetDefinitions",n.key=t.data.MetadataId,n.functionName="updateGlobalOptionSet",n.method="PUT",this.update(n)};this.deleteGlobalOptionSet=t=>{i.parameterCheck(t,"DynamicsWebApi.deleteGlobalOptionSet","request");let n=p(t);return n.collection="GlobalOptionSetDefinitions",n.functionName="deleteGlobalOptionSet",this.deleteRecord(n)};this.retrieveGlobalOptionSet=t=>{i.parameterCheck(t,"DynamicsWebApi.retrieveGlobalOptionSet","request"),t.castType&&i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveGlobalOptionSet","request.castType");let n=p(t);return n.collection="GlobalOptionSetDefinitions",n.navigationProperty=t.castType,n.functionName="retrieveGlobalOptionSet",this.retrieve(n)};this.retrieveGlobalOptionSets=t=>{let n=t?p(t):{};return n.collection="GlobalOptionSetDefinitions",n.functionName="retrieveGlobalOptionSets",t?.castType&&(i.stringParameterCheck(t.castType,"DynamicsWebApi.retrieveGlobalOptionSets","request.castType"),n.navigationProperty=t.castType),this.retrieveMultiple(n)};this.retrieveCsdlMetadata=async t=>{let n=t?p(t):{};return n.collection="$metadata",n.functionName="retrieveCsdlMetadata",t?.addAnnotations&&(i.boolParameterCheck(t.addAnnotations,"DynamicsWebApi.retrieveCsdlMetadata","request.addAnnotations"),n.includeAnnotations="*"),(await l(this,d).makeRequest(n))?.data};this.search=async t=>{i.parameterCheck(t,"DynamicsWebApi.search","request");let n=B(t),r=n?"request.query.search":"term",a=n?E(t):{query:{search:t}};return i.parameterCheck(a.query,"DynamicsWebApi.search","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.search",r),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.search",r,100),a.collection="query",a.functionName="search",a.method="POST",a.data=a.query,a.apiConfig=l(this,d).config.searchApi,delete a.query,(await l(this,d).makeRequest(a))?.data};this.suggest=async t=>{i.parameterCheck(t,"DynamicsWebApi.suggest","request");let n=B(t),r=n?"request.query.search":"term",a=n?E(t):{query:{search:t}};return i.parameterCheck(a.query,"DynamicsWebApi.suggest","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.suggest",r),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.suggest",r,100),a.functionName=a.collection="suggest",a.method="POST",a.data=a.query,a.apiConfig=l(this,d).config.searchApi,delete a.query,(await l(this,d).makeRequest(a))?.data};this.autocomplete=async t=>{i.parameterCheck(t,"DynamicsWebApi.autocomplete","request");let n=B(t),r=n?"request.query.search":"term",a=n?E(t):{query:{search:t}};return n&&i.parameterCheck(a.query,"DynamicsWebApi.autocomplete","request.query"),i.stringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",r),i.maxLengthStringParameterCheck(a.query.search,"DynamicsWebApi.autocomplete",r,100),a.functionName=a.collection="autocomplete",a.method="POST",a.data=a.query,a.apiConfig=l(this,d).config.searchApi,delete a.query,(await l(this,d).makeRequest(a))?.data};this.startBatch=()=>{l(this,d).isBatch=!0,l(this,d).batchRequestId=k()};this.executeBatch=async t=>{i.throwBatchNotStarted(l(this,d).isBatch);let n=t?p(t):{};return n.collection="$batch",n.method="POST",n.functionName="executeBatch",n.requestId=l(this,d).batchRequestId,l(this,d).batchRequestId=null,l(this,d).isBatch=!1,(await l(this,d).makeRequest(n))?.data};this.initializeInstance=t=>new Ne(t||l(this,d).config);this.Utility={getCollectionName:t=>ft(t)};W(this,d,new oe(t))}};d=new WeakMap;var ke=Ne;return Se(Ar);})();
var DynamicsWebApi = _dynamicsWebApiExports.DynamicsWebApi
//# sourceMappingURL=dynamics-web-api.min.js.map
